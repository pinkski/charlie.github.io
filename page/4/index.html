
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="yolynn">
    <title>yolynn</title>
    <meta name="author" content="yolynn">
    
    
        <link rel="icon" href="http://yolynn.com/assets/images/head.png">
    
    
    <meta name="description" content="äº‘åœ¨é’å¤©æ°´åœ¨ç“¶ - å¹½çµé¸Ÿ">
<meta property="og:type" content="blog">
<meta property="og:title" content="yolynn">
<meta property="og:url" content="http://yolynn.com/page/4/index.html">
<meta property="og:site_name" content="yolynn">
<meta property="og:description" content="äº‘åœ¨é’å¤©æ°´åœ¨ç“¶ - å¹½çµé¸Ÿ">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="yolynn">
<meta name="twitter:description" content="äº‘åœ¨é’å¤©æ°´åœ¨ç“¶ - å¹½çµé¸Ÿ">
    
    
        
    
    
        <meta property="og:image" content="http://yolynn.com/assets/images/head.png"/>
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/font-awesome.css" type="text/css">
    <link rel="stylesheet" href="/assets/css/jquery.fancybox.css" type="text/css">
    <link rel="stylesheet" href="/assets/css/jquery.fancybox-thumbs.css" type="text/css">
    <link rel="stylesheet" href="/assets/css/tranquilpeak.css" type="text/css">
    <!--STYLES END-->
    
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


<header id="header" data-behavior="2">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <h1 class="header-title">
        <a class="header-title-link" href="/ ">yolynn</a>
    </h1>
    
        
            <a  class="header-right-icon "
                href="/#about">
        
        
            <i class="fa fa-lg fa-head.png"></i>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="2">
    
        <div class="sidebar-profile">
            <a href="/#about">
                    <img class="sidebar-profile-picture" src="/assets/images/head.png"/>
            </a>
            <span class="sidebar-profile-name">yolynn</span>
        </div>
    
    
        <ul class="sidebar-buttons">
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/ "
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-home"></i>
                    <span class="sidebar-button-desc">Home</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/all-archives"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
                    <span class="sidebar-button-desc">Archives</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/all-tags"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
                    <span class="sidebar-button-desc">Tags</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/#about"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-question"></i>
                    <span class="sidebar-button-desc">About</span>
                </a>
        </li>
        
    </ul>
    
        <ul class="sidebar-buttons">
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link " href="https://github.com/yolynn-bird" target="_blank">
                
                    <i class="sidebar-button-icon fa fa-lg fa-github"></i>
                    <span class="sidebar-button-desc">GitHub</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link " href="http://weibo.com/zxl20zxl" target="_blank">
                
                    <i class="sidebar-button-icon fa fa-lg fa-weibo"></i>
                    <span class="sidebar-button-desc">global.weibo</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link " href="https://stackoverflow.com/users/2662962/yolynn" target="_blank">
                
                    <i class="sidebar-button-icon fa fa-lg fa-stack-overflow"></i>
                    <span class="sidebar-button-desc">Stack Overflow</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link " href="https://twitter.com/zxl20zxl" target="_blank">
                
                    <i class="sidebar-button-icon fa fa-lg fa-twitter"></i>
                    <span class="sidebar-button-desc">Twitter</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link " href="https://www.instagram.com/yolynn.zxl" target="_blank">
                
                    <i class="sidebar-button-icon fa fa-lg fa-instagram"></i>
                    <span class="sidebar-button-desc">global.instagram</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link " href="https://dribbble.com/yolynn" target="_blank">
                
                    <i class="sidebar-button-icon fa fa-lg fa-dribbble"></i>
                    <span class="sidebar-button-desc">global.dribbble</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="http://yolynn.com/2010/04/22/weixin/"
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-weixin"></i>
                    <span class="sidebar-button-desc">global.weixin</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link " href="https://www.zhihu.com/people/yolynn" target="_blank">
                
                    <i class="sidebar-button-icon fa fa-lg fa-flickr"></i>
                    <span class="sidebar-button-desc">global.zhihu</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link " href="mailto://zxl20zxl@gmail.com" target="_blank">
                
                    <i class="sidebar-button-icon fa fa-lg fa-envelope-o"></i>
                    <span class="sidebar-button-desc">Mail</span>
                </a>
        </li>
        
    </ul>
    
</nav>

            
            <div id="main" data-behavior="2"
                 class="
                        hasCoverMetaIn
                        ">
                

<section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="/2015/10/20/algorithm_01/">
                            æ•°æ®ç»“æ„åŸºç¡€åˆ°è¿›é˜¶
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2015-10-20T18:15:02+08:00">
	
		    Oct 20, 2015
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <h4 id="å­¦ä¹ æ•°æ®ç»“æ„éœ€è¦ä¼šä»€ä¹ˆï¼Ÿ">å­¦ä¹ æ•°æ®ç»“æ„éœ€è¦ä¼šä»€ä¹ˆï¼Ÿ</h4><p>æ•°æ®ç»“æ„æ˜¯ä»¥æŸç§å½¢å¼å°†æ•°æ®ç»„ç»‡åœ¨ä¸€èµ·çš„é›†åˆï¼Œè¿˜åŒ…æ‹¬æ•°æ®çš„å¢åˆ æ”¹æŸ¥ï¼Œä½ éœ€è¦äº†è§£çš„ä¸“ä¸šæœ¯è¯­æœ‰ï¼š</p>
<ul>
<li>æ ‘ç›¸å…³ç§°å‘¼ï¼Œä¸¾ä¸ªğŸŒ°ï¼šçˆ¶èŠ‚ç‚¹ã€å¶å­èŠ‚ç‚¹ã€æ·±åº¦[æ ¹èŠ‚ç‚¹åˆ°åº•å±‚]ã€åº¦[å­èŠ‚ç‚¹çš„ä¸ªæ•°]</li>
<li>é“¾è¡¨ç›¸å…³ç§°å‘¼ï¼Œä¸¾ä¸ªğŸŒ°ï¼šé¦–ç»“ç‚¹ã€å°¾ç»“ç‚¹ã€å¤´æŒ‡é’ˆã€å°¾æŒ‡é’ˆ</li>
</ul>
<h4 id="æ•°æ®ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿ">æ•°æ®ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿ</h4><p>æˆ‘æŠŠæ•°æ®ç»“æ„ç‹­ä¹‰çš„åˆ†ä¸ºä¸¤å¤§ç±»ï¼š</p>
<h6 id="çº¿æ€§ç»“æ„(æ‰€æœ‰ç»“ç‚¹ç”¨ä¸€æ ¹çº¿ä¸²èµ·æ¥)">çº¿æ€§ç»“æ„(æ‰€æœ‰ç»“ç‚¹ç”¨ä¸€æ ¹çº¿ä¸²èµ·æ¥)</h6><ol>
<li>è¿ç»­å­˜å‚¨[æ•°ç»„]<ul>
<li>ç©ºé—´å¤æ‚åº¦å¤§ï¼Œæ—¶é—´å¤æ‚åº¦O(1)ï¼Œå¯»å€å®¹æ˜“ï¼Œå¢åˆ éš¾</li>
</ul>
</li>
<li>ç¦»æ•£å­˜å‚¨[é“¾è¡¨]<ul>
<li>ç©ºé—´å¤æ‚åº¦å°ï¼Œæ—¶é—´å¤æ‚åº¦O(N)ï¼Œå¯»å€å›°éš¾ï¼Œå¢åˆ æ˜“</li>
</ul>
</li>
<li>æ•°ç»„ VS é“¾è¡¨<br><img src="https://www.processon.com/chart_image/585ba403e4b02e6c0ab4964b.png" alt=""></li>
<li>å“ˆå¸Œè¡¨[key-value]<ul>
<li>ä¾èµ–å“ˆå¸Œç®—æ³•å­˜å‚¨ï¼Œæ‹¥æœ‰<strong>æ•°ç»„æŸ¥è¯¢å¿«</strong>å’Œ<strong>é“¾è¡¨å¢åˆ æ”¹å¿«</strong>çš„ä¼˜åŠ¿</li>
<li>æ•£åˆ—å‡½æ•° -&gt; æ•£åˆ—åœ°å€</li>
<li>æ•£åˆ—å†²çªï¼šä¸åŒçš„keyè®¡ç®—åè·å¾—äº†ç›¸åŒçš„æ•£åˆ—åœ°å€<br><img src="https://www.processon.com/chart_image/585ba265e4b03a03b1957008.png" alt=""><br>â€œæ‹‰é“¾æ³•â€å®ç°å“ˆå¸Œè¡¨ï¼šå·¦è¾¹æ˜¯æ•°ç»„ï¼Œæ•°ç»„ä¸­çš„æŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªé“¾è¡¨çš„å¤´ã€‚</li>
</ul>
</li>
</ol>
<h6 id="éçº¿æ€§ç»“æ„">éçº¿æ€§ç»“æ„</h6><ol>
<li>æ ‘<ul>
<li>ä¸€èˆ¬æ ‘</li>
<li>äºŒå‰æ ‘<ul>
<li>å‰ä¸­ååºéå†(æ ¹èŠ‚ç‚¹ä½ç½®)</li>
<li>æ»¡äºŒå‰æ ‘ï¼šè¾¾åˆ°<strong>èŠ‚ç‚¹æœ€å¤§å€¼</strong> </li>
<li>å®Œå…¨äºŒå‰æ ‘ï¼šé™¤äº†<strong>æ·±åº¦hå±‚</strong>ï¼Œå…¶å®ƒå±‚éƒ½è¾¾åˆ°<strong>èŠ‚ç‚¹æœ€å¤§å€¼</strong></li>
<li>äºŒå‰æŸ¥æ‰¾(æ’åº)æ ‘ï¼šç©ºæ ‘ æˆ– å·¦å­æ ‘èŠ‚ç‚¹å°äºç­‰äºæ ¹èŠ‚ç‚¹å€¼ï¼Œå³å­æ ‘èŠ‚ç‚¹å¤§äºç­‰äºæ ¹èŠ‚ç‚¹å€¼ </li>
<li>å¹³è¡¡äºŒå‰æ ‘ï¼šå·¦å³å­æ ‘<strong>é«˜åº¦å·®ç»å¯¹å€¼ä¸è¶…è¿‡1</strong></li>
</ul>
</li>
<li>æ£®æ—</li>
</ul>
</li>
<li>å›¾</li>
</ol>
<h4 id="ä¸ºä»€ä¹ˆè¦ç”¨æ•°æ®ç»“æ„ï¼Ÿ">ä¸ºä»€ä¹ˆè¦ç”¨æ•°æ®ç»“æ„ï¼Ÿ</h4><p><img src="https://www.processon.com/chart_image/585bae3fe4b03a03b1965777.png" alt=""></p>
<h4 id="æ•°æ®ç»“æ„æ€ä¹ˆç”¨ï¼Ÿ">æ•°æ®ç»“æ„æ€ä¹ˆç”¨ï¼Ÿ</h4><p>åŸºäºæ•°ç»„å’Œé“¾è¡¨å®ç°çš„å¸¸ç”¨æ•°æ®ç»“æ„ï¼š</p>
<ol>
<li>æ ˆ[å…ˆè¿›åå‡º] </li>
<li>é˜Ÿåˆ—[å…ˆè¿›å…ˆå‡º]</li>
<li>ArrayList(æ•°ç»„)   LinkedList(åŒå‘é“¾è¡¨)</li>
</ol>
<p>åŸºäºå“ˆå¸Œè¡¨å®ç°çš„å¸¸ç”¨æ•°æ®ç»“æ„ï¼š</p>
<ol>
<li>NSDictionary</li>
<li>HashMap HashSet</li>
<li>å“ˆå¸Œçš„åº”ç”¨<ul>
<li>å®‰å…¨é¢†åŸŸçš„åŠ å¯†ç®—æ³•</li>
<li>å“ˆå¸Œè¡¨</li>
<li>æµ·é‡æ•°æ®å¤„ç†</li>
</ul>
</li>
</ol>
<h4 id="æ•°æ®ç»“æ„çš„å®é™…åº”ç”¨">æ•°æ®ç»“æ„çš„å®é™…åº”ç”¨</h4><h6 id="XXä¼š">XXä¼š</h6><h6 id="XXèœ‚">XXèœ‚</h6>
                    
                        
                    
                    
                        <p>
                            <a href="/2015/10/20/algorithm_01/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="/2015/09/22/mvvm_profile/">
                            ä»Webçœ‹Nativeçš„MVVM
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2015-09-22T23:14:02+08:00">
	
		    Sep 22, 2015
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <h2 id="èƒŒæ™¯">èƒŒæ™¯</h2><blockquote>
<p>  éšç€å‰ç«¯æŠ€æœ¯çš„åœ¨å¼€å‘å·¥ä½œä¸­çš„è§’è‰²è¶Šæ¥è¶Šé‡è¦ï¼Œéœ€æ±‚é‡ä¹Ÿè¶Šæ¥è¶Šå¤§ï¼Œé‚£ä¹ˆé«˜æ•ˆç‡çš„æ¡†æ¶ä¹Ÿåº”è¿è€Œç”Ÿï¼Œè¿‡å»scriptæ–¹å¼å·²è¿›åŒ–ä¸ºMVCï¼Œç°åœ¨æˆ‘ä»¬æ˜¯å¦åº”è¯¥é¡ºåº”æ½®æµæ¨åŠ¨MVCè¿›åŒ–åˆ°MVVMå‘¢ï¼Ÿï¼ˆMVPï¼‰</p>
</blockquote>
<h2 id="ä»‹ç»">ä»‹ç»</h2><ol>
<li>webä¸nativeçš„ç»„æˆå¯¹æ¯”<ul>
<li>web : html + css + js</li>
<li>android : å››å¤§ç»„ä»¶(activityã€serviceã€broadcase receiverã€content provider)å’Œäº”å¤§å¸ƒå±€(LinearLayoutã€FrameLayoutã€RelativeLayoutã€AbsoluteLayoutã€TableLayout) è¿˜æœ‰ java (data binding library)</li>
<li>iOS : xib/storyboard + oc/swift   </li>
<li>react(react.jsã€react canvasã€react native)  </li>
</ul>
</li>
<li>webå‰ç«¯å¸¸ç”¨çš„MVVMä¸»æµæ¡†æ¶<ul>
<li>handlebars.jsã€knockout.jsã€ember.jsã€avalon.jsã€angular.js </li>
<li>backbone.js?, react.js?</li>
</ul>
</li>
<li>angularJSçš„æ ¸å¿ƒåŠŸèƒ½<ul>
<li>è‡ªåŠ¨åŒ–åŒå‘æ•°æ®ç»‘å®šã€æ¨¡å—åŒ–/ç»„ä»¶åŒ–ã€ä¾èµ–æ³¨å…¥ã€è¯­ä¹‰åŒ–æ ‡ç­¾ç­‰</li>
</ul>
</li>
<li>angularJSçš„åŸç†<ul>
<li>é¦–å…ˆï¼Œæµè§ˆå™¨ä¼šä¸€ç›´å¤„äºç›‘å¬çŠ¶æ€ï¼Œä¸€æ—¦æœ‰äº‹ä»¶è¢«è§¦å‘ï¼Œå°±ä¼šè¢«åŠ åˆ°ä¸€ä¸ªevent queueä¸­ï¼Œevent queueä¸­çš„äº‹ä»¶ä¼šä¸€ä¸ªä¸€ä¸ªçš„æ‰§è¡Œã€‚</li>
<li>event queueä¸­çš„äº‹ä»¶å¦‚æœæ˜¯è¢«$apply()åŒ…èµ·æ¥çš„è¯ï¼Œå°±ä¼šè¿›å…¥åˆ°AngularJSçš„contextä¸­ï¼Œå‡è®¾çš„fn()æ˜¯æˆ‘ä»¬å¸Œæœ›åœ¨AngularJSçš„contextä¸­æ‰§è¡Œçš„å‡½æ•°ã€‚</li>
<li>AngularJSå°†æ‰§è¡Œfn()å‡½æ•°ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå‡½æ•°ä¼šæ”¹å˜åº”ç”¨çš„æŸäº›çŠ¶æ€ã€‚</li>
<li>ç„¶åAngularJSä¼šè¿›å…¥åˆ°ç”±ä¸¤ä¸ªå°å¾ªç¯ç»„æˆçš„digestå¾ªç¯ä¸­ï¼Œä¸€ä¸ªå¾ªç¯æ˜¯ç”¨æ¥å¤„ç†evalAsyncé˜Ÿåˆ—ï¼ˆç”¨æ¥scheduleä¸€äº›éœ€è¦åœ¨æ¸²æŸ“è§†å›¾ä¹‹å‰å¤„ç†çš„æ“ä½œï¼Œé€šå¸¸é€šè¿‡setTimeout(0)å®ç°ï¼Œé€Ÿåº¦ä¼šæ¯”è¾ƒæ…¢ï¼Œå¯èƒ½ä¼šå‡ºç°è§†å›¾æŠ–åŠ¨çš„é—®é¢˜ï¼‰çš„ï¼Œä¸€ä¸ªå¾ªç¯æ˜¯å¤„ç†watchåˆ—è¡¨ï¼ˆæ˜¯ä¸€äº›è¡¨è¾¾å¼çš„é›†åˆï¼Œä¸€æ—¦æœ‰æ”¹å˜å‘ç”Ÿï¼Œé‚£ä¹ˆwatchå‡½æ•°å°±ä¼šè¢«è°ƒç”¨ï¼‰çš„ã€‚digestå¾ªç¯ä¼šä¸€ç›´è¿­ä»£çŸ¥é“evalAsyncé˜Ÿåˆ—ä¸ºç©ºå¹¶ä¸”$watchåˆ—è¡¨ä¹Ÿä¸ºç©ºçš„æ—¶å€™ï¼Œå³modelä¸å†æœ‰ä»»ä½•å˜åŒ–ã€‚</li>
<li>ä¸€æ—¦AngularJSçš„$digestå¾ªç¯ç»“æŸï¼Œæ•´ä¸ªæ‰§è¡Œå°±ä¼šç¦»å¼€AngularJSå’ŒJavascriptçš„contextï¼Œç´§æ¥ç€æµè§ˆå™¨å°±ä¼šæŠŠæ•°æ®æ”¹å˜åçš„è§†å›¾é‡æ–°æ¸²æŸ“å‡ºæ¥ã€‚</li>
</ul>
</li>
<li>iOSå¸¸ç”¨çš„MVVMæ¡†æ¶<ul>
<li>KVO  reactiveCocoa</li>
</ul>
</li>
<li>reactiveCocoaçš„æ ¸å¿ƒåŠŸèƒ½<ul>
<li>è‡ªåŠ¨åŒ–åŒå‘æ•°æ®ç»‘å®šã€æ¨¡å—åŒ–/ç»„ä»¶åŒ–(?)ã€ä¾èµ–æ³¨å…¥(æ— )ã€è¯­ä¹‰åŒ–æ ‡ç­¾(?)ç­‰</li>
<li>åƒKVO,ä½†å®ƒç”¨blocksä»£æ›¿äº†é‡å†™-observeValueForKeyPath:ofObject:change:context:</li>
<li>æä¾›äº†ä¸€ä¸ªå•ä¸€çš„ï¼Œç»Ÿä¸€çš„æ–¹æ³•å»å¤„ç†å¼‚æ­¥çš„è¡Œä¸º,åŒ…æ‹¬delegateæ–¹æ³•,blockså›è°ƒ,target-actionæœºåˆ¶,notificationså’ŒKVO.</li>
</ul>
</li>
<li>reactiveCocoaçš„åŸç†<ul>
<li>RACSignalå‘é€äº‹ä»¶æµç»™å®ƒçš„subscriberã€‚ç›®å‰æ€»å…±æœ‰ä¸‰ç§ç±»å‹çš„äº‹ä»¶ï¼šnextã€errorã€completedã€‚</li>
<li>RACSignalæœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥æ¥è®¢é˜…ä¸åŒçš„äº‹ä»¶ç±»å‹ã€‚æ¯ä¸ªæ–¹æ³•éƒ½éœ€è¦è‡³å°‘ä¸€ä¸ªblockï¼Œå½“äº‹ä»¶å‘ç”Ÿæ—¶å°±ä¼šæ‰§è¡Œblockä¸­çš„é€»è¾‘ã€‚</li>
<li>ä½¿ç”¨categoryæ¥ä¸ºå¾ˆå¤šåŸºæœ¬UIKitæ§ä»¶æ·»åŠ signalã€‚è¿™æ ·ä½ å°±èƒ½ç»™æ§ä»¶æ·»åŠ è®¢é˜…äº†ï¼Œtext fieldçš„rac_textSignalå°±æ˜¯è¿™ä¹ˆæ¥çš„ã€‚</li>
</ul>
</li>
<li>angularJSä¸reactiveCocoaçš„å¯¹æ¯”<ul>
<li>æ ¸å¿ƒåŠŸèƒ½å¯¹æ¯”</li>
<li>å®ç°åŸç†å¯¹æ¯”</li>
<li>å®é™…è¿ç”¨å¯¹æ¯”</li>
</ul>
</li>
</ol>
<h2 id="æ€»ç»“">æ€»ç»“</h2><blockquote>
<p>MVVMæ˜¯æœªæ¥</p>
</blockquote>

                    
                        
                    
                    
                        <p>
                            <a href="/2015/09/22/mvvm_profile/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="/2015/08/20/ios_thirdparty/">
                            iOSä¸‰æ–¹åº“æºç åŸºç¡€åˆ°è¿›é˜¶
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2015-08-20T18:15:02+08:00">
	
		    Aug 20, 2015
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <h2 id="å­¦ä¹ iOSä¸‰æ–¹åº“æºç éœ€è¦ä¼šä»€ä¹ˆï¼Ÿ">å­¦ä¹ iOSä¸‰æ–¹åº“æºç éœ€è¦ä¼šä»€ä¹ˆï¼Ÿ</h2><p>Githubå¼€æºåº“ä½•å…¶å¤šï¼Ÿç¬¬ä¸‰æ–¹SDKä½•å…¶å¤šï¼Ÿè¦åšåˆ°è¯†åˆ«å¥½çš„ï¼Œå¸æ”¶ç²¾åï¼Œå–å…¶æ€æƒ³ï¼Œå†ç»“åˆå®é™…å½¢æˆè‡ªå·±çš„æ€æƒ³æˆ–æ–¹æ¡ˆ</p>
<h2 id="iOSä¸‰æ–¹åº“æºç æ˜¯ä»€ä¹ˆï¼Ÿ">iOSä¸‰æ–¹åº“æºç æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>åˆ—ä¸€äº›ç»å…¸ä¸‰æ–¹åº“ï¼Œå¹¶é˜è¿°å…¶ä¸­å¿ƒæ€æƒ³</p>
<h4 id="å°å·¥å…·">å°å·¥å…·</h4><h6 id="MLeaksFinder">MLeaksFinder</h6><ol>
<li>ç»™UIApplicationæ·»åŠ Category <strong>UIApplication+MemoryLeak</strong></li>
<li>hookç³»ç»Ÿå‡½æ•°<strong>sendAction:to:from:forEvent:</strong>ä½¿ç”¨<strong>objc_setAssociatedObject</strong>å­˜å‚¨å½“å‰ç±»çš„sender</li>
<li>ç»™NSObjectæ·»åŠ Category <strong>NSObject+MemoryLeak</strong></li>
<li><strong>objc_getAssociatedObject</strong>è·å–å½“å‰ç±»çš„sender</li>
<li>å¦‚æœå½“å‰ç±»çš„senderä¸æ˜¯è‡ªå·±ï¼Œåˆ™å¯èƒ½æ˜¯æœ‰å†…å­˜æ³„éœ²å‘ç”Ÿï¼Œæ‰“å°å †æ ˆä¿¡æ¯åˆ°æ§åˆ¶å°</li>
<li><a href="https://github.com/Zepo/MLeaksFinder" target="_blank" rel="external">MLeaksFinder</a> å†…åµŒ <a href="https://github.com/facebook/FBRetainCycleDetector/tree/master/FBRetainCycleDetector" target="_blank" rel="external">FBRetainCycleDetector</a></li>
</ol>
<h6 id="FPSLabel">FPSLabel</h6><p>CADisplayLinkåœ¨å±å¹•åˆ·æ–°æ—¶è°ƒç”¨ï¼Œåˆ·æ–°ç‡é€šå¸¸<strong>60æ¬¡/ç§’</strong></p>
<ol>
<li>åˆ›å»ºdisplayLink </li>
<li>æ·»åŠ åˆ°RunLoop</li>
<li>tickä¸­ç”¨countè®°å½•<strong>æ¯ç§’</strong>è°ƒç”¨æ¬¡æ•°</li>
<li>fps = count / (link.timestamp - lastTime)</li>
<li><a href="https://github.com/yolynn-bird/YLFPSLabel" target="_blank" rel="external">YLFPSLabel</a></li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_link = [CADisplayLink displayLinkWithTarget:[YYWeakProxy proxyWithTarget:self] selector:@selector(tick:)];&#10;[_link addToRunLoop:[NSRunLoop mainRunLoop] forMode:NSRunLoopCommonModes];</span><br></pre></td></tr></table></figure>
<h6 id="é‡æŒ‡é’ˆæ£€æµ‹">é‡æŒ‡é’ˆæ£€æµ‹</h6><ol>
<li>ä½¿ç”¨fishhookæ›¿æ¢ç³»ç»ŸCåº“çš„freeå‡½æ•°</li>
<li>å°†freeæ‰çš„å†…å­˜å—å…¨éƒ¨å¡«å…¥0x55ï¼Œç¡®ä¿æºå¯¹è±¡è¢«æ“¦é™¤</li>
<li>è‡ªè¡Œç®¡ç†freeæ‰çš„å†…å­˜å—ï¼Œä¸ç«‹å³é‡Šæ”¾ï¼Œé˜²æ­¢ç³»ç»Ÿåˆ†é…ç»™å…¶å®ƒå¯¹è±¡ï¼Œä»…åœ¨å†…å­˜è¿‡å¤§æ—¶é€æ­¥é‡Šæ”¾</li>
<li>åœ¨freeæ‰çš„å†…å­˜å—é¦–éƒ¨ï¼Œå¡«å…¥ä¸€ä¸ªè‡ªå®šä¹‰å¯¹è±¡Checkerï¼Œè®°å½•åŸå¯¹è±¡ç±»å‹ï¼Œæ¥ç®¡åŸå¯¹è±¡çš„æ‰€æœ‰è°ƒç”¨ï¼Œä¸€æ—¦å‘ç°è°ƒç”¨ï¼Œåˆ™è¯´æ˜å­˜åœ¨é‡æŒ‡é’ˆ</li>
<li><a href="https://github.com/yolynn-bird/YLWildPointerChecker" target="_blank" rel="external">YLWildPointerChecker</a></li>
</ol>
<h4 id="AFNetWorking">AFNetWorking</h4><h6 id="AFNetWorkingå¦‚ä½•ç®¡ç†çº¿ç¨‹ï¼Ÿ">AFNetWorkingå¦‚ä½•ç®¡ç†çº¿ç¨‹ï¼Ÿ</h6><ol>
<li>åŸºäºNSURLConnection<ul>
<li>åªåˆ›å»ºä¸€æ¡çº¿ç¨‹å‘èµ·æ‰€æœ‰è¯·æ±‚å¹¶é˜»å¡ä»¥ç­‰å¾…å“åº”</li>
<li>ç½‘ç»œè¯·æ±‚ç»§æ‰¿è‡ªNSOperationï¼Œå†åŠ å…¥NSOperationQueue</li>
</ul>
</li>
<li>åŸºäºNSURLSession<br> <img src="https://www.processon.com/chart_image/5861da7ce4b02e6c0aee8e68.png" alt=""></li>
</ol>
<h6 id="NSURLSession_VS_NSURLConnection">NSURLSession VS NSURLConnection</h6><ol>
<li>NSURLConnection<ul>
<li>æ²¡æœ‰æä¾›æ¥å£è§£å†³å¤šä¸ªç½‘ç»œè¯·æ±‚å¯¹å¤šä¸ªçº¿ç¨‹ç®¡ç†</li>
<li>ä¸æ˜¯åŸºäºHTTP/2ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½è¦å‘èµ·ä¸‰æ¬¡æ¡æ‰‹ï¼Œå››æ¬¡æŒ¥æ‰‹</li>
</ul>
</li>
<li>NSURLSession<ul>
<li>åŸºäºHTTP/2</li>
<li>å€Ÿé‰´AFNetworkingå†…éƒ¨ç»´æŠ¤ä¸¤ä¸ªé˜Ÿåˆ—ï¼šä¸€ä¸ªå¤„ç†sessionå›è°ƒï¼Œä¸€ä¸ªå¤„ç†å“åº”å›è°ƒ</li>
</ul>
</li>
</ol>
<h4 id="SDWebImage">SDWebImage</h4><p><img src="https://www.processon.com/chart_image/5861dce9e4b078015c9fedae.png" alt=""></p>
<h4 id="ReactiveCocoa">ReactiveCocoa</h4><h6 id="æ€æƒ³">æ€æƒ³</h6><p>åˆ©ç”¨hook(é’©å­)ï¼Œhookæ˜¯ä¸€ç§ç”¨äºæ”¹å˜APIæ‰§è¡Œç»“æœçš„æŠ€æœ¯ï¼Œæ¯æ¬¡è°ƒç”¨APIè¿”å›ç»“æœä¹‹å‰ï¼Œå…ˆæ‰§è¡Œä½ è‡ªå·±çš„æ–¹æ³•ï¼Œæ”¹å˜ç»“æœçš„è¾“å‡º</p>
<h6 id="æ ¸å¿ƒæ–¹æ³•bind">æ ¸å¿ƒæ–¹æ³•bind</h6><p>bindå±äºRACåº•å±‚æ–¹æ³•ï¼Œä»¥å‰çš„å¼€å‘æ–¹å¼æ˜¯<strong>èµ‹å€¼</strong>ï¼Œè€ŒRACå¼€å‘æ–¹å¼é‡å¿ƒåœ¨äº<strong>ç»‘å®š</strong></p>
<h4 id="Mantle">Mantle</h4><h6 id="åŸç†">åŸç†</h6><ol>
<li>runtimeåŠ¨æ€è·å–å±æ€§ç±»å‹å’Œåå­—<ul>
<li>class_copyPropertyListè¿”å›ä¸€ä¸ªæ•°ç»„</li>
<li>property_getAttributes</li>
<li>__attribute__æœºåˆ¶ç»™æ–¹æ³•ã€å˜é‡ã€ç±»å‹å¢åŠ é¢å¤–çš„å±æ€§</li>
</ul>
</li>
<li>åˆ›å»ºå¯¹åº”çš„å¯¹è±¡å®ä¾‹</li>
<li>æ ¹æ®KVC(NSKeyValueCodingåè®®)æ¥ä¸ºå±æ€§è®¾ç½®å€¼</li>
<li><a href="http://blog.csdn.net/Hello_Hwc/article/details/51548128" target="_blank" rel="external">æ›´å¤šMantle</a></li>
</ol>
<h4 id="JSPatch">JSPatch</h4><h6 id="åŸç†-1">åŸç†</h6><p>JSä¼ é€’å­—ç¬¦ä¸²ç»™OCï¼ŒOCé€šè¿‡runtimeæ¥å£è°ƒç”¨å’Œæ›¿æ¢OCæ–¹æ³•</p>
<ol>
<li>runtimeé€šè¿‡ç±»å/æ–¹æ³•ååå°„è·å–ç›¸åº”çš„ç±»å’Œæ–¹æ³•</li>
<li>æ›¿æ¢æŸä¸ªç±»çš„æ–¹æ³•ä¸ºæ–°çš„å®ç°</li>
<li>æ–°æ³¨å†Œä¸€ä¸ªç±»ï¼Œä¸ºç±»æ·»åŠ æ–¹æ³•</li>
<li><a href="http://blog.cnbang.net/tech/2808/" target="_blank" rel="external">æ›´å¤šJSPatch</a></li>
</ol>
<h4 id="Alamofire">Alamofire</h4><p>åŸºäºNSURLSessionï¼Œä¹Ÿæœ‰åœºæ™¯ä¸é€‚ç”¨ï¼Œä¸¾ä¸ªğŸŒ°ï¼šä¸‹è½½10ä¸ªæ–‡ä»¶ï¼Œæ”¯æŒæœ€å¤§å¹¶å‘2ä¸ªï¼ŒNSURLSessionçš„timeoutIntervalForRequestå’ŒtimeoutIntervalForResourceä¸èƒ½æ»¡è¶³ï¼Œéœ€ç”¨NSOperationQuequeå®ç°</p>
<h6 id="å·¥ä½œæµ">å·¥ä½œæµ</h6><p><img src="http://cc.cocimg.com/api/uploads/20151117/1447728266491926.jpg" alt=""></p>
<p><a href="http://www.cocoachina.com/ios/20151117/14240.html" target="_blank" rel="external">æ›´å¤šAlamofire</a></p>
<h2 id="ä¸ºä»€ä¹ˆç”¨iOSä¸‰æ–¹åº“ï¼Ÿ">ä¸ºä»€ä¹ˆç”¨iOSä¸‰æ–¹åº“ï¼Ÿ</h2><h4 id="ç»„ä»¶åŒ–ï¼Œä»£ç å¤ç”¨">ç»„ä»¶åŒ–ï¼Œä»£ç å¤ç”¨</h4><h4 id="ç‰¹æ®Šå¤æ‚åŠŸèƒ½">ç‰¹æ®Šå¤æ‚åŠŸèƒ½</h4><h2 id="iOSä¸‰æ–¹åº“æ€ä¹ˆç”¨ï¼Ÿ">iOSä¸‰æ–¹åº“æ€ä¹ˆç”¨ï¼Ÿ</h2><h4 id="SDK">SDK</h4><h6 id="é™æ€åº“_-a">é™æ€åº“ .a</h6><h6 id="ç±»åº“_-framework">ç±»åº“ .framework</h6><h6 id="èµ„æºæ–‡ä»¶_-bundle">èµ„æºæ–‡ä»¶ .bundle</h6><h4 id="pod">pod</h4><h2 id="iOSä¸‰æ–¹åº“çš„å®é™…åº”ç”¨">iOSä¸‰æ–¹åº“çš„å®é™…åº”ç”¨</h2><h4 id="XXä¼š">XXä¼š</h4><h4 id="XXèœ‚">XXèœ‚</h4>
                    
                        
                    
                    
                        <p>
                            <a href="/2015/08/20/ios_thirdparty/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="/2015/08/10/ios_thread/">
                            iOSå¤šçº¿ç¨‹åŸºç¡€åˆ°è¿›é˜¶
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2015-08-10T18:15:02+08:00">
	
		    Aug 10, 2015
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <h2 id="å­¦ä¹ iOSå¤šçº¿ç¨‹éœ€è¦ä¼šä»€ä¹ˆï¼Ÿ">å­¦ä¹ iOSå¤šçº¿ç¨‹éœ€è¦ä¼šä»€ä¹ˆï¼Ÿ</h2><p>è¿›ç¨‹æ˜¯ç³»ç»Ÿä¸­å¹¶å‘æ‰§è¡Œçš„åŸºæœ¬å•ä½ï¼Œçº¿ç¨‹æ˜¯è¿›ç¨‹ä¸­æ‰§è¡Œè¿ç®—çš„æœ€å°å•ä½ã€‚</p>
<h2 id="iOSå¤šçº¿ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ">iOSå¤šçº¿ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ</h2><h4 id="Pthreads">Pthreads</h4><p>åŸºäºCè¯­è¨€ï¼Œç§»æ¤æ€§å¼º</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#import &#60;pthread.h&#62;&#10;pthread_t thread;&#10;pthread_create(&#38;thread, NULL, start, NULL);</span><br></pre></td></tr></table></figure>
<h4 id="NSThread">NSThread</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSThread *thread = [[NSThread alloc] initWithTarget:self selector:@selector(run:) object:nil];&#10;[thread start];</span><br></pre></td></tr></table></figure>
<h4 id="GCD">GCD</h4><h6 id="å¼‚æ­¥">å¼‚æ­¥</h6><p>å¼‚æ­¥å’ŒåŒæ­¥æœ€å¤§çš„åŒºåˆ«åœ¨äºå¼‚æ­¥ä¸ä¼š<strong>é˜»å¡å½“å‰çº¿ç¨‹</strong>ï¼Œæ˜¯å¦ç­‰å¾…blockå®Œæˆåè¿”å›</p>
<h6 id="é˜Ÿåˆ—">é˜Ÿåˆ—</h6><ol>
<li>ä¸²è¡Œé˜Ÿåˆ—<ul>
<li>ä¸»é˜Ÿåˆ—                 dispatch_get_main_queue()</li>
<li>è‡ªå®šä¹‰é˜Ÿåˆ—            dispatch_queue_create(â€œç§æœ‰ä¸²è¡Œâ€, DISPATCH_QUEUE_SERIAL)</li>
</ul>
</li>
<li>å¹¶è¡Œé˜Ÿåˆ—<ul>
<li>å…¨å±€å¹¶å‘é˜Ÿåˆ—            dispatch_get_global_queue()</li>
<li>è‡ªå®šä¹‰é˜Ÿåˆ—            dispatch_queue_create(â€œç§æœ‰å¹¶è¡Œâ€, DISPATCH_QUEUE_CONCURRENT)</li>
</ul>
</li>
</ol>
<h6 id="ä»»åŠ¡">ä»»åŠ¡</h6><ol>
<li>dispatch_sync(queue, block)</li>
<li>dispatch_async(queue, block)</li>
<li>dispatch_barrier_sync(queue, block)<ul>
<li>ä¼ å…¥çš„queueæ˜¯è‡ªå®šä¹‰DISPATCH_QUEUE_CONCURRENT queue</li>
<li>é˜»å¡queue </li>
<li>æ‰§è¡Œblockå‰çš„ä»»åŠ¡åï¼Œæ‰§è¡Œblockï¼Œè§£é™¤é˜»å¡</li>
</ul>
</li>
<li>dispatch_barrier_async(queue, block)<ul>
<li>ä¼ å…¥çš„queueæ˜¯è‡ªå®šä¹‰DISPATCH_QUEUE_CONCURRENT queue</li>
<li>é˜»å¡queue </li>
<li>é˜»å¡å½“å‰çº¿ç¨‹</li>
</ul>
</li>
</ol>
<h6 id="é˜Ÿåˆ—_+_ä»»åŠ¡">é˜Ÿåˆ— + ä»»åŠ¡</h6><ol>
<li>é˜Ÿåˆ—ç»„<ul>
<li>dispatch_group_create()</li>
<li>dispatch_group_async(group, queue, block)</li>
<li>dispatch_group_notify(group, queue, block)</li>
</ul>
</li>
</ol>
<p><a href="http://tutuge.me/2015/04/03/something-about-gcd/index.html" target="_blank" rel="external">æŸ¥çœ‹æ›´å¤šå…³äºGCDçš„å‘</a></p>
<h4 id="NSOperation_&amp;_NSOperationQueue">NSOperation &amp; NSOperationQueue</h4><p>æ˜¯å¯¹GCDæ›´é«˜ä¸€å±‚çš„å°è£…</p>
<h6 id="NSOperation">NSOperation</h6><ol>
<li>NSInvocationOperation </li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSInvocationOperation *operation = [[NSInvocationOperation alloc] initWithTarget:self selector:@selector(run) object:nil];&#10;[operation start];</span><br></pre></td></tr></table></figure>
<ol>
<li>NSBlockOperation</li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSBlockOperation *operation = [NSBlockOperation blockOperationWithBlock:^&#123;&#10;      NSLog(@&#34;%@&#34;, [NSThread currentThread]);&#10;  &#125;];&#10;  &#10;//&#28155;&#21152;&#22810;&#20010;Block&#65292;&#25903;&#25345;&#22810;&#32447;&#31243;&#10;for (NSInteger i = 0; i &#60; 5; i++) &#123;&#10;&#9;[operation addExecutionBlock:^&#123;&#10;&#9;NSLog(@&#34;&#31532;%ld&#27425;&#65306;%@&#34;, i, [NSThread currentThread]);&#10;&#9;&#125;];&#10;&#125;&#10;&#10;[operation start];</span><br></pre></td></tr></table></figure>
<h6 id="NSOperationQueue">NSOperationQueue</h6><ol>
<li>ä¸»é˜Ÿåˆ—<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSOperationQueue *queue = [NSOperationQueue mainQueue];</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol>
<li>å…¶å®ƒé˜Ÿåˆ—</li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//1.&#21019;&#24314;&#19968;&#20010;&#20854;&#20182;&#38431;&#21015;    &#10;NSOperationQueue *queue = [[NSOperationQueue alloc] init];&#10;&#10;//2.&#21019;&#24314;NSBlockOperation&#23545;&#35937;&#10;NSBlockOperation *operation = [NSBlockOperation blockOperationWithBlock:^&#123;&#10;    NSLog(@&#34;%@&#34;, [NSThread currentThread]);&#10;&#125;];&#10;&#10;//3.&#28155;&#21152;&#22810;&#20010;Block&#10;for (NSInteger i = 0; i &#60; 5; i++) &#123;&#10;    [operation addExecutionBlock:^&#123;&#10;        NSLog(@&#34;&#31532;%ld&#27425;&#65306;%@&#34;, i, [NSThread currentThread]);&#10;    &#125;];&#10;&#125;&#10;&#10;//4.&#38431;&#21015;&#28155;&#21152;&#20219;&#21153;&#10;[queue addOperation:operation];</span><br></pre></td></tr></table></figure>
<ol>
<li>maxConcurrentOperationCount æœ€å¤§å¹¶å‘æ•°</li>
<li>ä»»åŠ¡ä¾èµ–</li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//1.&#20219;&#21153;&#19968;&#65306;&#19979;&#36733;&#22270;&#29255;&#10;NSBlockOperation *operation1 = [NSBlockOperation blockOperationWithBlock:^&#123;&#10;    NSLog(@&#34;&#19979;&#36733;&#22270;&#29255; - %@&#34;, [NSThread currentThread]);&#10;    [NSThread sleepForTimeInterval:1.0];&#10;&#125;];&#10;&#10;//2.&#20219;&#21153;&#20108;&#65306;&#25171;&#27700;&#21360;&#10;NSBlockOperation *operation2 = [NSBlockOperation blockOperationWithBlock:^&#123;&#10;    NSLog(@&#34;&#25171;&#27700;&#21360;   - %@&#34;, [NSThread currentThread]);&#10;    [NSThread sleepForTimeInterval:1.0];&#10;&#125;];&#10;&#10;//3.&#20219;&#21153;&#19977;&#65306;&#19978;&#20256;&#22270;&#29255;&#10;NSBlockOperation *operation3 = [NSBlockOperation blockOperationWithBlock:^&#123;&#10;    NSLog(@&#34;&#19978;&#20256;&#22270;&#29255; - %@&#34;, [NSThread currentThread]);&#10;    [NSThread sleepForTimeInterval:1.0];&#10;&#125;];&#10;&#10;//4.&#35774;&#32622;&#20381;&#36182;&#10;[operation2 addDependency:operation1];      //&#20219;&#21153;&#20108;&#20381;&#36182;&#20219;&#21153;&#19968;&#10;[operation3 addDependency:operation2];      //&#20219;&#21153;&#19977;&#20381;&#36182;&#20219;&#21153;&#20108;&#10;&#10;//5.&#21019;&#24314;&#38431;&#21015;&#24182;&#21152;&#20837;&#20219;&#21153;&#10;NSOperationQueue *queue = [[NSOperationQueue alloc] init];&#10;[queue addOperations:@[operation3, operation2, operation1] waitUntilFinished:NO];</span><br></pre></td></tr></table></figure>
<h2 id="ä¸ºä»€ä¹ˆè¦ç”¨iOSå¤šçº¿ç¨‹ï¼Ÿ">ä¸ºä»€ä¹ˆè¦ç”¨iOSå¤šçº¿ç¨‹ï¼Ÿ</h2><ol>
<li>æ˜“äºè°ƒåº¦ã€æé«˜å¹¶å‘ã€å……åˆ†å‘æŒ¥ç¡¬ä»¶å¤šæ ¸ä¼˜åŠ¿</li>
</ol>
<h2 id="iOSå¤šçº¿ç¨‹æ€ä¹ˆç”¨ï¼Ÿ">iOSå¤šçº¿ç¨‹æ€ä¹ˆç”¨ï¼Ÿ</h2><h4 id="æ­»é”">æ­»é”</h4><h6 id="ä¸ºä»€ä¹ˆæ­»é”">ä¸ºä»€ä¹ˆæ­»é”</h6><p>ä½¿ç”¨åŒæ­¥å‡½æ•°æ·»åŠ ä»»åŠ¡é˜»å¡å½“å‰çº¿ç¨‹ï¼Œåˆ™å½“å‰çº¿ç¨‹ä»»åŠ¡éœ€ç­‰å¾…æ·»åŠ çš„ä»»åŠ¡ï¼Œè¢«æ·»åŠ åˆ°é˜Ÿåˆ—çš„ä»»åŠ¡å…·æœ‰FIFOæ€§è´¨ï¼Œå®ƒä¹Ÿåœ¨ç­‰å¾…å½“å‰çº¿ç¨‹ä»»åŠ¡æ‰§è¡Œï¼Œè¿›å…¥ç›¸äº’ç­‰å¾…é€ æˆæ­»é”ã€‚</p>
<h6 id="æ€ä¹ˆé¿å…æ­»é”">æ€ä¹ˆé¿å…æ­»é”</h6><ol>
<li>åŒæ­¥è½¬å¼‚æ­¥ï¼Œé‡Šæ”¾é˜»å¡</li>
<li>ä»»åŠ¡æ·»åŠ åˆ°å¹¶å‘é˜Ÿåˆ—æˆ–å…¶å®ƒé˜Ÿåˆ—</li>
</ol>
<h4 id="çº¿ç¨‹å®‰å…¨">çº¿ç¨‹å®‰å…¨</h4><p>å¤šä¸ªçº¿ç¨‹æŠ¢å åŒä¸€èµ„æºè¿›è¡Œæ“ä½œï¼Œå¦‚ä½•é¿å…ï¼Ÿ</p>
<ol>
<li>@synchronized(self)</li>
<li>dispatch_semaphore<ul>
<li>dispatch_semaphore_create(1)<ul>
<li>dispatch_semaphore_signal </li>
<li>dispatch_semaphore_wait</li>
</ul>
</li>
</ul>
</li>
<li>NSLock</li>
<li>pthread_mutex </li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (void)runSemaphore &#123;&#10;    &#10;    // 2, dispatch_semaphore&#10;    dispatch_semaphore_t signal = dispatch_semaphore_create(1);&#10;    dispatch_time_t overtime = dispatch_time(DISPATCH_TIME_NOW, 3 * NSEC_PER_SEC);&#10;    &#10;    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;&#10;        &#10;        dispatch_semaphore_wait(signal, overtime);  //signal value - 1&#10;        NSLog(@&#34;&#25805;&#20316;1&#65292;&#24320;&#22987;&#34;);&#10;        sleep(2);&#10;        NSLog(@&#34;&#25805;&#20316;1&#65292;&#32467;&#26463;&#34;);&#10;        dispatch_semaphore_signal(signal); //signal value + 1&#10;    &#125;);&#10;    &#10;    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;&#10;        &#10;        sleep(1);&#10;        dispatch_semaphore_wait(signal, overtime);  //signal value = 0  to  1&#10;        NSLog(@&#34;&#25805;&#20316;2&#65292;&#24320;&#22987;&#34;);&#10;        dispatch_semaphore_signal(signal);  //signal value = 2&#10;    &#125;);&#10;    &#10;&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å»¶è¿Ÿæ‰§è¡Œ">å»¶è¿Ÿæ‰§è¡Œ</h4><h6 id="perform">perform</h6><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[self performSelector:@selector(run:) withObject:@&#34;abc&#34; afterDelay:3];</span><br></pre></td></tr></table></figure>
<h6 id="GCD-1">GCD</h6><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">// &#21019;&#24314;&#38431;&#21015;&#10;dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);&#10;// &#35774;&#32622;&#24310;&#26102;&#65292;&#21333;&#20301;&#31186;&#10;double delay = 3; &#10;&#10;dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(delay * NSEC_PER_SEC)), queue, ^&#123;&#10;    // 3&#31186;&#21518;&#38656;&#35201;&#25191;&#34892;&#30340;&#20219;&#21153;&#10;&#125;);</span><br></pre></td></tr></table></figure>
<h6 id="NSTimer">NSTimer</h6><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[NSTimer scheduledTimerWithTimeInterval:3.0 target:self selector:@selector(run:) userInfo:@&#34;abc&#34; repeats:NO];</span><br></pre></td></tr></table></figure>
<h4 id="å•ä¾‹_dispatch_once">å•ä¾‹ dispatch_once</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@interface Tool : NSObject &#60;NSCopying&#62;&#10;&#10;+ (instancetype)sharedTool;&#10;&#10;@end&#10;&#10;@implementation Tool&#10;&#10;static id _instance;&#10;&#10;+ (instancetype)sharedTool &#123;&#10;    static dispatch_once_t onceToken;&#10;    dispatch_once(&#38;onceToken, ^&#123;&#10;        _instance = [[Tool alloc] init];&#10;    &#125;);&#10;&#10;    return _instance;&#10;&#125;&#10;&#10;@end</span><br></pre></td></tr></table></figure>
<h4 id="å…¶å®ƒçº¿ç¨‹å›ä¸»çº¿ç¨‹">å…¶å®ƒçº¿ç¨‹å›ä¸»çº¿ç¨‹</h4><ul>
<li>NSThread</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[self performSelectorOnMainThread:@selector(run) withObject:nil waitUntilDone:NO];</span><br></pre></td></tr></table></figure>
<ul>
<li>GCD</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dispatch_async(dispatch_get_main_queue(), ^&#123;&#10;&#10;&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>NSOperation</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[NSOperationQueue mainQueue] addOperationWithBlock:^&#123;&#10;&#10;&#125;];</span><br></pre></td></tr></table></figure>
<h2 id="iOSå¤šçº¿ç¨‹çš„å®é™…åº”ç”¨">iOSå¤šçº¿ç¨‹çš„å®é™…åº”ç”¨</h2><h4 id="XXä¼š">XXä¼š</h4><h4 id="Xèœ‚">Xèœ‚</h4>
                    
                        
                    
                    
                        <p>
                            <a href="/2015/08/10/ios_thread/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="/2015/07/20/ios_arc_mrc/">
                            iOSå†…å­˜ç®¡ç†åŸºç¡€åˆ°è¿›é˜¶
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2015-07-20T18:15:02+08:00">
	
		    Jul 20, 2015
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <h2 id="å­¦ä¹ å†…å­˜ç®¡ç†éœ€è¦ä¼šä»€ä¹ˆï¼Ÿ">å­¦ä¹ å†…å­˜ç®¡ç†éœ€è¦ä¼šä»€ä¹ˆï¼Ÿ</h2><p>æ€è€ƒä¸‹ï¼Œè‹¹æœä¸ºä»€ä¹ˆæœ‰äº†MRCåˆè®¾è®¡ARCï¼Ÿ</p>
<p>iOSå†…å­˜ç®¡ç†æ¨¡å‹</p>
<ol>
<li>è‡ªåŠ¨åƒåœ¾æ”¶é›†ï¼ˆiOSç¯å¢ƒä¸æ”¯æŒï¼‰</li>
<li>æ‰‹åŠ¨å¼•ç”¨è®¡æ•°å’Œè‡ªåŠ¨é‡Šæ”¾æ± ï¼ˆMRCï¼‰</li>
<li>è‡ªåŠ¨å¼•ç”¨è®¡æ•°ï¼ˆARCï¼‰  </li>
</ol>
<h2 id="å†…å­˜ç®¡ç†æ˜¯ä»€ä¹ˆï¼Ÿ">å†…å­˜ç®¡ç†æ˜¯ä»€ä¹ˆï¼Ÿ</h2><h3 id="MRC">MRC</h3><h4 id="å¼•ç”¨è®¡æ•°å™¨">å¼•ç”¨è®¡æ•°å™¨</h4><ol>
<li>å¯¹è±¡è¢«å¼•ç”¨çš„æ¬¡æ•°ï¼Œä¹Ÿå¯è¯´æœ‰å¤šå°‘äººæ­£åœ¨ç”¨è¿™ä¸ªå¯¹è±¡</li>
<li>åˆå§‹åŒ–æ—¶ä¸º1<ul>
<li>åˆ›å»ºå¹¶æŒæœ‰å¯¹è±¡ï¼šalloc new copy mutableCopy</li>
<li>æŒæœ‰å¯¹è±¡ï¼šretain</li>
</ul>
</li>
<li>è®¡æ•°ä¸º0æ—¶ï¼Œå¯¹è±¡å ç”¨çš„å†…å­˜è¢«ç³»ç»Ÿå›æ”¶</li>
</ol>
<h4 id="å¼•ç”¨è®¡æ•°å™¨æ“ä½œ">å¼•ç”¨è®¡æ•°å™¨æ“ä½œ</h4><ol>
<li>retain +1</li>
<li>release -1</li>
<li>retainCount æ˜¾ç¤ºè®¡æ•°</li>
</ol>
<h4 id="deallocæ–¹æ³•">deallocæ–¹æ³•</h4><ol>
<li>[super dealloc];ä¸€å®šåœ¨æœ€åä¸€è¡Œ</li>
<li>ä¸èƒ½ç›´æ¥è°ƒç”¨</li>
<li>ä¸€æ—¦å¯¹è±¡è¢«å›æ”¶ï¼Œç»§ç»­ä½¿ç”¨ä¼šé‡æŒ‡é’ˆ</li>
</ol>
<h4 id="é‡æŒ‡é’ˆ_&amp;_ç©ºæŒ‡é’ˆ">é‡æŒ‡é’ˆ &amp; ç©ºæŒ‡é’ˆ</h4><ol>
<li>é‡æŒ‡é’ˆå³ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘äº†â€œ<strong>åƒµå°¸å¯¹è±¡</strong>ï¼ˆä¸èƒ½å†ä½¿ç”¨çš„å¯¹è±¡ï¼‰â€</li>
<li>ç»™é‡æŒ‡é’ˆå‘æ¶ˆæ¯æŠ¥é”™ï¼šEXC_BAD_ACCESS</li>
<li>é¿å…é‡æŒ‡é’ˆå‘æ¶ˆæ¯æŠ¥é”™ï¼Œå¯¹è±¡é‡Šæ”¾åï¼Œå°†æŒ‡é’ˆç½®ä¸ºç©ºæŒ‡é’ˆ<ul>
<li>ç©ºæŒ‡é’ˆå³æ²¡æœ‰æŒ‡å‘ä»»ä½•å­˜å‚¨ç©ºé—´ï¼ˆå­˜çš„nilï¼‰</li>
<li>å‘ç©ºæŒ‡é’ˆå‘é€æ¶ˆæ¯æ²¡æœ‰ä»»ä½•ååº”</li>
</ul>
</li>
</ol>
<h4 id="MRC_å•ä¸ªå¯¹è±¡ç®¡ç†">MRC å•ä¸ªå¯¹è±¡ç®¡ç†</h4><ol>
<li>è°åˆ›å»º(alloc copy)ï¼Œè°release</li>
<li>è°retain, è°release</li>
</ol>
<h4 id="MRC_å¤šä¸ªå¯¹è±¡ç®¡ç†">MRC å¤šä¸ªå¯¹è±¡ç®¡ç†</h4><p><img src="https://www.processon.com/chart_image/5864740be4b0e069269f1e34.png" alt=""></p>
<ol>
<li>setteræ–¹æ³•</li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (void)setRoom:(Room *)room &#123;&#10;&#9;// &#21482;&#26377;&#25151;&#38388;&#19981;&#21516;&#26102;&#25165;&#38656;&#35201;release &#21644; retain&#10;&#9;if (_room != room) &#123;&#10;&#9;&#9;// &#23558;&#20197;&#21069;&#30340;&#25151;&#38388;release -1&#10;&#9;&#9;[_room release];&#10;&#9;&#9;&#10;&#9;&#9;_room = [room retain];&#10;&#9;&#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<h4 id="MRC_@propertyå‚æ•°">MRC @propertyå‚æ•°</h4><ol>
<li>æˆå‘˜å˜é‡å‰åŠ ä¸Š<strong>@property</strong>ï¼Œè‡ªåŠ¨ç”Ÿæˆ<strong>åŸºæœ¬</strong>çš„setter/getter</li>
<li>propertyåŠ ä¸Š<strong>retain</strong>ï¼Œè‡ªåŠ¨ç”Ÿæˆ<strong>æœ‰å†…å­˜ç®¡ç†</strong>çš„setter/getter</li>
<li>propertyåŠ ä¸Š<strong>assign</strong>ï¼Œè‡ªåŠ¨ç”ŸæˆåŸºæœ¬çš„setter/getterï¼Œ<strong>é»˜è®¤</strong>ä»€ä¹ˆéƒ½ä¸åŠ å°±æ˜¯assign</li>
</ol>
<h4 id="MRC_å¾ªç¯å¼•ç”¨">MRC å¾ªç¯å¼•ç”¨</h4><ul>
<li>å½“ä¸¤ç«¯äº’ç›¸å¼•ç”¨æ—¶ï¼Œåº”è¯¥ä¸€ç«¯ç”¨retainï¼Œä¸€ç«¯ç”¨assign</li>
</ul>
<h4 id="autoreleasepool">autoreleasepool</h4><ol>
<li><strong>[p autorelease]</strong> ç»™på‘é€ä¸€æ¡autoreleaseæ¶ˆæ¯ï¼Œå°†pæ”¾åˆ°autoreleasepoolï¼Œåœ¨autoreleasepoolé‡Šæ”¾æ—¶åšä¸€æ¬¡releaseæ“ä½œ</li>
<li>autoreleaseæ–¹æ³•è¿”å›å¯¹è±¡æœ¬èº«ï¼Œå¼•ç”¨è®¡æ•°ä¸ä¼šå˜åŒ–</li>
</ol>
<h6 id="autoreleasepool_å¥½å¤„">autoreleasepool å¥½å¤„</h6><ol>
<li>ä¸ç”¨å…³å¿ƒé‡Šæ”¾æ—¶é—´</li>
<li>ä¸ç”¨å…³å¿ƒä»€ä¹ˆæ—¶å€™è°ƒç”¨release</li>
</ol>
<h6 id="autoreleasepool_åŸç†">autoreleasepool åŸç†</h6><p>autoreleasepoolå®é™…ä¸Šåªæ˜¯æŠŠå¯¹releaseçš„è°ƒç”¨å»¶è¿Ÿäº†</p>
<ol>
<li>å£°æ˜__autoreleasepoolæ—¶ï¼Œæ„é€ å‡½æ•°<strong>__AtAutoreleasePool()</strong>æ‰§è¡Œï¼Œå³<strong>atautoreleasepoolobj = objc_autoreleasePoolPush()</strong></li>
<li>å‡ºäº†å½“å‰ä½œç”¨åŸŸæ—¶ï¼Œææ„å‡½æ•°<strong>~__AtAutoreleasePool()</strong>æ‰§è¡Œï¼Œå³<strong>objc_autoreleasePoolPop(atautoreleasepoolobj)</strong></li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> __declspec(dllimport) <span class="function"><span class="keyword">void</span> * <span class="title">objc_autoreleasePoolPush</span><span class="params">(<span class="keyword">void</span>)</span></span>;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> __declspec(dllimport) <span class="function"><span class="keyword">void</span> <span class="title">objc_autoreleasePoolPop</span><span class="params">(<span class="keyword">void</span> *)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> __AtAutoreleasePool &#123;</span><br><span class="line">  __AtAutoreleasePool() &#123;atautoreleasepoolobj = objc_autoreleasePoolPush();&#125;</span><br><span class="line">  ~__AtAutoreleasePool() &#123;objc_autoreleasePoolPop(atautoreleasepoolobj);&#125;</span><br><span class="line">  <span class="keyword">void</span> * atautoreleasepoolobj;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* @autoreleasepool */</span> &#123; __AtAutoreleasePool __autoreleasepool;&#125;</span><br></pre></td></tr></table></figure>
<p>ç®€åŒ–ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* @autoreleasepool */</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> *atautoreleasepoolobj = objc_autoreleasePoolPush();</span><br><span class="line">    <span class="comment">// ç”¨æˆ·ä»£ç ï¼Œæ‰€æœ‰æ¥æ”¶åˆ° autorelease æ¶ˆæ¯çš„å¯¹è±¡ä¼šè¢«æ·»åŠ åˆ°è¿™ä¸ª autoreleasepool ä¸­</span></span><br><span class="line">    objc_autoreleasePoolPop(atautoreleasepoolobj);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>PUSHæ“ä½œ</li>
</ul>
<p>æ¯è°ƒç”¨ä¸€æ¬¡ push æ“ä½œå°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ autoreleasepool ï¼Œå³å¾€ AutoreleasePoolPage ä¸­æ’å…¥ä¸€ä¸ª POOL_SENTINEL ï¼Œå¹¶ä¸”è¿”å›æ’å…¥çš„ POOL_SENTINEL çš„å†…å­˜åœ°å€ã€‚</p>
<ul>
<li>Autoreleaseæ“ä½œ</li>
</ul>
<p>å®ƒè·Ÿ push æ“ä½œçš„å®ç°éå¸¸ç›¸ä¼¼ã€‚åªä¸è¿‡ push æ“ä½œæ’å…¥çš„æ˜¯ä¸€ä¸ª POOL_SENTINEL ï¼Œè€Œ autorelease æ“ä½œæ’å…¥çš„æ˜¯ä¸€ä¸ªå…·ä½“çš„ autoreleased å¯¹è±¡</p>
<ul>
<li>POPæ“ä½œ</li>
</ul>
<p>pop å‡½æ•°çš„å…¥å‚å°±æ˜¯ push å‡½æ•°çš„è¿”å›å€¼ï¼Œä¹Ÿå°±æ˜¯ POOL_SENTINEL çš„å†…å­˜åœ°å€ï¼Œå³ pool token ã€‚å½“æ‰§è¡Œ pop æ“ä½œæ—¶ï¼Œå†…å­˜åœ°å€åœ¨ pool token ä¹‹åçš„æ‰€æœ‰ autoreleased å¯¹è±¡éƒ½ä¼šè¢« release</p>
<h6 id="autoreleasepool_åˆ›å»ºå’Œä½¿ç”¨">autoreleasepool åˆ›å»ºå’Œä½¿ç”¨</h6><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">// &#26041;&#24335;1&#10;NSAutoreleasePool *autoreleasePool = [[NSAutoreleasePool alloc] init];&#10;Person *p = [[[Person alloc] init] autorelease];&#10;[autoreleasePool drain];&#10;&#10;// &#26041;&#24335;2&#10;@autoreleasepool&#10;&#123; // &#21019;&#24314;&#19968;&#20010;&#33258;&#21160;&#37322;&#25918;&#27744;&#10;        Person *p = [[Person new] autorelease];&#10;        // &#23558;&#20195;&#30721;&#20889;&#21040;&#36825;&#37324;&#23601;&#25918;&#20837;&#20102;&#33258;&#21160;&#37322;&#25918;&#27744;&#10;&#125; // &#38144;&#27585;&#33258;&#21160;&#37322;&#25918;&#27744;(&#20250;&#32473;&#27744;&#23376;&#20013;&#25152;&#26377;&#23545;&#35937;&#21457;&#36865;&#19968;&#26465;release&#28040;&#24687;)</span><br></pre></td></tr></table></figure>
<h6 id="autoreleasepool_æ³¨æ„">autoreleasepool æ³¨æ„</h6><ul>
<li>å¹¶ä¸æ˜¯æ”¾åˆ°autoreleasepoolä»£ç ä¸­,éƒ½ä¼šè‡ªåŠ¨åŠ å…¥åˆ°è‡ªåŠ¨é‡Šæ”¾æ± </li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@autoreleasepool &#123;&#10;    // &#22240;&#20026;&#27809;&#26377;&#35843;&#29992; autorelease &#26041;&#27861;,&#25152;&#20197;&#23545;&#35937;&#27809;&#26377;&#21152;&#20837;&#21040;&#33258;&#21160;&#37322;&#25918;&#27744;&#10;    Person *p = [[Person alloc] init];&#10;    [p run];&#10;&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>autoreleaseæ˜¯ä¸€ä¸ªæ–¹æ³•, åªæœ‰åœ¨autoreleasepoolä¸­è°ƒç”¨æ‰æœ‰æ•ˆ</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@autoreleasepool &#123;&#10;&#125;&#10;// &#27809;&#26377;&#19982;&#20043;&#23545;&#24212;&#30340;&#33258;&#21160;&#37322;&#25918;&#27744;, &#21482;&#26377;&#22312;&#33258;&#21160;&#37322;&#25918;&#27744;&#20013;&#35843;&#29992;autorelease&#25165;&#20250;&#25918;&#21040;&#37322;&#25918;&#27744;&#10;Person *p = [[[Person alloc] init] autorelease];&#10;[p run];&#10;&#10;// &#27491;&#30830;&#20889;&#27861;&#10;@autoreleasepool &#123;&#10;    Person *p = [[[Person alloc] init] autorelease];&#10; &#125;&#10;&#10;// &#27491;&#30830;&#20889;&#27861;&#10;Person *p = [[Person alloc] init];&#10;@autoreleasepool &#123;&#10;    [p autorelease];&#10;&#125;</span><br></pre></td></tr></table></figure>
<h6 id="autoreleasepool_åµŒå¥—">autoreleasepool åµŒå¥—</h6><ol>
<li>AutoreleasePool ä»¥ <strong>æ ˆ</strong>å½¢å¼å­˜åœ¨</li>
<li>æ ˆåªæœ‰ä¸€ä¸ªå…¥å£ï¼Œè°ƒç”¨autoreleaseä¼šå°†å¯¹è±¡æ”¾åˆ°<strong>æ ˆé¡¶çš„è‡ªåŠ¨é‡Šæ”¾æ± </strong></li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@autoreleasepool &#123; // &#26632;&#24213;&#33258;&#21160;&#37322;&#25918;&#27744;&#10;    @autoreleasepool &#123;&#10;        @autoreleasepool &#123; // &#26632;&#39030;&#33258;&#21160;&#37322;&#25918;&#27744;&#10;            Person *p = [[[Person alloc] init] autorelease];&#10;        &#125;&#10;        Person *p = [[[Person alloc] init] autorelease];&#10;    &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<h6 id="autoreleasepool_forå¾ªç¯">autoreleasepool forå¾ªç¯</h6><ol>
<li>å°½é‡é¿å…å¯¹å¤§å†…å­˜ä½¿ç”¨autorelease</li>
<li>ä¸è¦æŠŠforå¾ªç¯æ”¾åœ¨@autoreleasepoolä¹‹é—´ï¼Œä¼šé€ æˆå†…å­˜å³°å€¼ä¸Šå‡</li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">// &#20869;&#23384;&#26292;&#28072;&#10;@autoreleasepool &#123;&#10;    for (int i = 0; i &#60; 99999; ++i) &#123;&#10;        Person *p = [[[Person alloc] init] autorelease];&#10;    &#125;&#10;&#125;&#10;&#10;// &#20869;&#23384;&#19981;&#20250;&#26292;&#28072;&#10;for (int i = 0; i &#60; 99999; ++i) &#123;&#10;    @autoreleasepool &#123;&#10;        Person *p = [[[Person alloc] init] autorelease];&#10;    &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<h6 id="autoreleasepool_é”™è¯¯ç”¨æ³•">autoreleasepool é”™è¯¯ç”¨æ³•</h6><ol>
<li>ä¸èƒ½è¿ç»­è°ƒç”¨autorelease</li>
<li>è°ƒç”¨autoreleaseååˆè°ƒç”¨release</li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@autoreleasepool &#123;&#10; // &#38169;&#35823;&#20889;&#27861;, &#36807;&#24230;&#37322;&#25918;&#10;    Person *p = [[[[Person alloc] init] autorelease] autorelease];&#10; &#125;&#10; &#10; @autoreleasepool &#123;&#10;    Person *p = [[[Person alloc] init] autorelease];&#10;    [p release]; // &#38169;&#35823;&#20889;&#27861;, &#36807;&#24230;&#37322;&#25918;&#10;&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ARC">ARC</h3><ol>
<li>Automatic Reference Countingï¼Œè‡ªåŠ¨å¼•ç”¨è®¡æ•°ï¼Œè‡ªiOS5 LLVM3.0å¼•å…¥</li>
<li>è§£å†³äº†å¹¿å¤§iOSå¼€å‘è€…æ‰€æ†æ¨çš„æ‰‹åŠ¨å†…å­˜ç®¡ç†çš„éº»çƒ¦</li>
<li>é€šè¿‡ç”Ÿæˆæ­£ç¡®çš„ä»£ç å»è‡ªåŠ¨é‡Šæ”¾æˆ–è€…ä¿æŒå¯¹è±¡ï¼Œæˆ‘ä»¬å®Œå…¨ä¸ç”¨æ‹…å¿ƒç¼–è¯‘å™¨ä¼šå‡ºé”™</li>
</ol>
<h4 id="ARC_åˆ¤æ–­æ˜¯å¦éœ€è¦é‡Šæ”¾">ARC åˆ¤æ–­æ˜¯å¦éœ€è¦é‡Šæ”¾</h4><p>åªè¦è¿˜æœ‰ä¸€ä¸ªå¼ºæŒ‡é’ˆæŒ‡å‘å¯¹è±¡ï¼Œå¯¹è±¡å°±ä¼šä¿å­˜åœ¨å†…å­˜ä¸­</p>
<ol>
<li>å¼ºæŒ‡é’ˆ  è¢«__strongä¿®é¥°</li>
<li>å¼±æŒ‡é’ˆ  è¢«__weakä¿®é¥°</li>
</ol>
<h4 id="ARC_æ³¨æ„">ARC æ³¨æ„</h4><ol>
<li>ä¸èƒ½è°ƒç”¨release</li>
<li>ä¸èƒ½è°ƒç”¨autorelease</li>
<li>ä¸èƒ½è°ƒç”¨[super dealloc]</li>
</ol>
<h4 id="ARC_å•ä¸ªå¯¹è±¡ç®¡ç†">ARC å•ä¸ªå¯¹è±¡ç®¡ç†</h4><ul>
<li>å±€éƒ¨å˜é‡é‡Šæ”¾ï¼Œå¯¹è±¡éšä¹‹é‡Šæ”¾</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int main(int argc, const char * argv[]) &#123;&#10;   @autoreleasepool &#123;&#10;        Person *p = [[Person alloc] init];&#10;    &#125; // &#25191;&#34892;&#21040;&#36825;&#19968;&#34892;&#23616;&#37096;&#21464;&#37327;p&#37322;&#25918;&#10;    // &#30001;&#20110;&#27809;&#26377;&#24378;&#25351;&#38024;&#25351;&#21521;&#23545;&#35937;, &#25152;&#20197;&#23545;&#35937;&#20063;&#37322;&#25918;&#10;    return 0;&#10;&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>æ¸…ç©ºæŒ‡é’ˆï¼Œå¯¹è±¡éšä¹‹é‡Šæ”¾</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int main(int argc, const char * argv[]) &#123;&#10;   @autoreleasepool &#123;&#10;        Person *p = [[Person alloc] init];&#10;        p = nil; // &#25191;&#34892;&#21040;&#36825;&#19968;&#34892;, &#30001;&#20110;&#27809;&#26377;&#24378;&#25351;&#38024;&#25351;&#21521;&#23545;&#35937;, &#25152;&#20197;&#23545;&#35937;&#34987;&#37322;&#25918;&#10;    &#125;&#10;    return 0;&#10;&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>é»˜è®¤æ¸…ç©ºæ‰€æœ‰æŒ‡é’ˆéƒ½æ˜¯å¼ºæŒ‡é’ˆ</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int main(int argc, const char * argv[]) &#123;&#10;   @autoreleasepool &#123;&#10;        // p1&#21644;p2&#37117;&#26159;&#24378;&#25351;&#38024;&#10;        Person *p1 = [[Person alloc] init];&#10;        __strong Person *p2 = [[Person alloc] init];&#10;    &#125;&#10;    return 0;&#10;&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>å¼±æŒ‡é’ˆéœ€è¦æ˜ç¡®è¯´æ˜ï¼ˆ<strong>åƒä¸‡ä¸è¦ä½¿ç”¨å¼±æŒ‡é’ˆä¿å­˜æ–°åˆ›å»ºçš„å¯¹è±¡</strong>ï¼‰</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int main(int argc, const char * argv[]) &#123;&#10;   @autoreleasepool &#123;&#10;        // p&#26159;&#24369;&#25351;&#38024;, &#23545;&#35937;&#20250;&#34987;&#31435;&#21363;&#37322;&#25918;&#10;        __weak Person *p1 = [[Person alloc] init];&#10;    &#125;&#10;    return 0;&#10;&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ARC_å¤šä¸ªå¯¹è±¡ç®¡ç†">ARC å¤šä¸ªå¯¹è±¡ç®¡ç†</h4><ul>
<li>ARCå’ŒMRCä¸€æ ·ï¼Œæƒ³æ‹¥æœ‰æŸä¸ªå¯¹è±¡éœ€è¦ç”¨å¼ºæŒ‡é’ˆæŒ‡å‘ï¼Œä½†æ˜¯ä¸éœ€è¦è°ƒç”¨deallocä¸­release</li>
</ul>
<h4 id="ARC_@property">ARC @property</h4><ul>
<li>strong : ç”¨äºOCå¯¹è±¡ï¼Œç›¸å½“äºMRCä¸­çš„retain</li>
<li>weak : ç”¨äºOCå¯¹è±¡ï¼Œç›¸å½“äºMRCä¸­çš„assign</li>
<li>assign : ç”¨äºåŸºæœ¬æ•°æ®ç±»å‹ï¼Œè·ŸMRCä¸­çš„assignä¸€æ ·</li>
</ul>
<h4 id="ARC_å¾ªç¯å¼•ç”¨">ARC å¾ªç¯å¼•ç”¨</h4><ul>
<li>Aæ‹¥æœ‰Bï¼ŒBä¹Ÿæ‹¥æœ‰Aï¼Œé‚£ä¹ˆå¿…é¡»ä¸€æ–¹ä½¿ç”¨å¼±æŒ‡é’ˆ</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@interface Person : NSObject&#10;@property (nonatomic, strong) Dog *dog;&#10;@end&#10;&#10;@interface Dog : NSObject&#10;// &#38169;&#35823;&#20889;&#27861;, &#24490;&#29615;&#24341;&#29992;&#20250;&#23548;&#33268;&#20869;&#23384;&#27844;&#38706;&#10;//@property (nonatomic, strong) Person *owner;&#10;&#10;// &#27491;&#30830;&#20889;&#27861;, &#24403;&#22914;&#26524;&#20445;&#23384;&#23545;&#35937;&#24314;&#35758;&#20351;&#29992;weak&#10;@property (nonatomic, weak) Person *owner;&#10;@end</span><br></pre></td></tr></table></figure>
<h2 id="ä¸ºä»€ä¹ˆç”¨å†…å­˜ç®¡ç†?">ä¸ºä»€ä¹ˆç”¨å†…å­˜ç®¡ç†?</h2><h4 id="NSThread_&amp;_NSRunLoop_&amp;_NSAutoreleasePool">NSThread &amp; NSRunLoop &amp; NSAutoreleasePool</h4><ol>
<li>æ¯ä¸ªçº¿ç¨‹ï¼ˆåŒ…æ‹¬ä¸»çº¿ç¨‹ï¼‰éƒ½æ‹¥æœ‰ä¸€ä¸ªä¸“å±çš„NSRunLoopï¼Œå¹¶åœ¨éœ€è¦æ—¶è‡ªåŠ¨åˆ›å»º</li>
<li>ä¸»çº¿ç¨‹çš„NSRunLoopå¯¹è±¡ï¼ˆåŒ…æ‹¬ç³»ç»Ÿçº§åˆ«çš„å…¶å®ƒçº¿ç¨‹ï¼‰çš„æ¯ä¸ªevent loopå¼€å§‹å‰ï¼Œè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªautoreleasepoolï¼Œå¹¶åœ¨event loopç»“æŸæ—¶drain</li>
<li>æ¯ä¸ªautoreleasepoolå¯¹åº”ä¸”åªå¯¹åº”ä¸€ä¸ªçº¿ç¨‹</li>
</ol>
<h2 id="å†…å­˜ç®¡ç†æ€ä¹ˆç”¨ï¼Ÿ">å†…å­˜ç®¡ç†æ€ä¹ˆç”¨ï¼Ÿ</h2><p>è¿™äº›æƒ…å†µéœ€è¦æ‰‹åŠ¨æ·»åŠ autoreleasepoolï¼š</p>
<ol>
<li>ç¼–å†™çš„ç¨‹åºä¸æ˜¯åŸºäºUIæ¡†æ¶çš„ï¼Œæ¯”å¦‚å‘½ä»¤è¡Œå·¥å…·</li>
<li>ç¼–å†™çš„å¾ªç¯ä¸­åˆ›å»ºäº†å¤§é‡çš„ä¸´æ—¶å¯¹è±¡  </li>
<li>åˆ›å»ºäº†ä¸€ä¸ªè¾…åŠ©çº¿ç¨‹</li>
</ol>
<h2 id="å†…å­˜ç®¡ç†å®é™…åº”ç”¨">å†…å­˜ç®¡ç†å®é™…åº”ç”¨</h2><h4 id="é¡¹ç›®">é¡¹ç›®</h4><ol>
<li>YYKit ï¼šè§£å†³å¾ªç¯ä¸­åˆ›å»ºçš„å¤§é‡ä¸´æ—¶å¯¹è±¡</li>
<li>AFNetworkingï¼š åˆ›å»ºäº†è¾…åŠ©çº¿ç¨‹</li>
<li>XXä¼š æ··ç¼–æ—¶ï¼Œ æ ‡æ³¨MRCæ–‡ä»¶ï¼š-fno-objc-arc</li>
</ol>
<h4 id="ARC_å®ä¾‹">ARC å®ä¾‹</h4><ol>
<li>ARCæƒ³è¦ä¸»åŠ¨é‡Šæ”¾ï¼Œæœ€å¥½æ˜¯æå‰ç½®ä¸ºnil</li>
<li>ARCä¸‹è·å–å¼•ç”¨è®¡æ•°<ul>
<li>KVC  [obj valueForKey:@â€retainCountâ€] </li>
<li>ç§æœ‰API _objc_rootRetainCount(obj)</li>
<li>CFGetRetainCount((__bridge CFTypeRef)(obj))</li>
</ul>
</li>
</ol>
<h4 id="MRC_å®ä¾‹">MRC å®ä¾‹</h4><ol>
<li>ä¸‹é¢è¿™ç§æƒ…å†µä¼šæŠ¥é”™å—ï¼Ÿï¼ˆæ³¨æ„è®¡ç®—retainCountï¼‰</li>
</ol>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">	YLAutorelease *obj = [[YLAutorelease alloc] init];      <span class="comment">//1</span></span><br><span class="line">    _tableView = [[<span class="built_in">UITableView</span> alloc] init];                <span class="comment">//1</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"obj retainCount:%ld"</span>, [obj retainCount]);</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"tableView retainCount:%ld"</span>, [_tableView retainCount]);</span><br><span class="line">    </span><br><span class="line">    [obj performSelector:<span class="keyword">@selector</span>(test) withObject:_tableView afterDelay:<span class="number">1</span>];   <span class="comment">//obj 2 , tableView 2</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"obj retainCount:%ld"</span>, [obj retainCount]);</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"tableView retainCount:%ld"</span>, [_tableView retainCount]);</span><br><span class="line">    </span><br><span class="line"><span class="comment">//    [obj release];</span></span><br><span class="line"><span class="comment">//    [_tableView release];</span></span><br><span class="line">    </span><br><span class="line">    [<span class="built_in">NSObject</span> cancelPreviousPerformRequestsWithTarget:obj selector:<span class="keyword">@selector</span>(test) object:_tableView];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"obj retainCount:%ld"</span>, [obj retainCount]);       <span class="comment">//1</span></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"tableView retainCount:%ld"</span>, [_tableView retainCount]);  <span class="comment">//1</span></span><br></pre></td></tr></table></figure>
<ol>
<li><p>NSStringçš„å¼•ç”¨è®¡æ•°æ˜¯éšæœºå€¼ï¼ŒNSMutableStringçš„å¼•ç”¨è®¡æ•°æ˜¯æ­£å¸¸å€¼</p>
<ul>
<li>NSStringçš„classæ˜¯__NSCFConstantStringï¼Œå­—ç¬¦ä¸²å¸¸é‡</li>
<li>NSMutableStringçš„classæ˜¯__NSCFStringï¼Œæœ‰å¼•ç”¨è®¡æ•°</li>
</ul>
</li>
<li><p>å¯¹äºå­—ç¬¦ä¸²å¸¸é‡ã€NSNumberåšå¸¸é‡æ—¶ï¼Ÿ</p>
<ul>
<li>retain å’Œ releaseéƒ½ä¸ä¼šæœ‰å½±å“ï¼Œå› ä¸ºç³»ç»Ÿä¸ä¼šå›æ”¶ï¼Œä¹Ÿä¸ä¼šå¯¹å…¶åšå¼•ç”¨è®¡æ•°</li>
</ul>
</li>
<li><p>stringWithFormatåˆ›å»ºçš„stringï¼Ÿ</p>
<ul>
<li>ä¸ºå˜é‡ï¼Œæ‰€ä»¥ä¼šæœ‰å¼•ç”¨è®¡æ•°</li>
<li>ç°åœ¨è¿”å›çš„å·²ç»æ˜¯å¸¸é‡ï¼Œè§åé¢çš„ä¾‹å­</li>
</ul>
</li>
<li><p>stringWithStringåˆ›å»ºçš„string?</p>
<ul>
<li>å–å†³äºå®ƒåé¢çš„stringå¯¹è±¡ï¼Œå¦‚æœæ˜¯å¸¸é‡åˆ™ä¸åšè®¡æ•°ï¼Œå¦‚æœæ˜¯å˜é‡åˆ™åšè®¡æ•°</li>
</ul>
</li>
<li><p>é™¤äº†alloc new copy mutableCopy retainæ˜¾ç¤ºå¢åŠ retainCountä»¥å¤–è¿˜æœ‰å“ªäº›çœ‹ä¸åˆ°çš„èƒ½å¤Ÿå¢åŠ å¼•ç”¨è®¡æ•°çš„æ“ä½œï¼Ÿ</p>
<ul>
<li>å®¹å™¨ç±»arrayã€dic addObjectï¼›releaseæ—¶ï¼Œé‡Œé¢çš„æˆå‘˜éƒ½ä¼šreleaseä¸€æ¬¡ï¼Œå’Œautorelease poolä¸€è‡´</li>
<li>addsubview, å› ä¸ºviewæœ‰æ ˆ(subviews)ï¼ŒåŠ å…¥æ ˆä¸­retainCount+1</li>
<li>navcontrollerçš„push, å› ä¸ºnavæœ‰æ ˆ(viewcontrollers)ï¼ŒåŠ å…¥æ ˆä¸­retainCount+1</li>
<li>performSelector è°ƒç”¨æ—¶targetå’Œinfoéƒ½ä¼šåŠ 1ï¼Œç»“æŸæ—¶å‡1</li>
</ul>
</li>
<li><p>è‹¹æœä¸æ¨èä½¿ç”¨retainCountæ–¹æ³•ï¼Œå› ä¸ºä»–å¯¹ç¨‹åºæœ¬èº«æ²¡æœ‰ä½œç”¨ï¼ŒretainCountå¯èƒ½æ°¸è¿œä¸ä¼šåå›0ï¼Œæœ‰æ—¶å€™ç³»ç»Ÿä¼šä¼˜åŒ–å¯¹è±¡çš„é‡Šæ”¾è¡Œä¸ºï¼Œåœ¨ä¿ç•™è®¡æ•°è¿˜æ˜¯1çš„æ—¶å€™å°±é‡Šæ”¾äº†ã€‚</p>
</li>
<li><p>å‡ ä¸ªcopy, mutableCopyçš„ä¾‹å­</p>
</li>
</ol>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1</span></span><br><span class="line">   <span class="built_in">NSMutableString</span> *str = [[<span class="built_in">NSMutableString</span> alloc] init];</span><br><span class="line">   <span class="built_in">NSMutableString</span> *str2 = [[<span class="built_in">NSMutableString</span> alloc] init];</span><br><span class="line">   <span class="built_in">NSLog</span>(<span class="string">@"%ld, %ld"</span>, [str retainCount], [str2 retainCount]);<span class="comment">//1,1</span></span><br><span class="line">   </span><br><span class="line">   str2 = [str <span class="keyword">copy</span>];         <span class="comment">//copyè¿”å›ä¸€ä¸ªä¸å¯å˜å¯¹è±¡å±äºå¸¸é‡</span></span><br><span class="line">   <span class="built_in">NSLog</span>(<span class="string">@"%ld, %ld"</span>, [str retainCount], [str2 retainCount]);<span class="comment">//1,-1</span></span><br></pre></td></tr></table></figure>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="built_in">NSString</span> *str = [[<span class="built_in">NSString</span> alloc] init];</span><br><span class="line"><span class="built_in">NSString</span> *str2 = [[<span class="built_in">NSString</span> alloc] init];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%ld, %ld"</span>, [str retainCount], [str2 retainCount]); <span class="comment">//-1,-1</span></span><br><span class="line"></span><br><span class="line">str2 = [str <span class="keyword">copy</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%ld, %ld"</span>, [str retainCount], [str2 retainCount]);<span class="comment">//-1,-1</span></span><br></pre></td></tr></table></figure>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 3</span></span><br><span class="line"><span class="built_in">NSString</span> *str = [[<span class="built_in">NSString</span> alloc] initWithFormat:<span class="string">@"abc%@"</span>, <span class="string">@"hehe"</span>];</span><br><span class="line"><span class="built_in">NSString</span> *str2 = [[<span class="built_in">NSString</span> alloc] initWithFormat:<span class="string">@"bbc%@"</span>, <span class="string">@"hehe"</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%ld, %ld"</span>, [str retainCount], [str2 retainCount]); <span class="comment">//-1,-1</span></span><br><span class="line"></span><br><span class="line">str2 = [str mutableCopy];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%ld, %ld"</span>, [str retainCount], [str2 retainCount]);<span class="comment">//-1,1</span></span><br></pre></td></tr></table></figure>
<ol>
<li>blockå†…å­˜ç®¡ç†ï¼Œè¯¦è§åç»­æ–‡ç« </li>
</ol>

                    
                        
                    
                    
                        <p>
                            <a href="/2015/07/20/ios_arc_mrc/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="/2015/06/20/c_pointer/">
                            æŒ‡é’ˆåŸºç¡€åˆ°è¿›é˜¶
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2015-06-20T18:15:02+08:00">
	
		    Jun 20, 2015
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <h2 id="å­¦ä¹ æŒ‡é’ˆéœ€è¦ä¼šä»€ä¹ˆï¼Ÿ">å­¦ä¹ æŒ‡é’ˆéœ€è¦ä¼šä»€ä¹ˆï¼Ÿ</h2><p>å¦‚ä½•å®Œå…¨ç†è§£ä¸€ä¸ªå¤æ‚ç±»å‹ï¼Œè®°ä½ä¸€æ¡åŸåˆ™ï¼š</p>
<ul>
<li>ä»<strong>å˜é‡å</strong>å¤„èµ·ï¼Œæ ¹æ®<strong>è¿ç®—ç¬¦ä¼˜å…ˆçº§</strong>ç»“åˆï¼Œä¸€æ­¥ä¸€æ­¥åˆ†æ</li>
</ul>
<p>ä¸¾å‡ ä¸ªğŸŒ°ï¼š</p>
<ol>
<li>int p;    <ul>
<li>ä»på¼€å§‹ï¼Œå…ˆä¸intç»“åˆï¼Œè¯´æ˜pæ˜¯<strong>æ•´å‹å˜é‡</strong></li>
</ul>
</li>
<li>int *p;    <ul>
<li>ä»på¼€å§‹ï¼Œå…ˆä¸*ç»“åˆï¼Œè¯´æ˜pæ˜¯<strong>æŒ‡é’ˆ</strong>ï¼Œ</li>
<li>å†ä¸intç»“åˆï¼Œè¯´æ˜<strong>æŒ‡é’ˆæŒ‡å‘intå‹</strong>ï¼Œ</li>
<li>æ‰€ä»¥pæ˜¯è¿”å›intå‹æ•°æ®çš„æŒ‡é’ˆ</li>
</ul>
</li>
<li>int p[3];<ul>
<li>ä»på¼€å§‹ï¼Œå…ˆä¸[]ç»“åˆï¼Œè¯´æ˜pæ˜¯<strong>æ•°ç»„</strong>ï¼Œ</li>
<li>å†ä¸intç»“åˆï¼Œè¯´æ˜<strong>[]é‡Œé¢æ˜¯intå‹</strong>,</li>
<li>æ‰€ä»¥pæ˜¯è¿”å›intå‹æ•°æ®çš„æ•°ç»„</li>
</ul>
</li>
<li>int *p[3];<ul>
<li>ä»på¼€å§‹ï¼Œå…ˆä¸[]ç»“åˆï¼Œè¯´æ˜pæ˜¯<strong>æ•°ç»„</strong>ï¼Œ</li>
<li>å†ä¸*ç»“åˆï¼Œè¯´æ˜<strong>[]é‡Œé¢æ˜¯æŒ‡é’ˆå‹</strong>ï¼Œ</li>
<li>å†ä¸intç»“åˆï¼Œè¯´æ˜<strong>æŒ‡é’ˆæŒ‡å‘å†…å®¹æ˜¯intå‹</strong>ï¼Œ</li>
<li>æ‰€ä»¥pæ˜¯ç”±è¿”å›intå‹æ•°æ®çš„æŒ‡é’ˆç»„æˆçš„æ•°ç»„</li>
</ul>
</li>
<li>int (*p)[3];<ul>
<li>ä»på¼€å§‹ï¼Œå…ˆä¸*ç»“åˆï¼Œè¯´æ˜pæ˜¯<strong>æŒ‡é’ˆ</strong>ï¼Œ</li>
<li>å†ä¸[]ç»“åˆï¼Œè¯´æ˜<strong>æŒ‡é’ˆæŒ‡å‘[]å‹</strong>ï¼Œ</li>
<li>å†ä¸intç»“åˆï¼Œè¯´æ˜<strong>[]é‡Œæ˜¯intå‹</strong>ï¼Œ</li>
<li>æ‰€ä»¥pæ˜¯æŒ‡å‘ç”±intå‹æ•°æ®ç»„æˆçš„æ•°ç»„çš„æŒ‡é’ˆ</li>
</ul>
</li>
<li>int **p;<ul>
<li>ä»på¼€å§‹ï¼Œå…ˆä¸*ç»“åˆï¼Œè¯´æ˜pæ˜¯<strong>æŒ‡é’ˆ</strong>ï¼Œ</li>
<li>å†ä¸*ç»“åˆï¼Œè¯´æ˜<strong>æŒ‡é’ˆæŒ‡å‘æŒ‡é’ˆå‹</strong>ï¼Œ</li>
<li>å†ä¸intç»“åˆï¼Œè¯´æ˜<strong>äºŒçº§æŒ‡é’ˆæŒ‡å‘intå‹</strong>,</li>
<li>æ‰€ä»¥pæ˜¯äºŒçº§æŒ‡é’ˆ</li>
</ul>
</li>
<li>int p(int);<ul>
<li>ä»på¼€å§‹ï¼Œå…ˆä¸()ç»“åˆï¼Œè¯´æ˜pæ˜¯<strong>å‡½æ•°</strong>ï¼Œ</li>
<li>åˆ†æ()é‡Œé¢ï¼Œå‡½æ•°æœ‰ä¸€ä¸ª<strong>intå‹å‚æ•°</strong>,</li>
<li>å†ä¸intç»“åˆï¼Œå‡½æ•°<strong>è¿”å›ç±»å‹æ˜¯int</strong></li>
</ul>
</li>
<li>int (*p)(int);<ul>
<li>ä»på¼€å§‹ï¼Œå…ˆä¸*ç»“åˆï¼Œè¯´æ˜pæ˜¯<strong>æŒ‡é’ˆ</strong>,</li>
<li>å†ä¸()ç»“åˆï¼Œè¯´æ˜<strong>æŒ‡é’ˆæŒ‡å‘å‡½æ•°</strong>ï¼Œ</li>
<li>åˆ†æ()é‡Œé¢ï¼Œå‡½æ•°æœ‰ä¸€ä¸ª<strong>intå‹å‚æ•°</strong>,</li>
<li>å†ä¸intç»“åˆï¼Œå‡½æ•°<strong>è¿”å›ç±»å‹æ˜¯int</strong>,</li>
<li>æ‰€ä»¥pæ˜¯æŒ‡å‘æœ‰ä¸€ä¸ªæ•´å‹å‚æ•°ä¸”è¿”å›ç±»å‹ä¸ºæ•´æ•°çš„å‡½æ•°çš„æŒ‡é’ˆ</li>
</ul>
</li>
<li>int *(*p(int))[3];<ul>
<li>ä»på¼€å§‹ï¼Œå…ˆä¸()ç»“åˆï¼Œè¯´æ˜pæ˜¯ä¸€ä¸ª<strong>å‡½æ•°</strong>,</li>
<li>åˆ†æ()é‡Œé¢ï¼Œå‡½æ•°æœ‰ä¸€ä¸ª<strong>intå‹å‚æ•°</strong>ï¼Œ</li>
<li>å†ä¸*ç»“åˆï¼Œå‡½æ•°<strong>è¿”å›ç±»å‹æ˜¯æŒ‡é’ˆ</strong>ï¼Œ</li>
<li>å†ä¸[]ç»“åˆï¼Œè¯´æ˜è¿”å›çš„<strong>æŒ‡é’ˆæŒ‡å‘[]</strong>,</li>
<li>å†ä¸*ç»“åˆï¼Œè¯´æ˜<strong>[]é‡Œæ˜¯æŒ‡é’ˆ</strong>ï¼Œ</li>
<li>å†ä¸intç»“åˆï¼Œè¯´æ˜æŒ‡é’ˆ<strong>æŒ‡å‘çš„æ˜¯intå‹</strong>ï¼Œ</li>
<li>æ‰€ä»¥pæ˜¯ä¸€ä¸ªå‚æ•°ä¸ºä¸€ä¸ªintå‹ä¸”è¿”å›ä¸€ä¸ªæŒ‡å‘æ•´å‹æŒ‡é’ˆå˜é‡ç»„æˆçš„æ•°ç»„çš„æŒ‡é’ˆå˜é‡çš„å‡½æ•°</li>
</ul>
</li>
</ol>
<h2 id="æŒ‡é’ˆæ˜¯ä»€ä¹ˆï¼Ÿ">æŒ‡é’ˆæ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>æŒ‡é’ˆæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å˜é‡ï¼Œå®ƒå­˜å‚¨çš„æ•°å€¼è¢«è§£é‡Šæˆå†…å­˜é‡Œçš„ä¸€ä¸ªåœ°å€</p>
<p>å…ˆå£°æ˜å‡ ä¸ªæŒ‡é’ˆğŸŒ°ï¼š</p>
<ol>
<li>int *ptr;</li>
<li>char *ptr;</li>
<li>int **ptr;</li>
<li>int (*ptr)[3];</li>
<li>int *(*ptr)[4] </li>
</ol>
<h4 id="æŒ‡é’ˆçš„ç±»å‹">æŒ‡é’ˆçš„ç±»å‹</h4><p>æŠŠæŒ‡é’ˆåå­—å»æ‰ï¼Œå‰©ä¸‹éƒ¨åˆ†å°±æ˜¯æŒ‡é’ˆç±»å‹</p>
<h4 id="æŒ‡å‘çš„ç±»å‹">æŒ‡å‘çš„ç±»å‹</h4><p>æŠŠæŒ‡é’ˆåå’Œåå­—å·¦è¾¹çš„*å»æ‰ï¼Œå‰©ä¸‹éƒ¨åˆ†å°±æ˜¯æŒ‡é’ˆæŒ‡å‘çš„ç±»å‹</p>
<ul>
<li>æŒ‡é’ˆçš„ç±»å‹ï¼ˆæŒ‡é’ˆæœ¬èº«çš„ç±»å‹ï¼‰å’ŒæŒ‡é’ˆæŒ‡å‘çš„ç±»å‹æ˜¯<strong>ä¸¤ä¸ªæ¦‚å¿µ</strong></li>
</ul>
<h4 id="æŒ‡é’ˆçš„å€¼_â€”_æˆ–å«æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜åŒº">æŒ‡é’ˆçš„å€¼ â€” æˆ–å«æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜åŒº</h4><p>åœ¨32ä½æ“ä½œç³»ç»Ÿé‡Œï¼ŒæŒ‡é’ˆéƒ½æ˜¯ä¸€ä¸ª32ä½æ•´æ•°ï¼ŒæŒ‡é’ˆæŒ‡å‘çš„å†…å­˜åŒºå°±æ˜¯ä»æŒ‡é’ˆçš„å€¼ä»£è¡¨çš„é‚£ä¸ª<strong>å†…å­˜åœ°å€å¼€å§‹</strong>ï¼Œé•¿åº¦ä¸º<strong>sizeof(æŒ‡é’ˆæŒ‡å‘çš„ç±»å‹)</strong>çš„ä¸€ç‰‡å†…å­˜åŒº</p>
<ul>
<li>æˆ‘ä»¬è¯´ä¸€ä¸ªæŒ‡é’ˆçš„å€¼æ˜¯XXï¼Œç›¸å½“äºè¯´æŒ‡é’ˆæŒ‡å‘äº†ä»¥XXä¸ºé¦–åœ°å€çš„ä¸€ç‰‡å†…å­˜åŒºåŸŸ</li>
<li>æˆ‘ä»¬è¯´ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘äº†æŸå—å†…å­˜åŒºåŸŸï¼Œç›¸å½“äºè¯´æŒ‡é’ˆçš„å€¼æ˜¯è¿™å—å†…å­˜åŒºåŸŸçš„é¦–åœ°å€</li>
</ul>
<h4 id="æŒ‡é’ˆæœ¬èº«å æ®çš„å†…å­˜åŒºåŸŸ">æŒ‡é’ˆæœ¬èº«å æ®çš„å†…å­˜åŒºåŸŸ</h4><p><strong>sizeof(æŒ‡é’ˆçš„ç±»å‹)</strong>ï¼Œ32ä½ç³»ç»Ÿé‡Œï¼ŒæŒ‡é’ˆå æ®4ä¸ªå­—èŠ‚</p>
<h2 id="ä¸ºä»€ä¹ˆç”¨æŒ‡é’ˆï¼Ÿ">ä¸ºä»€ä¹ˆç”¨æŒ‡é’ˆï¼Ÿ</h2><p>Cè¯­è¨€çš„ç²¾åå’Œå”¯ä¸€çš„éš¾ç‚¹å°±æ˜¯æŒ‡é’ˆï¼Œæå®šæŒ‡é’ˆç­‰äºæå®šäº†Cè¯­è¨€</p>
<p>æŒ‡é’ˆ -&gt; Cè¯­è¨€ -&gt; C++ -&gt; æ•°æ®ç»“æ„ -&gt; ç®—æ³• -&gt; èŒƒå‹ç¼–ç¨‹ä¸STLå’ŒSTLæºç å‰–æ</p>
<h2 id="æŒ‡é’ˆæ€ä¹ˆç”¨ï¼Ÿ">æŒ‡é’ˆæ€ä¹ˆç”¨ï¼Ÿ</h2><h4 id="æŒ‡é’ˆçš„ç®—æœ¯è¿ç®—">æŒ‡é’ˆçš„ç®—æœ¯è¿ç®—</h4><p>æŒ‡é’ˆå¯ä»¥åŠ ä¸Šæˆ–å‡å»ä¸€ä¸ªæ•´æ•°</p>
<ul>
<li>å’Œæ•°å€¼çš„åŠ å‡è¿ç®—ä¸ä¸€æ ·ï¼Œä»¥å•å…ƒä¸ºå•ä½</li>
<li>ä¸¤ä¸ªæŒ‡é’ˆä¸èƒ½è¿›è¡ŒåŠ æ³•è¿ç®—ï¼Œå¾—åˆ°çš„ç»“æœä¸çŸ¥é“æŒ‡å‘ä½•å¤„</li>
<li>ä¸¤ä¸ªæŒ‡é’ˆå¯ä»¥è¿›è¡Œå‡æ³•è¿ç®—ï¼Œä½†æ˜¯ç±»å‹å¿…é¡»ç›¸åŒï¼Œä¸€èˆ¬ç”¨äºæ•°ç»„</li>
</ul>
<p>ğŸŒ°1ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> a[<span class="number">20</span>];</span><br><span class="line"><span class="keyword">int</span> *ptr = (<span class="keyword">int</span> *)a;  <span class="comment">//å¼ºåˆ¶ç±»å‹è½¬æ¢ä¸ä¼šæ”¹å˜açš„ç±»å‹</span></span><br><span class="line">ptr++;</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">æŒ‡é’ˆptråŠ äº†<span class="number">1</span>ï¼Œç¼–è¯‘å™¨å¤„ç†ï¼šptrçš„å€¼åŠ ä¸Šäº†<span class="keyword">sizeof</span>(<span class="keyword">int</span>)ï¼Œåœ¨<span class="number">32</span>ä½ç¨‹åºé‡Œï¼Œæ˜¯åŠ äº†<span class="number">4</span>ï¼Œå› ä¸º<span class="keyword">int</span>å æ®<span class="number">4</span>ä¸ªå­—èŠ‚ã€‚</span><br><span class="line"></span><br><span class="line">ğŸŒ°<span class="number">2</span>ï¼š</span><br><span class="line"></span><br><span class="line">```c</span><br><span class="line"><span class="keyword">int</span> <span class="built_in">array</span>[<span class="number">20</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> *ptr = <span class="built_in">array</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">20</span>; i++) &#123;</span><br><span class="line">	(*ptr)++;</span><br><span class="line">	ptr++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å„ä¸ªå•å…ƒçš„å€¼åŠ 1ï¼Œæ¯æ¬¡å¾ªç¯éƒ½å°†æŒ‡é’ˆptråŠ 1ä¸ªå•å…ƒï¼Œæ‰€ä»¥æ¯æ¬¡å¾ªç¯éƒ½èƒ½è®¿é—®åˆ°ä¸‹ä¸€ä¸ªå•å…ƒã€‚</p>
<h4 id="è¿ç®—ç¬¦_&amp;_å’Œ_*">è¿ç®—ç¬¦ &amp; å’Œ *</h4><p>&amp;æ˜¯å–åœ°å€è¿ç®—ç¬¦ï¼Œ*æ˜¯é—´æ¥è¿ç®—ç¬¦</p>
<ul>
<li>&amp;açš„è¿ç®—ç»“æœæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡é’ˆçš„ç±»å‹æ˜¯açš„ç±»å‹åŠ ä¸ª*ï¼ŒæŒ‡é’ˆæŒ‡å‘çš„ç±»å‹æ˜¯açš„ç±»å‹ï¼ŒæŒ‡é’ˆæŒ‡å‘çš„åœ°å€æ˜¯açš„åœ°å€</li>
<li><em>pçš„ç»“æœäº”èŠ±å…«é—¨ï¼Œ\</em>pçš„ç»“æœæ˜¯pæ‰€æŒ‡å‘çš„ä¸œè¥¿ï¼Œè¿™ä¸ªä¸œè¥¿çš„ç‰¹ç‚¹ï¼šå®ƒçš„ç±»å‹æ˜¯pæŒ‡å‘çš„ç±»å‹ï¼Œå®ƒå ç”¨çš„åœ°å€æ˜¯pæŒ‡å‘çš„åœ°å€</li>
</ul>
<p>ğŸŒ°1ï¼š </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a=<span class="number">12</span>; <span class="keyword">int</span> b; <span class="keyword">int</span> *p; <span class="keyword">int</span> **ptr;</span><br><span class="line"></span><br><span class="line">p = &amp;a; <span class="comment">//&amp;açš„ç»“æœæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œç±»å‹æ˜¯int *, æŒ‡å‘çš„ç±»å‹æ˜¯int, æŒ‡å‘çš„åœ°å€æ˜¯açš„åœ°å€</span></span><br><span class="line"></span><br><span class="line">*p = <span class="number">24</span>; <span class="comment">//*pçš„ç»“æœï¼Œå®ƒçš„ç±»å‹æ˜¯intï¼Œå®ƒå ç”¨çš„åœ°å€æ˜¯pæŒ‡å‘çš„åœ°å€ï¼Œ*på°±æ˜¯å˜é‡a</span></span><br><span class="line"></span><br><span class="line">ptr = &amp;p; <span class="comment">//&amp;pçš„ç»“æœæ˜¯æŒ‡é’ˆï¼Œç±»å‹æ˜¯pçš„ç±»å‹åŠ ä¸ª*ï¼Œè¿™é‡Œæ˜¯int **ï¼Œè¯¥æŒ‡é’ˆæŒ‡å‘çš„ç±»å‹æ˜¯pçš„ç±»å‹ï¼Œè¿™é‡Œæ˜¯int *ï¼Œè¯¥æŒ‡é’ˆæ‰€æŒ‡å‘çš„åœ°å€å°±æ˜¯æŒ‡é’ˆ p è‡ªå·±çš„åœ°å€</span></span><br><span class="line"></span><br><span class="line">*ptr = &amp;b; <span class="comment">//*ptr æ˜¯ä¸ªæŒ‡é’ˆ,&amp;b çš„ç»“æœä¹Ÿæ˜¯ä¸ªæŒ‡é’ˆ,ä¸”è¿™ä¸¤ä¸ªæŒ‡é’ˆçš„ç±»å‹å’Œæ‰€æŒ‡å‘çš„ç±»å‹æ˜¯ä¸€æ ·çš„,æ‰€ä»¥ç”¨&amp;b æ¥ç»™*ptr èµ‹å€¼å°±æ˜¯æ¯«æ— é—®é¢˜çš„äº†</span></span><br><span class="line"></span><br><span class="line">**ptr = <span class="number">34</span>; <span class="comment">//*ptr çš„ç»“æœæ˜¯ ptr æ‰€æŒ‡å‘çš„ä¸œè¥¿,åœ¨è¿™é‡Œæ˜¯ä¸€ä¸ªæŒ‡é’ˆ, å¯¹è¿™ä¸ªæŒ‡é’ˆå†åšä¸€æ¬¡*è¿ç®—,ç»“æœæ˜¯ä¸€ä¸ª int ç±»å‹çš„å˜é‡ã€‚</span></span><br></pre></td></tr></table></figure>
<h4 id="æŒ‡é’ˆè¡¨è¾¾å¼">æŒ‡é’ˆè¡¨è¾¾å¼</h4><p>ä¸€ä¸ªè¡¨è¾¾å¼çš„ç»“æœæ˜¯æŒ‡é’ˆï¼Œå³æŒ‡é’ˆè¡¨è¾¾å¼</p>
<p>ğŸŒ°1ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a,b;</span><br><span class="line"><span class="keyword">int</span> <span class="built_in">array</span>[<span class="number">10</span>];</span><br><span class="line"><span class="keyword">int</span> *pa;</span><br><span class="line">pa = &amp;a;				<span class="comment">//&amp;a</span></span><br><span class="line"><span class="keyword">int</span> **ptr = &amp;pa;    <span class="comment">//&amp;pa</span></span><br><span class="line">*ptr = &amp;b;          <span class="comment">//*ptr å’Œ &amp;b </span></span><br><span class="line">pa = <span class="built_in">array</span>;</span><br><span class="line">pa++;					<span class="comment">//pa</span></span><br></pre></td></tr></table></figure>
<p>å½“ä¸€ä¸ªæŒ‡é’ˆè¡¨è¾¾å¼çš„ç»“æœæŒ‡é’ˆå·²ç»æ˜ç¡®åœ°å…·æœ‰äº†æŒ‡é’ˆè‡ªèº«å  æ®çš„å†…å­˜çš„è¯,è¿™ä¸ªæŒ‡é’ˆè¡¨è¾¾å¼å°±æ˜¯ä¸€ä¸ªå·¦å€¼,å¦åˆ™å°±ä¸æ˜¯ä¸€ä¸ªå·¦å€¼</p>
<h4 id="æŒ‡é’ˆå’Œæ•°ç»„">æŒ‡é’ˆå’Œæ•°ç»„</h4><p>æ•°ç»„åå¯ä»¥çœ‹ä½œä¸€ä¸ªæŒ‡é’ˆ</p>
<p>ğŸŒ°1ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">intarray[<span class="number">10</span>]=&#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>&#125;,value;value=<span class="built_in">array</span>[<span class="number">0</span>];		<span class="comment">//å¯å†™æˆï¼š value = *array;</span>value=<span class="built_in">array</span>[<span class="number">3</span>];		<span class="comment">//å¯å†™æˆï¼š	value = *(array+3);</span>value=<span class="built_in">array</span>[<span class="number">4</span>];		<span class="comment">//å¯å†™æˆï¼š value = *(array+4);</span></span><br></pre></td></tr></table></figure>
<p>æ•°ç»„åarrayä»£è¡¨æ•°ç»„æœ¬èº«ï¼Œç±»å‹æ˜¯int[10]ï¼Œå¦‚æœæŠŠarrayçœ‹ä½œæŒ‡é’ˆï¼Œå®ƒæŒ‡å‘æ•°ç»„çš„ç¬¬0ä¸ªå•å…ƒï¼Œç±»å‹æ˜¯int <em>ï¼Œ æ‰€æŒ‡å‘çš„ç±»å‹æ˜¯æ˜¯æ•°ç»„å•å…ƒçš„ç±»å‹å³intï¼Œå› æ­¤\</em>array ç­‰äº 0 å°±ä¸€ç‚¹ä¹Ÿä¸ å¥‡æ€ªäº†ã€‚åŒç†,array+3 æ˜¯ä¸€ä¸ªæŒ‡å‘æ•°ç»„ç¬¬ 3 ä¸ªå•å…ƒçš„æŒ‡é’ˆ,æ‰€ä»¥ *(array+3)ç­‰äº 3ã€‚å…¶å®ƒä¾æ­¤ç±»æ¨</p>
<h4 id="æŒ‡é’ˆå’Œç»“æ„ç±»å‹">æŒ‡é’ˆå’Œç»“æ„ç±»å‹</h4><p>å¯ä»¥å£°æ˜ä¸€ä¸ªæŒ‡å‘ç»“æ„ç±»å¯¹è±¡çš„æŒ‡é’ˆ</p>
<p>ğŸŒ°1ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> MyStruct &#123;</span><br><span class="line">	<span class="keyword">int</span> a;</span><br><span class="line">	<span class="keyword">int</span> b;</span><br><span class="line">	<span class="keyword">int</span> c;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> MyStruct ss = &#123;<span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> MyStruct *ptr = &amp;ss;  <span class="comment">//å£°æ˜ä¸€ä¸ªæŒ‡å‘ç»“æ„å¯¹è±¡ssçš„æŒ‡é’ˆï¼Œå®ƒçš„ç±»å‹æ˜¯MyStruct *ï¼Œå®ƒæŒ‡å‘çš„ç±»å‹æ˜¯MyStruct</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> *pstr = (<span class="keyword">int</span> *)&amp;ss; <span class="comment">//å£°æ˜ä¸€ä¸ªæŒ‡å‘ç»“æ„å¯¹è±¡ssçš„æŒ‡é’ˆï¼Œä½†æ˜¯pstrå’Œå®ƒè¢«æŒ‡å‘çš„ç±»å‹ptræ˜¯ä¸åŒçš„</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//  ptr æ¥è®¿é—® ss çš„ä¸‰ä¸ªæˆå‘˜å˜é‡</span></span><br><span class="line">ptr-&gt;a;  <span class="comment">//æŒ‡å‘è¿ç®—ç¬¦</span></span><br><span class="line">ptr-&gt;b;</span><br><span class="line">ptr-&gt;c;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  pstr æ¥è®¿é—® ss çš„ä¸‰ä¸ªæˆå‘˜å˜é‡</span></span><br><span class="line">*pstr;</span><br><span class="line">*(pstr + <span class="number">1</span>);</span><br><span class="line">*(pstr + <span class="number">2</span>);</span><br></pre></td></tr></table></figure>
<h4 id="æŒ‡é’ˆå’Œå‡½æ•°">æŒ‡é’ˆå’Œå‡½æ•°</h4><p>å¯ä»¥å£°æ˜ä¸€ä¸ªæŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆ</p>
<p>ğŸŒ°1ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fun1</span><span class="params">(<span class="keyword">char</span> *, <span class="keyword">int</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> (*pfun1)(<span class="keyword">char</span> *, <span class="keyword">int</span>);</span><br><span class="line"></span><br><span class="line">pfun1 = fun1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a = (*pfun1)(<span class="string">"abcdefg"</span>, <span class="number">7</span>);  <span class="comment">//é€šè¿‡å‡½æ•°æŒ‡é’ˆè°ƒç”¨å‡½æ•°</span></span><br></pre></td></tr></table></figure>
<p>æŒ‡é’ˆä½œä¸ºå‡½æ•°çš„å½¢å‚ï¼Œå‡½æ•°è°ƒç”¨ä¸­ï¼Œç”¨æŒ‡é’ˆè¡¨è¾¾å¼æ¥ä½œä¸ºå®å‚</p>
<h4 id="æŒ‡é’ˆç±»å‹è½¬æ¢">æŒ‡é’ˆç±»å‹è½¬æ¢</h4><p>ğŸŒ°1ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">float</span> f = <span class="number">12.3</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">float</span> *fptr = &amp;f;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> *p;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æƒ³è®©æŒ‡é’ˆ p æŒ‡å‘å®æ•° f</span></span><br><span class="line">p=&amp;f; <span class="comment">//ä¸å¯¹ã€‚å› ä¸ºæŒ‡é’ˆ p çš„ç±»å‹æ˜¯ int *,å®ƒæŒ‡å‘çš„ç±»å‹æ˜¯ int</span></span><br><span class="line"></span><br><span class="line">p=(<span class="keyword">int</span>*)&amp;f; <span class="comment">// å¦‚æœæœ‰ä¸€ä¸ªæŒ‡é’ˆ p,æˆ‘ä»¬éœ€è¦æŠŠå®ƒçš„ç±»å‹å’Œæ‰€æŒ‡å‘çš„ç±»å‹æ”¹ä¸º</span>TYEP *TYPE, é‚£ä¹ˆè¯­æ³•æ ¼å¼æ˜¯: (TYPE *)p;</span><br></pre></td></tr></table></figure>
<p>å¼ºåˆ¶ç±»å‹è½¬æ¢çš„ç»“æœæ˜¯ä¸€ä¸ªæ–°æŒ‡é’ˆ,è¯¥æ–°æŒ‡é’ˆçš„ç±»å‹æ˜¯TYPE *,å®ƒæŒ‡å‘çš„ç±»å‹æ˜¯ TYPE,å®ƒæŒ‡å‘çš„åœ°å€å°±æ˜¯åŸæŒ‡é’ˆæŒ‡å‘çš„åœ°å€ã€‚ <strong>è€ŒåŸæ¥çš„æŒ‡é’ˆ p çš„ä¸€åˆ‡å±æ€§éƒ½æ²¡æœ‰è¢«ä¿®æ”¹ã€‚(åˆ‡è®°)</strong></p>
<h4 id="æŒ‡é’ˆçš„å®‰å…¨é—®é¢˜">æŒ‡é’ˆçš„å®‰å…¨é—®é¢˜</h4><ol>
<li>æŒ‡é’ˆè®¿é—®æ•°ç»„æ—¶ï¼Œä¸è¦è¶…è¿‡æ•°ç»„ä½ç«¯å’Œé«˜ç«¯çš„ç•Œé™</li>
<li>å¼ºåˆ¶ç±»å‹è½¬æ¢ptr1 = (TYPE *)ptr2ä¸­ï¼Œå¦‚æœsizeof(prt2çš„ç±»å‹)å¤§äºsizeof(ptr1çš„ç±»å‹)ï¼Œé‚£ä¹ˆä½¿ç”¨æŒ‡é’ˆptr1è®¿é—®ptr2æ‰€æŒ‡å‘çš„å­˜å‚¨åŒºåŸŸæ˜¯å®‰å…¨çš„</li>
</ol>
<h2 id="æŒ‡é’ˆçš„å®é™…åº”ç”¨">æŒ‡é’ˆçš„å®é™…åº”ç”¨</h2><h4 id="XXä¼š">XXä¼š</h4><h4 id="XXä»“">XXä»“</h4>
                    
                        
                    
                    
                        <p>
                            <a href="/2015/06/20/c_pointer/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="/2015/06/17/c3p0/">
                            C3P0çš„ä¸¤ç§ç”¨æ³•
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2015-06-17T18:15:02+08:00">
	
		    Jun 17, 2015
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <h6 id="background">background</h6><blockquote>
<p>è¿™ç¯‡æ–‡ç« æ‘˜æŠ„è‡ªæˆ‘çš„æ–°æµªåšå®¢ï¼Œ<a href="http://blog.sina.com.cn/s/blog_6c5f4d3c01012gtq.html" target="_blank" rel="external">è¯¦æƒ…é“¾æ¥</a> å› ä¸ºå®ƒä¸€åº¦ä¸ºæˆ‘çš„æ–°æµªåšå®¢ç§¯ç´¯è¶…è¿‡7ä¸‡çš„äººæ°”ï¼Œæ–°æµªåšå®¢å·²ç»è¿œä¸å¦‚æ›¾ç»ï¼Œæ‰€ä»¥æˆ‘æƒ³æŠŠè¿™ç¯‡æ–‡ç« ä¿ç•™ä¸‹æ¥ï¼Œä»¥ä¸‹æ˜¯åŸæ–‡</p>
</blockquote>
<h6 id="æ–¹æ³•ä¸€ï¼š">æ–¹æ³•ä¸€ï¼š</h6><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">package   C3P0; </span><br><span class="line">import   java.sql.Connection; </span><br><span class="line">import   java.sql.SQLException; </span><br><span class="line">import   java.beans.PropertyVetoException; </span><br><span class="line">import   com.mchange.v2.c3p0.ComboPooledDataSource; </span><br><span class="line">public   class   DBPool&#123;       </span><br><span class="line">   private   static   DBPool   dbPool;       </span><br><span class="line">   private   ComboPooledDataSource   dataSource;     </span><br><span class="line">	</span><br><span class="line">   static   &#123;       </span><br><span class="line">           dbPool=new   DBPool();       </span><br><span class="line">   &#125;       </span><br><span class="line">   </span><br><span class="line">   public   DBPool()&#123;       </span><br><span class="line">           try   &#123;       </span><br><span class="line">                   dataSource=new   ComboPooledDataSource();       </span><br><span class="line">                   dataSource.setUser( "id ");       </span><br><span class="line">                   dataSource.setPassword( "pw ");       </span><br><span class="line">                   dataSource.setJdbcUrl( "jdbc:mysql://127.0.0.1:3306/test? </span><br><span class="line">	</span><br><span class="line">autoReconnect=true&amp;useUnicode=true&amp;characterEncoding=GB2312 "); </span><br><span class="line">                   dataSource.setDriverClass( "com.mysql.jdbc.Driver "); </span><br><span class="line">                   dataSource.setInitialPoolSize(2); </span><br><span class="line">                   dataSource.setMinPoolSize(1); </span><br><span class="line">                   dataSource.setMaxPoolSize(10); </span><br><span class="line">                   dataSource.setMaxStatements(50); </span><br><span class="line">                   dataSource.setMaxIdleTime(60);       </span><br><span class="line">           &#125;   catch   (PropertyVetoException   e)   &#123;       </span><br><span class="line">               throw   new   RuntimeException(e);       </span><br><span class="line">           &#125;       </span><br><span class="line">   &#125;       </span><br><span class="line">	</span><br><span class="line">   public   final   static   DBPool   getInstance()&#123;       </span><br><span class="line">           return   dbPool;       </span><br><span class="line">   &#125;       </span><br><span class="line">	</span><br><span class="line">   public   final   Connection   getConnection()   &#123;       </span><br><span class="line">           try   &#123;       </span><br><span class="line">                   return   dataSource.getConnection();       </span><br><span class="line">           &#125;   catch   (SQLException   e)   &#123;       </span><br><span class="line">                   throw   new   RuntimeException( "æ— æ³•ä»æ•°æ®æºè·å–è¿æ¥ ",e);       </span><br><span class="line">           &#125;       </span><br><span class="line">   &#125;     </span><br><span class="line">   </span><br><span class="line">   public   static   void   main(String[]   args)   throws   SQLException   &#123; </span><br><span class="line">Connection   con   =   null; </span><br><span class="line">try   &#123; </span><br><span class="line">con   =   DBPool.getInstance().getConnection(); </span><br><span class="line">&#125;   catch   (Exception   e)&#123; </span><br><span class="line">&#125;   finally   &#123; </span><br><span class="line">if   (con   !=   null) </span><br><span class="line">con.close(); </span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="æ–¹æ³•äºŒï¼š">æ–¹æ³•äºŒï¼š</h6><pre><code>åŸæ¥ä¸çŸ¥é“ä½¿ç”¨c3p0 æ˜¯å¦‚æ­¤çš„ç®€å•ï¼Œæˆ‘ä¸€ç›´ä½¿ç”¨<span class="keyword">properties</span> æ–‡ä»¶å»é…ç½®c3p0ï¼Œä½†æ€»æ˜¯è¿æ¥ä¸ä¸Šæ•°æ®åº“ï¼Œåæ¥è°ƒè¯•æ‰å‘ç°ComboPooledDataSource è¿™ä¸ªå¯¹è±¡çš„å±æ€§æ²¡æœ‰è¢«è®¾ç½®æˆåŠŸï¼Œæˆ‘æ˜¯å…ˆè·å–äº†<span class="keyword">properties</span>æ–‡ä»¶çš„å†…å®¹ï¼Œå°è£…åœ¨ä¸€ä¸ª Propertieså¯¹è±¡é‡Œé¢ï¼Œç„¶åç›´æ¥è°ƒç”¨ ComboPooledDataSource çš„ setPropertiesï¼ˆProperties  pï¼‰ æ–¹æ³•æ¥é…ç½®c3p0ï¼Œç¨‹åºæ˜¯æ²¡æœ‰æŠ¥é”™ï¼Œä½†è¿ä¸ä¸Šæ•°æ®åº“ï¼Œè°ƒè¯•å‘ç°å±æ€§éƒ½æ²¡æœ‰è®¾ç½®æˆåŠŸï¼Œåªæ˜¯<span class="keyword">properties</span>è¿™ä¸ªå±æ€§è¢«è®¾ç½®äº†è€Œå·²ï¼Œç»“æœæˆ‘å¯¹æ¯ä¸ªå±æ€§è°ƒç”¨setæ–¹æ³•åå°±è¿æ¥ä¸Šäº†ã€‚ã€‚ã€‚
</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">ConnectionManager</span> </span>&#123;</span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">static</span> ConnectionManager instance;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">public</span> ComboPooledDataSource ds;</span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">static</span> String c3p0Properties = <span class="string">"c3p0.properties"</span>;</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">private</span> <span class="title">ConnectionManager</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">  Properties p = <span class="keyword">new</span> Properties();</span><br><span class="line">  p.load(<span class="keyword">this</span>.getClass().getResourceAsStream(c3p0Properties));</span><br><span class="line">  ds = <span class="keyword">new</span> ComboPooledDataSource();</span><br><span class="line">  ds.setUser(p.getProperty(<span class="string">"user"</span>));</span><br><span class="line">  ds.setPassword(p.getProperty(<span class="string">"user"</span>));</span><br><span class="line">  ds.setJdbcUrl(p.getProperty(<span class="string">"user"</span>));</span><br><span class="line">  ds.setDriverClass(p.getProperty(<span class="string">"user"</span>));</span><br><span class="line">  ds.setInitialPoolSize(Integer.parseInt(p.getProperty(<span class="string">"initialPoolSize"</span>)));</span><br><span class="line">  ds.setMinPoolSize(Integer.parseInt(p.getProperty(<span class="string">"minPoolSize"</span>)));</span><br><span class="line">  ds.setMaxPoolSize(Integer.parseInt(p.getProperty(<span class="string">"maxPoolSize"</span>)));</span><br><span class="line">  ds.setMaxStatements(Integer.parseInt(p.getProperty(<span class="string">"maxStatements"</span>)));</span><br><span class="line">  ds.setMaxIdleTime(Integer.parseInt(p.getProperty(<span class="string">"maxIdleTime"</span>)));</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> ConnectionManager <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">   <span class="keyword">try</span> &#123;</span><br><span class="line">    instance = <span class="keyword">new</span> ConnectionManager();</span><br><span class="line">   &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">   &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> instance;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">final</span> Connection <span class="title">getConnection</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">   <span class="keyword">return</span> ds.getConnection();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">   e.printStackTrace();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">finalize</span><span class="params">()</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">  DataSources.destroy(ds); <span class="comment">// å…³é—­datasource</span></span><br><span class="line">  <span class="keyword">super</span>.finalize();</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><code>å¦‚æ­¤å°±å¯ä»¥è·å–connectionæ¥åšjdbcæ“ä½œäº†ï¼š
Connection         
conn=ConnectionManager.getInstance().getConnection()<span class="comment">;</span>
è®°å¾—ä½¿ç”¨å®Œåè°ƒç”¨closeæ–¹æ³•ï¼š
conn.close()<span class="comment">;</span>
c3p0 çš„æŸäº›å‚æ•°çš„é…ç½®ä»¥åŠæ„ä¹‰è§å¦å¤–ä¸€ç¯‡æ–‡ç« http://kangzye.blog.163.com/blog/static/<span class="number">3681922320104</span><span class="number">42162576</span>/
</code></pre>
                    
                        
                    
                    
                        <p>
                            <a href="/2015/06/17/c3p0/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="/2014/05/17/easy_compiler/">
                            ä¸€ä¸ªç®€å•çš„ç¼–è¯‘å™¨
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2014-05-17T18:15:02+08:00">
	
		    May 17, 2014
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <pre><code>ç®€å•çš„è¯´ ç¼–è¯‘å™¨ å°±æ˜¯è¯­è¨€ç¿»è¯‘å™¨ï¼Œå®ƒä¸€èˆ¬å°†é«˜çº§è¯­è¨€ç¿»è¯‘æˆæ›´ä½çº§çš„è¯­è¨€ï¼Œå¦‚ GCC å¯å°† <span class="keyword">C</span>/<span class="keyword">C</span>++ è¯­è¨€ç¿»è¯‘æˆå¯æ‰§è¡Œæœºå™¨è¯­è¨€ï¼ŒJava ç¼–è¯‘å™¨å¯ä»¥å°† Java æºä»£ç ç¿»è¯‘æˆ Java è™šæ‹Ÿæœºå¯ä»¥æ‰§è¡Œçš„å­—èŠ‚ç ã€‚

ç¼–è¯‘å™¨å¦‚æ­¤ç¥å¥‡ï¼Œé‚£ä¹ˆå®ƒåˆ°åº•æ˜¯å¦‚ä½•å·¥ä½œçš„å‘¢ï¼Ÿæœ¬æ–‡å°†ç®€å•ä»‹ç»ç¼–è¯‘å™¨çš„åŸç†ï¼Œå¹¶å®ç°ä¸€ä¸ªç®€å•çš„ç¼–è¯‘å™¨ï¼Œä½¿å®ƒèƒ½ç¼–è¯‘æˆ‘ä»¬è‡ªå®šä¹‰è¯­æ³•æ ¼å¼çš„æºä»£ç ã€‚ï¼ˆæ–‡ä¸­ä½¿ç”¨çš„æºç éƒ½å·²ä¸Šä¼ è‡³ GitHub ä»¥æ–¹ä¾¿æŸ¥çœ‹ï¼‰ã€‚
</code></pre><h6 id="è‡ªå®šä¹‰è¯­æ³•">è‡ªå®šä¹‰è¯­æ³•</h6><pre><code>ä¸ºäº†ç®€æ´æ˜“æ‡‚ï¼Œæˆ‘ä»¬çš„ç¼–è¯‘å™¨å°†åªæ”¯æŒä»¥ä¸‹ç®€å•åŠŸèƒ½ï¼š
</code></pre><ul>
<li>æ•°æ®ç±»å‹åªæ”¯æŒæ•´å‹ï¼Œè¿™æ ·ä¸éœ€è¦æ•°æ®ç±»å‹ç¬¦ï¼›</li>
<li>æ”¯æŒ åŠ ï¼ˆ+ï¼‰ï¼Œå‡ï¼ˆ-ï¼‰ï¼Œä¹˜ï¼ˆ*ï¼‰ï¼Œ é™¤ï¼ˆ/ï¼‰ è¿ç®—</li>
<li>æ”¯æŒå‡½æ•°è°ƒç”¨</li>
<li>æ”¯æŒ externï¼ˆä¸ºäº†è°ƒç”¨ printf æ‰“å°è®¡ç®—ç»“æœï¼‰</li>
</ul>
<p>ä»¥ä¸‹æ˜¯æˆ‘ä»¬è¦æ”¯æŒçš„æºç å®ä¾‹ demo.xyï¼š</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">extern</span> <span class="title">printi</span><span class="params">(val)</span></span><br><span class="line"></span><br><span class="line"><span class="title">sum</span><span class="params">(a, b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mult(a, b) &#123;</span><br><span class="line">    <span class="keyword">return</span> a * b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">printi(mult(<span class="number">4</span>, <span class="number">5</span>) - sum(<span class="number">4</span>, <span class="number">5</span>))</span><br></pre></td></tr></table></figure>
<h6 id="ç¼–è¯‘åŸç†ç®€ä»‹">ç¼–è¯‘åŸç†ç®€ä»‹</h6><pre><code>ä¸€èˆ¬ç¼–è¯‘å™¨æœ‰ä»¥ä¸‹å·¥ä½œæ­¥éª¤ï¼š
</code></pre><ul>
<li>è¯æ³•åˆ†æï¼ˆLexical analysisï¼‰ï¼š æ­¤é˜¶æ®µçš„ä»»åŠ¡æ˜¯ä»å·¦åˆ°å³ä¸€ä¸ªå­—ç¬¦ä¸€ä¸ªå­—ç¬¦åœ°è¯»å…¥æºç¨‹åºï¼Œå¯¹æ„æˆæºç¨‹åºçš„å­—ç¬¦æµè¿›è¡Œæ‰«æç„¶åæ ¹æ®æ„è¯è§„åˆ™è¯†åˆ« å•è¯ï¼ˆTokenï¼‰ï¼Œå®Œæˆè¿™ä¸ªä»»åŠ¡çš„ç»„ä»¶æ˜¯ è¯æ³•åˆ†æå™¨ï¼ˆLexical analyzerï¼Œç®€ç§°Lexerï¼‰ï¼Œä¹Ÿå« æ‰«æå™¨ï¼ˆScannerï¼‰ï¼›</li>
<li>è¯­æ³•åˆ†æï¼ˆSyntactic analysisï¼Œä¹Ÿå« Parsingï¼‰ï¼š æ­¤é˜¶æ®µçš„ä¸»è¦ä»»åŠ¡æ˜¯ç”± è¯æ³•åˆ†æå™¨ ç”Ÿæˆçš„å•è¯æ„å»º æŠ½è±¡è¯­æ³•æ ‘ï¼ˆAbstract Syntax Tree ï¼ŒASTï¼‰ï¼Œå®Œæˆæ­¤ä»»åŠ¡çš„ç»„ä»¶æ˜¯ è¯­æ³•åˆ†æå™¨ï¼ˆParserï¼‰ï¼›</li>
<li>ç›®æ ‡ç ç”Ÿæˆï¼š æ­¤é˜¶æ®µç¼–è¯‘å™¨ä¼šéå†ä¸Šä¸€æ­¥ç”Ÿæˆçš„æŠ½è±¡è¯­æ³•æ ‘ï¼Œç„¶åä¸ºæ¯ä¸ªèŠ‚ç‚¹ç”Ÿæˆ æœºå™¨ / å­—èŠ‚ç ã€‚<br>ç¼–è¯‘å™¨å®Œæˆç¼–è¯‘åï¼Œç”± é“¾æ¥å™¨ï¼ˆLinkerï¼‰ å°†ç”Ÿæˆçš„ç›®æ ‡æ–‡ä»¶é“¾æ¥æˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¿™ä¸€æ­¥å¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œä¸€äº›ä¾èµ–äºè™šæ‹Ÿæœºè¿è¡Œçš„è¯­è¨€ï¼ˆå¦‚ Javaï¼ŒErlangï¼‰å°±ä¸éœ€è¦é“¾æ¥ã€‚</li>
</ul>
<h6 id="å·¥å…·ç®€ä»‹">å·¥å…·ç®€ä»‹</h6><pre><code>å¯¹åº”ç¼–è¯‘å™¨å·¥ä½œæ­¥éª¤æˆ‘ä»¬å°†ä½¿ç”¨ä»¥ä¸‹å·¥å…·ï¼Œæ‹¬å·é‡Œæ ‡æ˜äº†æ‰€ä½¿ç”¨çš„ç‰ˆæœ¬å·ï¼š
</code></pre><ul>
<li>Flexï¼ˆ2.6.0ï¼‰: Flex æ˜¯ Lex å¼€æºæ›¿ä»£å“ï¼Œä»–ä»¬éƒ½æ˜¯ è¯æ³•åˆ†æå™¨ åˆ¶ä½œå·¥å…·ï¼Œå®ƒå¯ä»¥æ ¹æ®æˆ‘ä»¬å®šä¹‰çš„è§„åˆ™ç”Ÿæˆ è¯æ³•åˆ†æå™¨ çš„ä»£ç ï¼›</li>
<li>Bisonï¼ˆ3.0.4ï¼‰ï¼š Bison æ˜¯ è¯­æ³•åˆ†æå™¨ çš„åˆ¶ä½œå·¥å…·ï¼ŒåŒæ ·å®ƒå¯ä»¥æ ¹æ®æˆ‘ä»¬å®šä¹‰çš„è§„åˆ™ç”Ÿæˆ è¯­æ³•åˆ†æå™¨ çš„ä»£ç ï¼›</li>
<li><p>LLVMï¼ˆ3.8.0ï¼‰ï¼š LLVM æ˜¯æ„æ¶ç¼–è¯‘å™¨çš„æ¡†æ¶ç³»ç»Ÿï¼Œæˆ‘ä»¬ä¼šåˆ©ç”¨ä»–æ¥å®Œæˆä» æŠ½è±¡è¯­æ³•æ ‘ ç”Ÿæˆç›®æ ‡ç çš„è¿‡ç¨‹ã€‚</p>
<p>  åœ¨ ubuntu ä¸Šå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å®‰è£…è¿™äº›å·¥å…·ï¼š</p>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install flex</span><br><span class="line">sudo apt-get install bison</span><br><span class="line">sudo apt-get install llvm-<span class="number">3.8</span>*</span><br></pre></td></tr></table></figure>
<pre><code>ä»‹ç»å®Œå·¥å…·ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥å¼€å§‹å®ç°æˆ‘ä»¬çš„ç¼–è¯‘å™¨äº†ã€‚
</code></pre><h6 id="è¯æ³•åˆ†æå™¨">è¯æ³•åˆ†æå™¨</h6><pre><code>å‰é¢æåˆ° è¯æ³•åˆ†æå™¨ è¦å°†æºç¨‹åºåˆ†è§£æˆ å•è¯ï¼Œæˆ‘ä»¬çš„è¯­æ³•æ ¼å¼å¾ˆç®€å•ï¼ŒåªåŒ…æ‹¬ï¼šæ ‡è¯†ç¬¦ï¼Œæ•°å­—ï¼Œæ•°å­¦è¿ç®—ç¬¦ï¼Œæ‹¬å·å’Œå¤§æ‹¬å·ç­‰ï¼Œæˆ‘ä»¬å°†é€šè¿‡ <span class="attribute">Flex</span> æ¥ç”Ÿæˆ è¯æ³•åˆ†æå™¨ çš„æºç ï¼Œç»™ <span class="attribute">Flex</span> ä½¿ç”¨çš„è§„åˆ™æ–‡ä»¶ lexical<span class="class">.l</span> å¦‚ä¸‹ï¼š
</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">%&#123;</span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">"ast.h"</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">"syntactic.hpp"</span></span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> SAVE_TOKEN  yylval.string = new std::string(yytext, yyleng)</span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> TOKEN(t)    (yylval.token = t)</span></span><br><span class="line">%&#125;</span><br><span class="line"></span><br><span class="line">%option noyywrap</span><br><span class="line"></span><br><span class="line">%%</span><br><span class="line"></span><br><span class="line">[ \t\n]                 ;</span><br><span class="line"><span class="string">"extern"</span>                <span class="keyword">return</span> TOKEN(TEXTERN);</span><br><span class="line"><span class="string">"return"</span>                <span class="keyword">return</span> TOKEN(TRETURN);</span><br><span class="line">[a-zA-Z_][a-zA-Z0-<span class="number">9</span>_]*  SAVE_TOKEN; <span class="keyword">return</span> TIDENTIFIER;</span><br><span class="line">[<span class="number">0</span>-<span class="number">9</span>]+                  SAVE_TOKEN; <span class="keyword">return</span> TINTEGER;</span><br><span class="line"></span><br><span class="line"><span class="string">"="</span>                     <span class="keyword">return</span> TOKEN(TEQUAL);</span><br><span class="line"><span class="string">"=="</span>                    <span class="keyword">return</span> TOKEN(TCEQ);</span><br><span class="line"><span class="string">"!="</span>                    <span class="keyword">return</span> TOKEN(TCNE);</span><br><span class="line"><span class="string">"("</span>                     <span class="keyword">return</span> TOKEN(TLPAREN);</span><br><span class="line"><span class="string">")"</span>                     <span class="keyword">return</span> TOKEN(TRPAREN);</span><br><span class="line"><span class="string">"&#123;"</span>                     <span class="keyword">return</span> TOKEN(TLBRACE);</span><br><span class="line"><span class="string">"&#125;"</span>                     <span class="keyword">return</span> TOKEN(TRBRACE);</span><br><span class="line"><span class="string">","</span>                     <span class="keyword">return</span> TOKEN(TCOMMA);</span><br><span class="line"><span class="string">"+"</span>                     <span class="keyword">return</span> TOKEN(TPLUS);</span><br><span class="line"><span class="string">"-"</span>                     <span class="keyword">return</span> TOKEN(TMINUS);</span><br><span class="line"><span class="string">"*"</span>                     <span class="keyword">return</span> TOKEN(TMUL);</span><br><span class="line"><span class="string">"/"</span>                     <span class="keyword">return</span> TOKEN(TDIV);</span><br><span class="line"></span><br><span class="line">.                       <span class="built_in">printf</span>(<span class="string">"Unknown token!\n"</span>); yyterminate();</span><br><span class="line">%%</span><br></pre></td></tr></table></figure>
<pre><code>æˆ‘ä»¬æ¥è§£é‡Šä¸€ä¸‹ï¼Œè¿™ä¸ªæ–‡ä»¶è¢« <span class="number">2</span> ä¸ª %% åˆ†æˆ <span class="number">3</span> éƒ¨åˆ†ï¼Œç¬¬ <span class="number">1</span> éƒ¨åˆ†ç”¨ %{ ä¸ %} åŒ…æ‹¬çš„æ˜¯ä¸€äº› C++ ä»£ç ï¼Œä¼šè¢«åŸæ ·å¤åˆ¶åˆ° Flex ç”Ÿæˆçš„æºç æ–‡ä»¶ä¸­ï¼Œè¿˜å¯ä»¥åœ¨æŒ‡å®šä¸€äº›é€‰é¡¹ï¼Œå¦‚æˆ‘ä»¬ä½¿ç”¨äº† %option noyywrapï¼Œä¹Ÿå¯ä»¥åœ¨è¿™å®šä¹‰å®ä¾›åé¢ä½¿ç”¨ï¼›ç¬¬ <span class="number">2</span> éƒ¨åˆ†ç”¨æ¥å®šä¹‰æ„æˆå•è¯çš„è§„åˆ™ï¼Œå¯ä»¥çœ‹åˆ°æ¯æ¡è§„éƒ½æ˜¯ä¸€ä¸ª æ­£åˆ™è¡¨è¾¾å¼ å’Œ åŠ¨ä½œï¼Œå¾ˆç›´ç™½ï¼Œå°±æ˜¯ è¯æ³•åˆ†æå™¨ å‘ç°äº†åŒ¹é…çš„ å•è¯ åæ‰§è¡Œç›¸åº”çš„ åŠ¨ä½œ ä»£ç ï¼Œå¤§éƒ¨åˆ†åªè¦è¿”å› å•è¯ ç»™è°ƒç”¨è€…å°±å¯ä»¥äº†ï¼›ç¬¬ <span class="number">3</span> éƒ¨åˆ†å¯ä»¥å®šä¹‰ä¸€äº›å‡½æ•°ï¼Œä¹Ÿä¼šåŸæ ·å¤åˆ¶åˆ°ç”Ÿæˆçš„æºç ä¸­å»ï¼Œè¿™é‡Œæˆ‘ä»¬ç•™ç©ºæ²¡æœ‰ä½¿ç”¨ã€‚

ç°åœ¨æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨ Flex ç”Ÿæˆ è¯æ³•åˆ†æå™¨ çš„æºç ï¼š

flex -o lexical.cpp lexical.l

ç”Ÿæˆçš„ã€€lexical.cppã€€é‡Œä¼šæœ‰ä¸€ä¸ª yylex() å‡½æ•°ä¾›ã€€è¯­æ³•åˆ†æå™¨ã€€è°ƒç”¨ï¼›ä½ å¯èƒ½å‘ç°äº†ï¼Œæœ‰äº›å®å’Œå˜é‡å¹¶æ²¡æœ‰è¢«å®šä¹‰ï¼ˆå¦‚TEXTERNï¼Œyylvalï¼Œyytext ç­‰ï¼‰ï¼Œå…¶å®æœ‰äº›æ˜¯ Flex ä¼šè‡ªåŠ¨å®šä¹‰çš„å†…ç½®å˜é‡ï¼ˆå¦‚ yytextï¼‰ï¼Œæœ‰äº›æ˜¯åé¢ è¯­æ³•åˆ†æå™¨ ç”Ÿæˆå·¥å…·é‡Œå®šä¹‰çš„å˜é‡ï¼ˆå¦‚ yylvalï¼‰ï¼Œæˆ‘ä»¬åé¢ä¼šçœ‹åˆ°ã€‚
</code></pre><h6 id="è¯­æ³•åˆ†æå™¨">è¯­æ³•åˆ†æå™¨</h6><pre><code>è¯­æ³•åˆ†æå™¨ çš„ä½œç”¨æ˜¯æ„å»º æŠ½è±¡è¯­æ³•æ ‘ï¼Œé€šä¿—çš„è¯´ æŠ½è±¡è¯­æ³•æ ‘ å°±æ˜¯å°†æºç ç”¨æ ‘çŠ¶ç»“æ„æ¥è¡¨ç¤ºï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½ä»£è¡¨æºç ä¸­çš„ä¸€ç§ç»“æ„ï¼›å¯¹äºæˆ‘ä»¬è¦å®ç°çš„è¯­æ³•ï¼Œå…¶è¯­æ³•æ ‘æ˜¯å¾ˆç®€å•çš„ï¼Œå¦‚ä¸‹ï¼š



ç°åœ¨æˆ‘ä»¬ä½¿ç”¨ <span class="keyword">Bison </span>ç”Ÿæˆ è¯­æ³•åˆ†æå™¨ ä»£ç ï¼ŒåŒæ · <span class="keyword">Bison </span>éœ€è¦ä¸€ä¸ªè§„åˆ™æ–‡ä»¶ï¼Œæˆ‘ä»¬çš„è§„åˆ™æ–‡ä»¶ syntactic.y å¦‚ä¸‹ï¼Œé™äºç¯‡å¹…ï¼Œçœç•¥äº†æŸäº›éƒ¨åˆ†ï¼Œå¯ä»¥é€šè¿‡é“¾æ¥æŸ¥çœ‹å®Œæ•´å†…å®¹ï¼š
</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">%&#123;</span><br><span class="line">    <span class="preprocessor">#<span class="keyword">include</span> <span class="string">"ast.h"</span></span></span><br><span class="line">    <span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">extern</span> <span class="keyword">int</span> <span class="title">yylex</span><span class="params">()</span></span>;    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">yyerror</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *s)</span> </span>&#123; <span class="built_in">std</span>::<span class="built_in">printf</span>(<span class="string">"Error: %s\n"</span>, s);<span class="built_in">std</span>::<span class="built_in">exit</span>(<span class="number">1</span>); &#125;</span><br><span class="line">%&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">%token &lt;token&gt; TLPAREN TRPAREN TLBRACE TRBRACE TCOMMA</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">%%</span><br><span class="line"></span><br><span class="line">program:</span><br><span class="line">  stmts &#123; programBlock = $<span class="number">1</span>; &#125;</span><br><span class="line">        ;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">func_decl:</span><br><span class="line">  ident TLPAREN func_decl_args TRPAREN block &#123; $$ = <span class="keyword">new</span> NFunctionDeclaration(*$<span class="number">1</span>, *$<span class="number">3</span>, *$<span class="number">5</span>); <span class="keyword">delete</span> $<span class="number">3</span>; &#125;</span><br><span class="line">;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">%%</span><br></pre></td></tr></table></figure>
<pre><code>æ˜¯ä¸æ˜¯å‘ç°å’Œ <span class="attribute">Flex</span> çš„è§„åˆ™æ–‡ä»¶å¾ˆåƒå‘¢ï¼Ÿç¡®å®æ˜¯è¿™æ ·ï¼Œå®ƒä¹Ÿæ˜¯åˆ† 3 ä¸ªéƒ¨åˆ†ç»„æˆï¼ŒåŒæ ·ï¼Œç¬¬ä¸€éƒ¨åˆ†çš„ C++ ä»£ç ä¼šè¢«å¤åˆ¶åˆ°ç”Ÿæˆçš„æºæ–‡ä»¶ä¸­ï¼Œè¿˜å¯ä»¥çœ‹åˆ°è¿™é‡Œé€šè¿‡ä»¥ä¸‹è¿™æ ·çš„è¯­æ³•å®šä¹‰å‰é¢äº† <span class="attribute">Flex</span> ä½¿ç”¨çš„å®ï¼š
</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%token &lt;token&gt; TLPAREN TRPAREN TLBRACE TRBRACE TCOMMA</span><br></pre></td></tr></table></figure>
<pre><code>æ¯”è¾ƒä¸åŒçš„æ˜¯ç¬¬ <span class="number">2</span> éƒ¨åˆ†ï¼Œä¸åƒ Flex é€šè¿‡ æ­£åˆ™è¡¨è¾¾å¼ é€šè¿‡å®šä¹‰è§„åˆ™ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯ å·´ç§‘æ–¯èŒƒå¼ï¼ˆ<span class="keyword">BNF: </span><span class="keyword">Backus-Naur </span>Formï¼‰ çš„å½¢å¼å®šä¹‰äº†æˆ‘ä»¬è¯†åˆ«çš„è¯­æ³•ç»“æ„ã€‚å¦‚ä¸‹çš„è¯­æ³•è¡¨ç¤ºå‡½æ•°ï¼š
</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">func_decl:</span><br><span class="line">  ident TLPAREN func_decl_args TRPAREN block &#123; $$ = <span class="keyword">new</span> NFunctionDeclaration(*$<span class="number">1</span>, *$<span class="number">3</span>, *$<span class="number">5</span>); <span class="keyword">delete</span> $<span class="number">3</span>; &#125;</span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<pre><code>å¯ä»¥çœ‹åˆ°åé¢å¤§æ‹¬å·ä¸­é—´çš„ä¹Ÿæ˜¯ åŠ¨ä½œ ä»£ç ï¼Œä¸Šä¾‹çš„åŠ¨ä½œæ˜¯åœ¨ æŠ½è±¡è¯­æ³•æ ‘ ä¸­ç”Ÿæˆä¸€ä¸ªå‡½æ•°çš„èŠ‚ç‚¹ï¼Œå…¶å®è¿™éƒ¨åˆ†çš„å…¶ä»–è§„åˆ™ä¹Ÿæ˜¯ç”Ÿæˆç›¸åº”ç±»å‹çš„èŠ‚ç‚¹åˆ°è¯­æ³•æ ‘ä¸­ã€‚åƒ NFunctionDeclaration è¿™æ˜¯ä¸€ä¸ªæˆ‘ä»¬è‡ªå·±å®šä¹‰çš„èŠ‚ç‚¹ç±»ï¼Œæˆ‘ä»¬åœ¨ ast<span class="class">.h</span> ä¸­å®šä¹‰äº†æˆ‘ä»¬æ‰€è¦ç”¨åˆ°çš„èŠ‚ç‚¹ï¼ŒåŒæ ·çš„ï¼Œæˆ‘ä»¬æ‘˜å–ä¸€æ®µä»£ç å¦‚ä¸‹ï¼š
</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="keyword">class</span> NFunctionDeclaration : <span class="keyword">public</span> NStatement &#123;</span><br><span class="line"><span class="keyword">public</span>:    </span><br><span class="line">    <span class="keyword">const</span> NIdentifier&amp; id;</span><br><span class="line">    VariableList arguments;</span><br><span class="line">    NBlock&amp; block;</span><br><span class="line">    NFunctionDeclaration(<span class="keyword">const</span> NIdentifier&amp; id,            </span><br><span class="line">            <span class="keyword">const</span> VariableList&amp; arguments, NBlock&amp; block) :</span><br><span class="line">        id(id), arguments(arguments), block(block) &#123; &#125;    </span><br><span class="line">    <span class="keyword">virtual</span> llvm::<span class="function">Value* <span class="title">codeGen</span><span class="params">(CodeGenContext&amp; context)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<pre><code>å¯ä»¥çœ‹åˆ°ï¼Œå®ƒæœ‰ æ ‡è¯†ç¬¦ï¼ˆidï¼‰ï¼Œå‚æ•°åˆ—è¡¨ï¼ˆargumentsï¼‰ï¼Œå‡½æ•°ä½“ï¼ˆblockï¼‰ è¿™äº›æˆå‘˜ï¼Œåœ¨è¯­æ³•åˆ†æé˜¶æ®µä¼šè®¾ç½®å¥½è¿™äº›æˆå‘˜çš„å†…å®¹ä¾›åé¢çš„ ç›®æ ‡ç ç”Ÿæˆ é˜¶æ®µä½¿ç”¨ã€‚è¿˜å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ª <span class="function"><span class="title">codeGen</span><span class="params">()</span></span> è™šå‡½æ•°ï¼Œä½ å¯èƒ½çŒœåˆ°äº†ï¼Œåé¢å°±æ˜¯é€šè¿‡è°ƒç”¨å®ƒæ¥ç”Ÿæˆç›¸åº”çš„ç›®æ ‡ä»£ç ã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤è°ƒç”¨ Bison ç”Ÿæˆ è¯­æ³•åˆ†æå™¨ çš„æºç æ–‡ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ -d ä½¿å¤´æ–‡ä»¶å’Œæºæ–‡ä»¶åˆ†å¼€ï¼Œå› ä¸ºå‰é¢ è¯æ³•åˆ†æå™¨ çš„æºç ä½¿ç”¨äº†è¿™é‡Œå®šä¹‰çš„ä¸€äº›å®ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨è¿™ä¸ªå¤´æ–‡ä»¶ï¼Œè¿™é‡Œå°†ä¼šç”Ÿæˆ syntactic<span class="class">.cpp</span> å’Œ syntactic.hppï¼š
</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bison -d -o syntactic.cpp syntactic.y</span><br></pre></td></tr></table></figure>
<h6 id="ç›®æ ‡ç ç”Ÿæˆ">ç›®æ ‡ç ç”Ÿæˆ</h6><pre><code>è¿™æ˜¯æœ€åä¸€æ­¥äº†ï¼Œè¿™ä¸€æ­¥çš„ä¸»è§’æ˜¯å‰é¢æåˆ° LLVMï¼ŒLLVM æ˜¯ä¸€ä¸ªæ„å»ºç¼–è¯‘å™¨çš„æ¡†æ¶ç³»ç»Ÿï¼Œæˆ‘ä»¬ä½¿ç”¨ä»–éå† è¯­æ³•åˆ†æ é˜¶æ®µç”Ÿæˆçš„ æŠ½è±¡è¯­æ³•æ ‘ï¼Œç„¶åä¸ºæ¯ä¸ªèŠ‚ç‚¹ç”Ÿæˆç›¸åº”çš„ ç›®æ ‡ç ã€‚å½“ç„¶ï¼Œæ— æ³•é¿å…çš„æ˜¯æˆ‘ä»¬éœ€è¦ä½¿ç”¨ LLVM æä¾›çš„å‡½æ•°æ¥ç¼–å†™ç”Ÿæˆç›®æ ‡ç çš„æºç ï¼Œå°±æ˜¯å®ç°å‰é¢æåˆ°çš„è™šå‡½æ•° <span class="function"><span class="title">codeGen</span><span class="params">()</span></span>ï¼Œæ˜¯ä¸æ˜¯æœ‰ç‚¹æ‹—å£ï¼Ÿä¸è¿‡ç¡®å®æ˜¯è¿™æ ·ã€‚æˆ‘ä»¬åœ¨ gen<span class="class">.cpp</span> ä¸­ç¼–å†™äº†ä¸åŒèŠ‚ç‚¹çš„ç”Ÿæˆä»£ç ï¼Œæˆ‘ä»¬æ‘˜å–ä¸€æ®µçœ‹ä¸€ä¸‹ï¼š
</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">Value *NMethodCall::codeGen(CodeGenContext &amp;context) &#123;</span><br><span class="line">    Function *function = context.module-&gt;getFunction(id.name.c_str());    <span class="keyword">if</span> (function == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">"no such function "</span> &lt;&lt; id.name &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;Value *&gt; args;</span><br><span class="line">    ExpressionList::const_iterator it;    </span><br><span class="line">    <span class="keyword">for</span> (it = arguments.begin(); it != arguments.end(); it++) &#123;</span><br><span class="line">        args.push_back((**it).codeGen(context));</span><br><span class="line">    &#125;</span><br><span class="line">    CallInst *call = CallInst::Create(function, makeArrayRef(args), <span class="string">""</span>, context.currentBlock());</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Creating method call: "</span> &lt;&lt; id.name &lt;&lt; endl;   </span><br><span class="line">    <span class="keyword">return</span> call;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<pre><code>çœ‹èµ·æ¥æœ‰ç‚¹å¤æ‚ï¼Œç®€å•æ¥è¯´å°±æ˜¯é€šè¿‡ LLVM æä¾›çš„æ¥å£æ¥ç”Ÿæˆ ç›®æ ‡ç ï¼Œéœ€è¦äº†è§£æ›´å¤šçš„è¯å¯ä»¥å» LLVM çš„å®˜ç½‘å­¦ä¹ ä¸€ä¸‹ã€‚

è‡³æ­¤ï¼Œæˆ‘ä»¬æ‰€æœ‰çš„å·¥ä½œåŸºæœ¬éƒ½åšå®Œäº†ã€‚ç®€å•å›é¡¾ä¸€ä¸‹ï¼šæˆ‘ä»¬å…ˆé€šè¿‡ Flex ç”Ÿæˆ è¯æ³•åˆ†æå™¨ æºç æ–‡ä»¶ lexical.cppï¼Œç„¶åé€šè¿‡ Bison ç”Ÿæˆ è¯­æ³•åˆ†æå™¨ æºç æ–‡ä»¶ syntactic<span class="class">.cpp</span> å’Œå¤´æ–‡ä»¶ syntactic.hppï¼Œæˆ‘ä»¬è‡ªå·±ç¼–å†™äº† æŠ½è±¡è¯­æ³•æ ‘ èŠ‚ç‚¹å®šä¹‰æ–‡ä»¶ ast<span class="class">.h</span> å’Œ ç›®æ ‡ç  ç”Ÿæˆæ–‡ä»¶ ast.cppï¼Œè¿˜æœ‰ä¸€ä¸ª gen<span class="class">.h</span> åŒ…å«ä¸€ç‚¹ LLVM ç¯å¢ƒç›¸å…³çš„ä»£ç ï¼Œä¸ºäº†è¾“å‡ºæˆ‘ä»¬ç¨‹åºçš„ç»“æœï¼Œè¿˜åœ¨ printi<span class="class">.cpp</span> é‡Œç®€å•çš„é€šè¿‡è°ƒç”¨ C è¯­è¨€åº“å‡½æ•°å®ç°äº†è¾“å‡ºä¸€ä¸ªæ•´æ•°ã€‚

å¯¹äº†ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ª main å‡½æ•°ä½œä¸ºç¼–è¯‘å™¨çš„å…¥å£å‡½æ•°ï¼Œå®ƒåœ¨ main<span class="class">.cpp</span> é‡Œï¼š
</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    yyparse();</span><br><span class="line">    InitializeNativeTarget();</span><br><span class="line">    InitializeNativeTargetAsmPrinter();</span><br><span class="line">    InitializeNativeTargetAsmParser();</span><br><span class="line">    CodeGenContext context;</span><br><span class="line">    context.generateCode(*programBlock);</span><br><span class="line">    context.runCode();    </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><code>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶è°ƒç”¨äº† <span class="function"><span class="title">yyparse</span><span class="params">()</span></span> åš è¯­æ³•åˆ†æï¼Œï¼ˆ<span class="function"><span class="title">yyparse</span><span class="params">()</span></span> å†…éƒ¨ä¼šå…ˆè°ƒç”¨ <span class="function"><span class="title">yylex</span><span class="params">()</span></span> åš è¯æ³•åˆ†æï¼‰ï¼›ç„¶åæ˜¯ä¸€ç³»åˆ—çš„ LLVM åˆå§‹åŒ–ä»£ç ï¼Œcontext.<span class="function"><span class="title">generateCode</span><span class="params">(*programBlock)</span></span> æ˜¯å¼€å§‹ç”Ÿæˆ ç›®æ ‡ç ï¼›æœ€åæ˜¯ context.<span class="function"><span class="title">runCode</span><span class="params">()</span></span> æ¥è¿è¡Œä»£ç ï¼Œè¿™é‡Œä½¿ç”¨äº† LLVM çš„ JITï¼ˆJust In Timeï¼‰ æ¥ç›´æ¥è¿è¡Œä»£ç ï¼Œæ²¡æœ‰é“¾æ¥çš„è¿‡ç¨‹ã€‚

ç°åœ¨æˆ‘ä»¬å¯ä»¥ç”¨è¿™äº›æ–‡ä»¶ç”Ÿæˆæˆ‘ä»¬çš„ç¼–è¯‘å™¨äº†ï¼Œéœ€è¦è¯´æ˜ä¸€ä¸‹ï¼Œå› ä¸º è¯æ³•åˆ†æå™¨ çš„æºç ä½¿ç”¨äº†ä¸€äº› è¯­æ³•åˆ†æå™¨ å¤´æ–‡ä»¶ä¸­çš„å®ï¼Œæ‰€ä»¥æ­£ç¡®çš„ç”Ÿæˆé¡ºåºæ˜¯è¿™æ ·çš„ï¼š
</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">bison -d -o syntactic.cpp syntactic.y</span><br><span class="line">flex -o lexical.cpp lexical.l syntactic.hpp</span><br><span class="line">g++ -c `llvm-config --cppflags` -<span class="built_in">std</span>=c++<span class="number">11</span> syntactic.cpp gen.cpp lexical.cpp printi.cpp main.cpp</span><br><span class="line">g++ -o xy-complier syntactic.o gen.o main.o lexical.o printi.o `llvm-config --libs` `llvm-config --ldflags` -lpthread -ldl -lz -lncurses -rdynamic</span><br></pre></td></tr></table></figure>
<pre><code>å¦‚æœä½ ä¸‹è½½äº† GitHub çš„æºç ï¼Œé‚£ä¹ˆç›´æ¥ï¼š
</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd src</span><br><span class="line">make</span><br></pre></td></tr></table></figure>
<pre><code>å°±å¯ä»¥å®Œæˆä»¥ä¸Šè¿‡ç¨‹äº†ï¼Œæ­£å¸¸ä¼šç”Ÿæˆä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ xy-complierï¼Œå®ƒå°±æ˜¯æˆ‘ä»¬çš„ç¼–è¯‘å™¨äº†ã€‚
</code></pre><h6 id="ç¼–è¯‘æµ‹è¯•">ç¼–è¯‘æµ‹è¯•</h6><pre><code>æˆ‘ä»¬ä½¿ç”¨ä¹‹å‰æåˆ°å®ä¾‹ demo<span class="class">.xy</span> æ¥æµ‹è¯•ï¼Œå°†å…¶å†…å®¹ä¼ ç»™ xy-complier çš„æ ‡å‡†è¾“å…¥å°±å¯ä»¥çœ‹åˆ°è¿è¡Œç»“æœäº†ï¼š
</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat demo.xy | ./xy-complier</span><br></pre></td></tr></table></figure>
<pre><code>ä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡

make <span class="built_in">test</span>
æ¥æµ‹è¯•ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š
</code></pre><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">define internal i64 @mult(i64 %a1, i64 %b2) &#123;</span><br><span class="line">entry:</span><br><span class="line">  %a = alloca i64</span><br><span class="line">  %<span class="number">0</span> = load i64, i64* %a</span><br><span class="line">  store i64 %a1, i64* %a</span><br><span class="line">  %b = alloca i64</span><br><span class="line">  %<span class="number">1</span> = load i64, i64* %b</span><br><span class="line">  store i64 %b2, i64* %b</span><br><span class="line">  %<span class="number">2</span> = load i64, i64* %b</span><br><span class="line">  %<span class="number">3</span> = load i64, i64* %a</span><br><span class="line">  %<span class="number">4</span> = mul i64 %<span class="number">3</span>, %<span class="number">2</span></span><br><span class="line">  ret i64 %<span class="number">4</span>&#125;</span><br><span class="line">Running code:<span class="number">11</span>Exiting...</span><br></pre></td></tr></table></figure>
<pre><code>å¯ä»¥çœ‹åˆ°æœ€åæ­£ç¡®è¾“å‡ºäº†æœŸæœ›çš„ç»“æœï¼Œè‡³æ­¤æˆ‘ä»¬ç®€å•çš„ç¼–è¯‘å™¨å°±å®Œæˆäº†ã€‚
</code></pre>
                    
                        
                    
                    
                        <p>
                            <a href="/2014/05/17/easy_compiler/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="/2014/01/03/weapp/">
                            å¾®ä¿¡å°ç¨‹åºæ¢ç©¶
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2014-01-03T18:15:02+08:00">
	
		    Jan 03, 2014
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <h2 id="Background">Background</h2><h4 id="æ—¶é—´è½´">æ—¶é—´è½´</h4><ol>
<li>2016å¹´1æœˆ9æ—¥&nbsp;&nbsp;&nbsp;&nbsp;å¾®ä¿¡å°ç¨‹åºå¯åŠ¨æ—¥</li>
<li>2016å¹´1æœˆ11æ—¥&nbsp;&nbsp;&nbsp;&nbsp;å¼ å°é¾™é¦–æ¬¡å…¬å¼€æ¼”è®²é€éœ²æ­£åœ¨æ¢ç©¶æ–°çš„å…¬ä¼—å·å½¢æ€ï¼Œå³å¾®ä¿¡å°ç¨‹åº</li>
<li>2016å¹´11æœˆ3æ—¥å¤œ&nbsp;&nbsp;&nbsp;&nbsp;å¾®ä¿¡å°ç¨‹åºæ­£å¼å…¬æµ‹</li>
<li>2016å¹´11æœˆ28æ—¥&nbsp;&nbsp;&nbsp;&nbsp;å¼ å°é¾™å…¬å¼€æ¼”è®²å…¬å¼€å¾®ä¿¡å°ç¨‹åºäº§å“å½¢æ€</li>
<li>2017å¹´1æœˆ9æ—¥&nbsp;&nbsp;&nbsp;&nbsp;å¾®ä¿¡å°ç¨‹åºæ­£å¼æ¨å‡ºæ—¶é—´</li>
</ol>
<h4 id="äº§å“å½¢æ€">äº§å“å½¢æ€</h4><ol>
<li>æ— æ¶ˆæ¯æ¨é€</li>
<li>æ— å¾®ä¿¡å…¥å£ã€æ— åº”ç”¨å•†åº—<ul>
<li>æ‰«ç ä½¿ç”¨</li>
<li>LBSæç¤ºé™„è¿‘å°ç¨‹åº</li>
</ul>
</li>
<li>ä¸èƒ½åˆ†äº«åˆ°æœ‹å‹åœˆ<ul>
<li>èƒ½åˆ†äº«åˆ°èŠå¤©æˆ–ç¾¤èŠ</li>
<li>åˆ†äº«çš„å†…å®¹æ˜¯<strong>æ´»çš„</strong>ï¼Œç›´æ¥èƒ½ä¸æ¶ˆæ¯äº§ç”Ÿäº¤äº’</li>
</ul>
</li>
<li>ä¸èƒ½åšæ¸¸æˆ</li>
<li>æä¾›æœ‰é™çš„æœç´¢èƒ½åŠ›<ul>
<li>ç”¨æˆ·è§¦åˆ°æ‰å‡ºç°ï¼Œä¸ä¸»åŠ¨æ¨è</li>
</ul>
</li>
<li>å’Œå…¬ä¼—å·ç›¸äº’ç‹¬ç«‹</li>
</ol>
<h2 id="Native_or_Web?">Native or Web?</h2><p>åˆä¸€çœ‹ï¼Œè§‰å¾—å¾®ä¿¡å°ç¨‹åºæ˜¯Nativeçš„ï¼Œä½†åˆ°åº•æ˜¯Nativeè¿˜æ˜¯Webä¸å¥½ç›´æ¥ä¸‹å®šä¹‰ï¼Œå› ä¸ºå¾®ä¿¡åœ¨è¿™ä¸€å—æ˜¯ä¿å¯†çš„ï¼Œä¸‹é¢å°†ä¸€å±‚ä¸€å±‚çš„æ‘¸ç´¢åˆ†æï¼Œå¹¶æœé›†è¯æ®è¯æ˜è‡ªå·±çš„çŒœæƒ³ã€‚</p>
<h4 id="æ¶æ„">æ¶æ„</h4><p>é¦–å…ˆçœ‹çœ‹å¤§æ¦‚çš„æ¶æ„ï¼ŒåŒ…æ‹¬äº†WXMLã€WXSSã€MINAæ¡†æ¶ï¼Œå‰ä¸¤è€…åˆ†åˆ«å¯¹åº”äº†HTMLã€CSSï¼Œè€ŒMINAä½œä¸ºä¸€ä¸ªMVVMæ¡†æ¶æ— è®ºæ˜¯ä½œç”¨è¿˜æ˜¯è¡¨ç°éƒ½è·ŸVueå¾ˆåƒã€‚<br><img src="https://www.processon.com/chart_image/586b45fae4b0dc8df7a47c9e.png" alt=""></p>
<h4 id="IDE">IDE</h4><p>å¾®ä¿¡å°ç¨‹åºæä¾›äº†ç”¨NW.jsç¼–å†™çš„IDEï¼ˆå¾®ä¿¡å¼€å‘è€…å·¥å…·ï¼‰ï¼Œä»IDEç€æ‰‹ï¼Œæ‰“å¼€IDEï¼Œåœ¨Consoleä¸­è¾“å…¥openVendor()ï¼Œå¦‚ä¸‹</p>
<p><img src="http://ww4.sinaimg.cn/large/006y8lVagw1fbdmjj8sfcj30n206gq3h.jpg" alt=""></p>
<p>æ‰“å¼€å¾—åˆ°ä»¥ä¸‹ç›®å½•</p>
<p><img src="http://ww4.sinaimg.cn/large/006y8lVagw1fbdmkr07lbj312i0aatb1.jpg" alt=""></p>
<p>æ³¨æ„åˆ°ä¸¤ä¸ªæ¯”è¾ƒå¤§çš„jsæ–‡ä»¶ï¼š</p>
<ol>
<li>WAService.js  <ul>
<li>MINAæ¡†æ¶ä»£ç ï¼Œæä¾›ä¸€äº›åŸºç¡€åŠŸèƒ½</li>
</ul>
</li>
<li>WAWebView.js <ul>
<li>ViewåŸºäºå®ƒæ¥è¿è¡Œ</li>
</ul>
</li>
</ol>
<p>åŸºäºå¯¹è¿™ä¸¤ä¸ªæ–‡ä»¶å¤§æ¦‚çš„åˆ†æï¼Œæ˜¯ä¸æ˜¯å¯ä»¥çŒœæƒ³å®ƒä¾ç„¶è¿˜æ˜¯è¿è¡Œåœ¨Webviewä¸­çš„ï¼Œç”±æ­¤å¾—åˆ°å¦‚ä¸‹ä¸€ä¸ªç®€å•çš„æ¶æ„å›¾</p>
<ul>
<li>å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­è¿è¡Œäº†ä¸¤ä¸ªé¡µé¢ï¼Œä¸€ä¸ªæ˜¯Viewå¯¹åº”çš„WXMLé¡µé¢ï¼Œå¦ä¸€ä¸ªæ˜¯Serviceå¯¹åº”çš„MINAæ¡†æ¶</li>
<li>ä¸¤ä¸ªé¡µé¢å¹¶ä¸äº’é€šï¼ŒServiceæ— æ³•æ“ä½œåˆ°Viewä¸­çš„DOMå’ŒBOMï¼Œå› æ­¤å¤–éƒ¨æ— æ³•ä½¿ç”¨jQueryç­‰æ¡†æ¶</li>
<li>å¼€å‘è€…å·¥å…·ä¸­è¿è¡Œï¼šåŸºäºChrome</li>
<li>ç§»åŠ¨è®¾å¤‡ä¸Šçš„è¿è¡Œï¼šServiceåº”è¯¥æ˜¯è¿è¡Œåœ¨X5å†…æ ¸(Android)å’ŒJavaScriptCore(iOS)ç‹¬ç«‹çš„æ²™ç®±é‡Œï¼›Viewè¿˜æ˜¯åŸºäºWebviewè¿è¡Œï¼Œä½†æ˜¯ä¸ºäº†å¢å¼ºä½“éªŒï¼Œé€šè¿‡å¾®ä¿¡çš„å¹³å°æä¾›ä¸€äº›åŸç”Ÿçš„æ ‡ç­¾æ¯”å¦‚Mapã€Videoç­‰</li>
</ul>
<p><img src="https://www.processon.com/chart_image/586b67d5e4b067ce85304983.png" alt=""></p>
<h4 id="è¯•éªŒ">è¯•éªŒ</h4><p>ä¸ºäº†è¿›ä¸€æ­¥è¯æ˜çŒœæƒ³ï¼Œåšä¸€ä¸ªè¿›ä¸€æ­¥çš„è¯•éªŒï¼Œåœ¨WXMLä¸­å†™ä¸€äº›ä¸è¢«æ”¯æŒçš„æ ‡ç­¾ï¼Œå®ƒä¾ç„¶èƒ½å¤Ÿè¢«å±•ç¤ºï¼Œè¿›ä¸€æ­¥è¯´æ˜è¿˜æ˜¯åŸºäºWebviewè¿è¡Œçš„<br><img src="http://ww2.sinaimg.cn/large/006y8lVagw1fbdozoiczaj30mw068gnf.jpg" alt=""></p>
<p>è®¾å¤‡ä¸­æ˜¾ç¤ºå¦‚ä¸‹ï¼š</p>
<p><img src="http://ww3.sinaimg.cn/large/006y8lVagw1fbdp05rxc7j30js0ai76y.jpg" alt=""></p>
<h4 id="å°ç»“">å°ç»“</h4><p>é€šè¿‡ä»¥ä¸Šä»IDEåˆ°ä»£ç è¿è¡Œçš„åˆ†æï¼Œå¯ä»¥å¾—å‡ºä¸€äº›ç»“è®º</p>
<ul>
<li>ç›®å‰è¿˜æ˜¯Webviewæ¸²æŸ“</li>
<li>å¯¹äºå¼€å‘è€…éƒ½æ˜¯é»‘ç›’ï¼Œå…·ä½“çš„è¿è¡Œæœºåˆ¶è¿˜æ²¡å…¬å¼€</li>
<li>ä»¥åå¯èƒ½ä¼šåˆ‡æ¢æˆNativeæ¸²æŸ“</li>
<li>éœ€æŒ‰ç…§å®˜æ–¹è§„å®šçš„è§„èŒƒå¼€å‘</li>
</ul>
<h2 id="æ¡†æ¶">æ¡†æ¶</h2><h3 id="ç›®å½•ç»“æ„">ç›®å½•ç»“æ„</h3><ol>
<li>å°ç¨‹åºåŒ…å«ä¸€ä¸ªæè¿°æ•´ä½“ç¨‹åºçš„ app å’Œå¤šä¸ªæè¿°å„è‡ªé¡µé¢çš„ page</li>
<li>appç”±app.js ã€ app.json ã€app.wxssç»„æˆï¼Œæ”¾åœ¨æ ¹ç›®å½•ä¸‹</li>
<li>pageç”±js ã€ wxml ã€wxss ã€jsonç»„æˆ<br><img src="https://www.processon.com/chart_image/586b966fe4b0f7a9c36147c9.png" alt=""></li>
</ol>
<h3 id="Serviceï¼ˆé€»è¾‘å±‚ï¼‰">Serviceï¼ˆé€»è¾‘å±‚ï¼‰</h3><p>ç”±JavaScriptç¼–å†™</p>
<ol>
<li>å¢åŠ äº†ç¨‹åºå’Œé¡µé¢çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•</li>
<li>æ¯ä¸ªé¡µé¢æœ‰ç‹¬ç«‹ä½œç”¨åŸŸå’Œæ¨¡å—åŒ–èƒ½åŠ›</li>
<li>ä¸°å¯Œçš„APIï¼Œè°ƒèµ·å¾®ä¿¡ç‰¹æœ‰åŠŸèƒ½ï¼Œå¦‚æ‰«ä¸€æ‰«ã€æ”¯ä»˜ã€å¾®ä¿¡ç”¨æˆ·æ•°æ®ç­‰</li>
<li>è„±ç¦»DOMï¼Œæ•°æ®é©±åŠ¨ï¼Œéæµè§ˆå™¨ç¯å¢ƒï¼Œä¸èƒ½BOMæ“ä½œï¼Œæ¯”å¦‚documentã€windowç­‰ </li>
<li>ä»£ç è¢«æ‰“åŒ…æˆä¸€ä»½JavaScriptï¼Œå¯åŠ¨æ—¶è¿è¡Œï¼Œç»“æŸæ—¶é”€æ¯</li>
</ol>
<h4 id="ç¨‹åºç”Ÿå‘½å‘¨æœŸ">ç¨‹åºç”Ÿå‘½å‘¨æœŸ</h4><p><img src="https://www.processon.com/chart_image/586b567fe4b067ce852dd284.png" alt=""></p>
<h4 id="é¡µé¢ç”Ÿå‘½å‘¨æœŸ">é¡µé¢ç”Ÿå‘½å‘¨æœŸ</h4><p><img src="https://www.processon.com/chart_image/586b5637e4b0f7a9c35b1095.png" alt=""></p>
<h4 id="ä½œç”¨åŸŸ_&amp;_æ¨¡å—åŒ–">ä½œç”¨åŸŸ &amp; æ¨¡å—åŒ–</h4><ul>
<li>åœ¨JavaScriptæ–‡ä»¶ä¸­å£°æ˜çš„å˜é‡å’Œå‡½æ•°åªåœ¨è¯¥æ–‡ä»¶ä¸­æœ‰æ•ˆï¼Œä¸åŒçš„æ–‡ä»¶å¯å£°æ˜ç›¸åŒåå­—çš„å˜é‡å’Œå‡½æ•°</li>
<li>å…¬å…±ä»£ç æŠ½ç¦»ä¸ºä¸€ä¸ªå•ç‹¬çš„jsæ–‡ä»¶ï¼Œä½œä¸ºä¸€ä¸ªæ¨¡å—ï¼Œå¯ç”¨module.exports æˆ–exportså¯¹å¤–æš´éœ²</li>
</ul>
<h4 id="API">API</h4><p><img src="http://ww3.sinaimg.cn/large/006y8lVagw1fbdx0k511kj31kw1t11kx.jpg" alt=""></p>
<h3 id="Viewï¼ˆè§†å›¾å±‚ï¼‰">Viewï¼ˆè§†å›¾å±‚ï¼‰</h3><p>ç”±WXMLå’ŒWXSSç¼–å†™ï¼Œç”±Componentå±•ç¤º</p>
<ol>
<li>Serviceçš„æ•°æ®è½¬æˆViewï¼ŒViewçš„äº‹ä»¶å‘é€ç»™Service</li>
<li>WXMLæè¿°é¡µé¢ç»“æ„</li>
<li>WXSSæè¿°é¡µé¢æ ·å¼</li>
<li>Componentæ˜¯Viewçš„åŸºæœ¬å•å…ƒ</li>
</ol>
<h4 id="WXML">WXML</h4><p><img src="https://www.processon.com/chart_image/586b9795e4b0f7a9c3615a90.png" alt=""></p>
<h4 id="WXSS">WXSS</h4><p>ä¸CSSç±»æ¯”æ‰©å±•äº†ä¸¤ä¸ªç‰¹æ€§ï¼š</p>
<ol>
<li>å°ºå¯¸å•ä½<ul>
<li>rpxï¼ˆresponsive pixelï¼‰: å¯ä»¥æ ¹æ®å±å¹•å®½åº¦è¿›è¡Œè‡ªé€‚åº”</li>
</ul>
</li>
<li>æ ·å¼å¯¼å…¥ <ul>
<li>ä½¿ç”¨@importè¯­å¥å¯ä»¥å¯¼å…¥å¤–è”æ ·å¼è¡¨</li>
</ul>
</li>
</ol>
<h4 id="ç»„ä»¶">ç»„ä»¶</h4><p><img src="http://ww4.sinaimg.cn/large/006y8lVagw1fbdwasv58wj31kw0nl48p.jpg" alt=""></p>
<h2 id="å·¥ä½œæµ">å·¥ä½œæµ</h2><p>ä¸€ä¸ªPageå®ä¾‹å®Œæ•´çš„å·¥ä½œæµå¦‚ä¸‹<br><img src="https://www.processon.com/chart_image/586b6558e4b0dc8df7a8ef42.png" alt=""></p>
<h2 id="å°ç¨‹åº_VS_Weex_VS_ReactNative">å°ç¨‹åº VS Weex VS ReactNative</h2><p>å› ä¸ºWeexå’ŒReactNativeçš„æ ¸å¿ƒç†å¿µæ²¡ä»€ä¹ˆå·®å¼‚ï¼Œè€ŒWeexè§£å†³äº†å¤§éƒ¨åˆ†ReactNativeçš„ç—›ç‚¹ï¼Œå¹¶ä¸”Weexå¼•å…¥çš„Vueå’Œå°ç¨‹åºçš„MINAæ¡†æ¶ç±»ä¼¼ï¼Œæ€§èƒ½å’Œå¼€å‘æˆæœ¬ä¸Šéƒ½å æ®ä¼˜åŠ¿ï¼Œå¦‚æœæƒ³è¦è¯¦ç»†äº†è§£Weexå’ŒReactNativeä¹‹é—´å¯¹æ¯”çš„å¯ä»¥ç¿»çœ‹æˆ‘çš„<a href="http://yolynn.com/2016/11/11/RN&amp;Weex/">è¿™ç¯‡æ–‡ç« </a>ï¼Œä¸‹é¢å°†ä¸»è¦ä¸ºå°ç¨‹åºå’ŒWeexä¹‹é—´çš„å¯¹æ¯”</p>
<h4 id="äº§å“å½¢æ€çš„å¼‚åŒ">äº§å“å½¢æ€çš„å¼‚åŒ</h4><ol>
<li>å°ç¨‹åºæ—¨åœ¨å®ç°å…¬ä¼—å·çš„å¦ä¸€ç§å½¢æ€ï¼Œè€ŒWeexæ—¨åœ¨å®ç°Nativeç”Ÿæ€çš„æ‰€æœ‰åŠŸèƒ½</li>
<li>å°ç¨‹åºå®šä½å—é™äºå¾®ä¿¡å¹³å°ï¼Œè€ŒWeexå®šä½ä¸å—é™åˆ¶</li>
<li>å°ç¨‹åºç›®å‰æ— æ³•å–ä»£çœŸæ­£çš„Nativeåº”ç”¨ï¼Œè€ŒWeexæ›´æœ‰å¯èƒ½</li>
<li>å°ç¨‹åºçš„è¿è¡Œä¾èµ–äºå¾®ä¿¡å¹³å°ï¼Œåˆ™å¦‚æœç»™Weexæä¾›ç›¸åº”çš„å¹³å°åŒæ ·å¯ä»¥å®ç°</li>
</ol>
<h4 id="æŠ€æœ¯å®ç°çš„å¼‚åŒ">æŠ€æœ¯å®ç°çš„å¼‚åŒ</h4><ol>
<li>å°ç¨‹åºç›®å‰åŸºäºWebviewæ¸²æŸ“å’Œéƒ¨åˆ†å¾®ä¿¡å¹³å°æä¾›çš„Nativeç»„ä»¶ï¼Œè€ŒWeexåŸºäºJavaScriptCoreè§£æjsbundleç»“åˆFrameworkç”Ÿæˆå¯¹åº”çš„Nativeç»„ä»¶æ¸²æŸ“</li>
<li>å°ç¨‹åºæä¾›äº†å¾®ä¿¡å¼€å‘è€…å·¥å…·ï¼Œè€ŒWeexçš„å¼€å‘ä¸å—IDEé™åˆ¶</li>
<li>å°ç¨‹åºä»£ç å¼€å‘åŸºäºMINAæ¡†æ¶å—å„ç§è§„èŒƒé™åˆ¶ï¼Œè€ŒWeexåŸºäºVueç»„ä»¶ä¸å—é™åˆ¶</li>
<li>å°ç¨‹åºå’ŒWeexéƒ½èƒ½åŸºäºChromeè°ƒè¯•</li>
<li>å°ç¨‹åºæä¾›Nativeç«¯è¿è¡Œçš„è§£å†³æ–¹æ¡ˆï¼Œè€ŒWeexé™¤äº†Nativeè¿˜èƒ½åœ¨æµè§ˆå™¨è¿è¡Œ</li>
</ol>
<h4 id="æ€§èƒ½å¯¹æ¯”">æ€§èƒ½å¯¹æ¯”</h4><p> H5 &lt;= Hybrid &lt;= å¾®ä¿¡å°ç¨‹åº &lt;= ReactNative &lt;= Weex &lt;= Native</p>
<h2 id="å°ç¨‹åº_VS_Google_PWA">å°ç¨‹åº VS Google PWA</h2><h4 id="äº§å“å½¢æ€çš„å¼‚åŒ-1">äº§å“å½¢æ€çš„å¼‚åŒ</h4><ol>
<li>å…è®¸ç”¨æˆ·æŠŠè§‰å¾—æœ‰ç”¨çš„åº”ç”¨ä¿ç•™ä¸‹æ¥ï¼Œè€Œä¸ç”¨å»å•†åº—å®‰è£…</li>
<li>é›¶é˜»åŠ›ã€é›¶å®‰è£…ã€æ˜“äºå…±äº«ä¼ æ’­</li>
<li>ä¸ä¾èµ–ç½‘ç»œï¼Œå¯ç¦»çº¿ä½¿ç”¨</li>
<li>åƒæœ¬åœ°åº”ç”¨ä¸€æ ·äº¤äº’ </li>
<li>å¾—ç›Šäºå¾®ä¿¡å¹³å°Nativeçš„æ”¯æŒï¼Œå°ç¨‹åºæ€§èƒ½æ›´å ä¼˜åŠ¿</li>
<li>å°ç¨‹åºçš„å‘å¸ƒæœ‰å¤§å°é™åˆ¶</li>
<li>å¯¹äºä¸€ä¸ªç®€å•çš„åº”ç”¨ï¼Œå¼€å‘æˆæœ¬ä¸Šå°ç¨‹åºæ›´å ä¼˜åŠ¿ï¼›è€Œç›¸å¯¹å¤æ‚çš„æ¯”å¦‚é‚®ç®±ï¼ŒPWAåˆ™æ›´æœ‰ä¼˜åŠ¿</li>
</ol>
<h4 id="æŠ€æœ¯å®ç°çš„å¼‚åŒ-1">æŠ€æœ¯å®ç°çš„å¼‚åŒ</h4><ol>
<li>å°ç¨‹åºåœ¨ç§»åŠ¨ç«¯çš„è¡¨ç°åŠ›åŸºäºwebviewå’Œéƒ¨åˆ†nativeæ ‡ç­¾(å¾®ä¿¡å¹³å°æ”¯æŒ)</li>
<li>PWAç¦»çº¿ç¼“å­˜æŠ€æœ¯ç”¨åˆ°äº†Service Worker,å®ƒæ˜¯ä¸€ä¸ªæ›´å¼ºå¤§çš„AppCache</li>
<li>PWAæ”¯æŒH5æœ€æ–°æ¨é€é€šçŸ¥çš„æ ‡å‡†</li>
<li>å°ç¨‹åºå¯¹äºå¼€å‘è€…ä¿æŒé»‘ç›’ï¼ŒPWAå¯¹äºå¼€å‘è€…æ˜¯å¼€æºï¼Œæ‰€ä»¥èµ„æºå’Œç»éªŒæ›´å ä¼˜åŠ¿</li>
</ol>
<h2 id="å‘">å‘</h2><h4 id="å¤§å‘">å¤§å‘</h4><p>å—é™äºå°ç¨‹åºçš„è¿è¡Œç¯å¢ƒå¹¶éä¸€ä¸ªæ ‡å‡†çš„æµè§ˆå™¨ç¯å¢ƒï¼Œå¾®ä¿¡å°è£…å·¥ä½œå¹¶ä¸å®Œå–„ï¼Œå¯¼è‡´ä»¥å¾€çš„å¤§é‡å¼€å‘ç»éªŒåœ¨å°ç¨‹åºé‡Œå¹¶ä¸é€‚ç”¨ï¼Œå‡ ä¸ªä¸»è¦çš„é—®é¢˜åœ¨äº</p>
<ol>
<li>æ— æ³•è°ƒç”¨NPMåŒ…<ul>
<li>åŸå› ï¼šå¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸æ”¯æŒCommonJSæ ‡å‡†</li>
</ul>
</li>
<li>æ— æ³•ä½¿ç”¨Babelè½¬ç <ul>
<li>ç»“æœï¼šæ— æ³•ä½¿ç”¨ES6/7çš„ç‰¹æ€§ï¼Œcallbackæ˜¯ä»¶éº»çƒ¦äº‹å„¿</li>
</ul>
</li>
<li>æ— æ³•é‡ç”¨ç»„ä»¶<ul>
<li>ä»…æ”¯æŒè§†å›¾æ¨¡å—çš„é‡ç”¨ï¼Œæ— æ³•æŠ½å–å…¬å…±é€»è¾‘</li>
</ul>
</li>
</ol>
<p>å…¶å®ï¼Œä¸Šé¢çš„å‘ä¹Ÿä¸æ˜¯æ— è§£ï¼Œé€šè¿‡ npm install -g labrador-cli å®‰è£…Labradorå·¥å…·è§£å†³ã€‚</p>
<h4 id="å°å‘">å°å‘</h4><ol>
<li>åŠŸèƒ½å­˜åœ¨ä¸å°‘çš„å±€é™æ€§ï¼Œæ¯”å¦‚å¯¼èˆªæ é¢œè‰²ã€mapç»„ä»¶é—®é¢˜</li>
<li>å¼€å‘è€…å·¥å…·ä¸æ”¯æŒæ–¹å‘é”®ã€ä¿®æ”¹æ ·å¼æ— åªèƒ½æé†’ã€ä¸æ”¯æŒå…¨å±€æœç´¢</li>
<li>wx.requestä¸­method:â€POSTâ€æ¨¡å¼ä¸‹ï¼Œåå°æ”¶åˆ°è¯·æ±‚ä½†æ˜¯data:{}æ•°æ®æ¶ˆå¤±ï¼Œä¼šå‘é€ä¸€ä¸ªç©ºè¯·æ±‚ï¼Œè§£å†³æ–¹æ¡ˆæ˜¯â€Content-Typeâ€è¦ä¿®æ”¹ä¸ºâ€content-typeâ€</li>
</ol>
<h2 id="Q_&amp;_A">Q &amp; A</h2><ol>
<li><p>å°ç¨‹åºä¸ºä»€ä¹ˆæ²¡æœ‰åº”ç”¨å•†åº—ï¼Ÿ</p>
<ul>
<li>ä»ç«äº‰è§’åº¦ï¼Œè‹¹æœçš„APPStoreä½œä¸ºç›´æ¥ç«äº‰å¯¹æ‰‹ï¼Œè¿™æ˜¯ä¸€å¤§é˜»åŠ›</li>
<li>ä»äº§å“è§’åº¦ï¼Œå°ç¨‹åºå®šä½ä¾¿æ˜¯å…¬ä¼—å·çš„å¦ä¸€ç§å½¢æ€</li>
<li>ä»å¼€å‘è§’åº¦ï¼Œä¿ç•™ç”¨æˆ·åŸå§‹ä¹ æƒ¯çš„åŸºç¡€ä¸Šï¼ŒèŠ‚çœäº†å¤§éƒ¨åˆ†çš„å¼€å‘æˆæœ¬</li>
</ul>
</li>
<li><p>å°ç¨‹åºä¸ºä»€ä¹ˆè¦å»ä¸­å¿ƒåŒ–ï¼Ÿ<br><img src="https://www.processon.com/chart_image/586c6203e4b0f7a9c3672eb2.png" alt=""></p>
</li>
<li><p>å°ç¨‹åºèƒ½å¸¦æ¥ä»€ä¹ˆå˜åŒ–ï¼Ÿ</p>
<ul>
<li>è®©å…¬å¸é™ä½å¼€å‘æˆæœ¬ï¼Œä¾¿äºå•†ä¸šæ¨¡å¼è¯•é”™</li>
<li>è®©å¼€å‘è€…æ›´åŠ æ³¨é‡æœåŠ¡çš„ä»·å€¼</li>
<li>è®©ç”¨æˆ·ä½¿ç”¨æ›´åŠ ä¾¿æ·</li>
</ul>
</li>
<li><p>å°ç¨‹åºåœ¨å¾®ä¿¡é‡Œçš„å±•ç°æ¨¡å¼ï¼Ÿ</p>
<ul>
<li>åˆ†äº«çš„æ¶ˆæ¯å¯ä»¥äº’åŠ¨ï¼Œæ¯”å¦‚ï¼šåˆ†äº«åˆ°ç¾¤èŠçš„æŠ•ç¥¨æ¶ˆæ¯ï¼Œå…¶ä»–ç”¨æˆ·ä¸ç”¨æ‰“å¼€æ¶ˆæ¯ï¼Œè€Œæ˜¯ç›´æ¥åœ¨æ¶ˆæ¯ä¸Šè¿›è¡Œäº’åŠ¨æŠ•ç¥¨</li>
<li>å°ç¨‹åºå¯ä»¥æŒ‚èµ·åˆ°èŠå¤©é¡µé¡¶éƒ¨ï¼Œå¦‚ä¸‹å›¾<br><img src="http://ww3.sinaimg.cn/large/006y8lVagw1fbedqngmymj30nk0j2gn1.jpg" alt=""></li>
</ul>
</li>
</ol>
<h2 id="æ€»ç»“">æ€»ç»“</h2><p>ä¸ªäººè®¤ä¸ºReactNativeçš„æ€æƒ³æ˜¯éå¸¸é€‚åˆåº”ç”¨åˆ°å¾®ä¿¡å°ç¨‹åºé‡Œçš„ï¼Œè‡³äºå¾®ä¿¡å°ç¨‹åºä¸ºä»€ä¹ˆé€‰æ‹©æ²¡æœ‰ä½¿ç”¨ï¼Œæˆ‘æƒ³åº”è¯¥æœ‰ä¸¤æ–¹é¢çš„åŸå› ï¼š</p>
<ol>
<li>ä»æŠ€æœ¯è§’åº¦è€ƒè™‘ï¼Œå’ŒReactNativeè‡ªèº«çš„ä¸€äº›ç“¶é¢ˆæœ‰å…³ï¼Œæ¯”å¦‚ç‰ˆæœ¬ä¸ç¨³å®šã€listViewæ€§èƒ½é—®é¢˜ã€çœŸæœºè°ƒè¯•ç¹çç­‰</li>
<li>ä»äº§å“å½¢æ€å®šä½è€ƒè™‘ï¼Œå°ç¨‹åºå‡ºå‘ç‚¹å°±æ˜¯å¾®ä¿¡å…¬ä¼—å·çš„å¦ä¸€ç§å½¢æ€ï¼Œç»“åˆå¾®ä¿¡å¹³å°æä¾›çš„Nativeç»„ä»¶å’Œè¶Šæ¥è¶Šæˆç†Ÿçš„SPAæŠ€æœ¯å°±èƒ½å¸¦ç»™ç”¨æˆ·æ¯”è¾ƒå¥½çš„ä½“éªŒ</li>
</ol>
<p>ç”±æ­¤å¯ä»¥é¢„è§ï¼Œå¦‚æœä¸Šè¿°åŸå› ä¸­æŠ€æœ¯é—®é¢˜å¾—ä»¥è§£å†³ï¼Œé‚£ä¹ˆäº§å“å½¢æ€çš„å®šä½ä¾¿å¯ä»¥å¤§å¤§æ‰©å±•ï¼Œè€ŒWeexåšçš„äº‹æƒ…ä¸­è§£å†³äº†å¤§éƒ¨åˆ†ReactNativeçš„ç“¶é¢ˆé—®é¢˜ï¼Œé‚£ä¹ˆä½¿ç”¨Weexç»“åˆå¾®ä¿¡å°ç¨‹åºçš„æ€æƒ³æ‰€å¾—åˆ°çš„äº§å“å½¢æ€åŠ¿å¿…å¯ä»¥å¤§å¤§çš„æ‰©å±•ã€‚</p>
<h2 id="Demo">Demo</h2><p><a href="https://github.com/yolynn-bird/yo-weapp-demo" target="_blank" rel="external">https://github.com/yolynn-bird/yo-weapp-demo</a></p>

                    
                        
                    
                    
                        <p>
                            <a href="/2014/01/03/weapp/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemType="http://schema.org/BlogPosting">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title" itemprop="headline">
                    
                        <a class="link-unstyled" href="/2013/07/17/tree/">
                            æ•°æ®ç»“æ„ä¹‹å„ç§æ ‘æ˜¯å¦‚ä½•è®©ä½ çº ç»“çš„ï¼Ÿ
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time itemprop="datePublished" datetime="2013-07-17T18:15:02+08:00">
	
		    Jul 17, 2013
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content" itemprop="articleBody">
                    <ol>
<li><p>æ ‘ä¸æ ‘çš„è¡¨ç¤º</p>
<h6 id="ä»€ä¹ˆæ˜¯æ ‘ï¼Ÿ">ä»€ä¹ˆæ˜¯æ ‘ï¼Ÿ</h6><p> å®¢è§‚ä¸–ç•Œä¸­è®¸å¤šäº‹ç‰©å­˜åœ¨å±‚æ¬¡å…³ç³»</p>
<ul>
<li>äººç±»ç¤¾ä¼šå®¶è°±</li>
<li>ç¤¾ä¼šç»„ç»‡ç»“æ„</li>
<li><p>å›¾ä¹¦ä¿¡æ¯ç®¡ç†</p>
<p>åˆ†å±‚æ¬¡ç»„ç»‡åœ¨ç®¡ç†ä¸Šå…·æœ‰æ›´é«˜çš„æ•ˆç‡ï¼</p>
<p>æ•°æ®ç®¡ç†çš„åŸºæœ¬æ“ä½œä¹‹ä¸€ï¼šæŸ¥æ‰¾ï¼ˆæ ¹æ®æŸä¸ªç»™å®šå…³é”®å­—Kï¼Œä»é›†åˆR ä¸­æ‰¾å‡ºå…³é”®å­—ä¸K ç›¸åŒçš„è®°å½•ï¼‰ã€‚ä¸€ä¸ªè‡ªç„¶çš„é—®é¢˜å°±æ˜¯ï¼Œå¦‚ä½•å®ç°æœ‰æ•ˆç‡çš„æŸ¥æ‰¾ï¼Ÿ</p>
</li>
<li><p>é™æ€æŸ¥æ‰¾ï¼šé›†åˆä¸­è®°å½•æ˜¯å›ºå®šçš„ï¼Œæ²¡æœ‰æ’å…¥å’Œåˆ é™¤æ“ä½œï¼Œåªæœ‰æŸ¥æ‰¾</p>
</li>
<li><p>åŠ¨æ€æŸ¥æ‰¾ï¼šé›†åˆä¸­è®°å½•æ˜¯åŠ¨æ€å˜åŒ–çš„ï¼Œé™¤æŸ¥æ‰¾ï¼Œè¿˜å¯èƒ½å‘ç”Ÿæ’å…¥å’Œåˆ é™¤</p>
<p>é™æ€æŸ¥æ‰¾â€”â€”æ–¹æ³•ä¸€ï¼šé¡ºåºæŸ¥æ‰¾ï¼ˆæ—¶é—´å¤æ‚åº¦O(n)ï¼‰</p>
</li>
</ul>
</li>
</ol>
<pre><code><span class="comment"><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">SequentialSearch</span><span class="params">(StaticTable * Tbl, ElementType K)</span>   </span><br><span class="line"></span>&#123;   </span><br><span class="line">    <span class="comment">// åœ¨è¡¨Tbl[1]~Tbl[n] ä¸­æŸ¥æ‰¾å…³é”®å­—ä¸ºKçš„æ•°æ®å…ƒç´    </span></span><br><span class="line">    <span class="keyword">int</span> i;   </span><br><span class="line">    Tabl-&gt;Element[<span class="number">0</span>] = K; <span class="comment">// å»ºç«‹å“¨å…µ   </span></span><br><span class="line">    <span class="keyword">for</span>(i = Tbl-&gt;Length; Tbl-&gt;Element[i] != K; i--)   </span><br><span class="line">        ;   </span><br><span class="line">    <span class="keyword">return</span> i; <span class="comment">// æŸ¥æ‰¾æˆåŠŸè¿”å›æ‰€åœ¨å•å…ƒä¸‹æ ‡ï¼›ä¸æˆåŠŸè¿”å›0   &#125;</span></span><br></pre></td></tr></table></figure></span>



é™æ€æŸ¥æ‰¾â€”â€”æ–¹æ³•äºŒï¼šäºŒåˆ†æŸ¥æ‰¾ï¼ˆæ—¶é—´å¤æ‚åº¦O(logn)ï¼‰

äºŒåˆ†æŸ¥æ‰¾çš„å¯ç¤ºï¼Ÿ

* äºŒåˆ†æŸ¥æ‰¾åˆ¤å®šæ ‘ï¼š
* åˆ¤å®šæ ‘ä¸Šæ¯ä¸ªç»“ç‚¹éœ€è¦çš„æŸ¥æ‰¾æ¬¡æ•°åˆšå¥½ä¸ºè¯¥ç»“ç‚¹æ‰€åœ¨çš„å±‚æ•°
 * æŸ¥æ‰¾æˆåŠŸæ—¶æŸ¥æ‰¾æ¬¡æ•°ä¸ä¼šè¶…è¿‡åˆ¤å®šæ ‘çš„æ·±åº¦
* n ä¸ªç»“ç‚¹çš„åˆ¤å®šæ ‘çš„æ·±åº¦ä¸ºâŒŠlog2nâŒ‹+1

###### æ ‘çš„å®šä¹‰

æ ‘ï¼ˆTreeï¼‰ï¼šnï¼ˆn â‰¥ 0ï¼‰ä¸ªç»“ç‚¹æ„æˆçš„æœ‰é™é›†åˆã€‚

* å½“n = 0 æ—¶ï¼Œç§°ä¸ºç©ºæ ‘ã€‚
* å¯¹äºä»»ä¸€é¢—éç©ºæ ‘ï¼ˆn &gt; 0ï¼‰ï¼Œå®ƒå…·å¤‡ä»¥ä¸‹æ€§è´¨ï¼š
* æ ‘ä¸­æœ‰ä¸€ä¸ªç§°ä¸º"æ ¹ï¼ˆRootï¼‰"çš„ç‰¹æ®Šç»“ç‚¹ï¼Œç”¨r è¡¨ç¤ºï¼›
* å…¶ä½™ç»“ç‚¹ï¼ˆä¸r ç›¸å…³è”çš„ï¼‰å¯åˆ†ä¸ºmï¼ˆm  &gt; 0ï¼‰ä¸ªäº’ä¸ç›¸äº¤çš„æœ‰é™é›†T1ï¼ŒT2ï¼Œ...ï¼ŒTmï¼Œå…¶ä¸­æ¯ä¸ªé›†åˆæœ¬èº«åˆæ˜¯ä¸€é¢—æ ‘ï¼Œç§°ä¸ºåŸæ¥æ ‘çš„"å­æ ‘ï¼ˆSubTreeï¼‰"ã€‚

###### æ ‘ä¸éæ ‘ï¼Ÿ

* å­æ ‘æ˜¯ä¸ç›¸äº¤çš„
* é™¤äº†æ ¹ç»“ç‚¹å¤–ï¼Œæ¯ä¸ªç»“ç‚¹æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªçˆ¶èŠ‚ç‚¹
* ä¸€é¢—Nä¸ªç»“ç‚¹çš„æ ‘æœ‰N-1æ¡è¾¹ï¼ˆæˆ‘è®¤ä¸ºå¯ä»¥ç”¨æ„é€ æ€§çš„å­˜åœ¨æ€§è¯æ˜æˆ–æ˜¯æ•°å­¦å½’çº³æ³•æ¥è¯æ˜è¿™ä¸€ç‚¹ï¼‰

###### æ ‘çš„ä¸€äº›åŸºæœ¬æœ¯è¯­ï¼š

* ç»“ç‚¹çš„åº¦ï¼ˆDegreeï¼‰ï¼šç»“ç‚¹çš„å­æ ‘ä¸ªæ•°
* æ ‘çš„åº¦ï¼šæ ‘çš„æ‰€æœ‰ç»“ç‚¹ä¸­æœ€å¤§çš„åº¦æ•°
* å¶ç»“ç‚¹ï¼ˆLeafï¼‰ï¼šåº¦ä¸º0çš„ç»“ç‚¹
* çˆ¶ç»“ç‚¹ï¼ˆParentï¼‰ï¼šæœ‰å­æ ‘çš„ç»“ç‚¹æ˜¯å…¶å­æ ‘çš„æ ¹ç»“ç‚¹çš„çˆ¶ç»“ç‚¹
* å­ç»“ç‚¹ï¼ˆChildï¼‰ï¼šè‹¥Aç»“ç‚¹æ˜¯Bç»“ç‚¹çš„çˆ¶ç»“ç‚¹ï¼Œåˆ™ç§°Bç»“ç‚¹æ˜¯Aç»“ç‚¹çš„å­ç»“ç‚¹ï¼›å­ç»“ç‚¹ä¹Ÿç§°å­©å­ç»“ç‚¹
* å…„å¼Ÿç»“ç‚¹ï¼ˆSiblingï¼‰ï¼šå…·æœ‰åŒä¸€çˆ¶ç»“ç‚¹çš„å„ç»“ç‚¹å½¼æ­¤æ˜¯å…„å¼Ÿç»“ç‚¹
* è·¯å¾„å’Œè·¯å¾„é•¿åº¦ï¼šä»ç»“ç‚¹n1åˆ°nkçš„è·¯å¾„ä¸ºä¸€ä¸ªç»“ç‚¹åºåˆ—n1ï¼Œn2ï¼Œ...ï¼Œnkï¼Œniæ˜¯ni+1çš„çˆ¶ç»“ç‚¹ï¼Œè·¯å¾„æ‰€åŒ…å«çš„è¾¹çš„ä¸ªæ•°ä¸ºè·¯å¾„çš„é•¿åº¦
* ç¥–å…ˆç»“ç‚¹ï¼ˆAncestorï¼‰ï¼šæ²¿æ ‘æ ¹åˆ°æŸä¸€ç»“ç‚¹è·¯å¾„ä¸Šçš„æ‰€æœ‰ç»“ç‚¹éƒ½æ˜¯è¿™ä¸ªç»“ç‚¹çš„ç¥–å…ˆç»“ç‚¹
* å­å­™ç»“ç‚¹ï¼ˆDescendantï¼‰ï¼šæŸä¸€ç»“ç‚¹çš„å­æ ‘ä¸­çš„æ‰€æœ‰ç»“ç‚¹éƒ½æ˜¯è¿™ä¸ªç»“ç‚¹å­å­™
* ç»“ç‚¹çš„å±‚æ¬¡ï¼ˆLevelï¼‰ï¼šè§„å®šæ ¹ç»“ç‚¹åœ¨1å±‚ï¼Œå…¶å®ƒä»»ä¸€ç»“ç‚¹çš„å±‚æ•°æ—¶å…¶çˆ¶èŠ‚ç‚¹çš„å±‚æ•°åŠ 1
* æ ‘çš„æ·±åº¦ï¼ˆDepthï¼‰ï¼šæ ‘ä¸­æ‰€æœ‰ç»“ç‚¹ä¸­çš„æœ€å¤§å±‚æ¬¡æ˜¯è¿™æ£µæ ‘çš„æ·±åº¦

###### æ ‘çš„è¡¨ç¤º

ä¸ºå¯èŠ‚çœç©ºé—´ï¼Œæœ€å¸¸ç”¨çš„è¡¨ç¤ºæ ‘çš„æ–¹æ³•æ˜¯å„¿å­-å…„å¼Ÿè¡¨ç¤ºæ³•ã€‚

### 2. äºŒå‰æ ‘åŠå­˜å‚¨ç»“æ„

###### äºŒå‰æ ‘çš„å®šä¹‰

äºŒå‰æ ‘Tï¼šä¸€ä¸ªæœ‰ç©·çš„ç»“ç‚¹é›†åˆ

* è¿™ä¸ªé›†åˆå¯ä»¥ä¸ºç©º
* è‹¥ä¸ä¸ºç©ºï¼Œåˆ™å®ƒæ˜¯ç”±æ ¹ç»“ç‚¹å’Œç§°ä¸ºå…¶å·¦å­æ ‘TLå’Œå³å­æ ‘TRçš„ä¸¤ä¸ªä¸ç›¸äº¤çš„    

äºŒå‰æ ‘ç»„æˆ

* äºŒå‰æ ‘å…·æœ‰äº”ç§åŸºæœ¬å½¢æ€ï¼ˆç©ºã€å•æ ¹ã€æ ¹+TLã€æ ¹+TRã€æ ¹+TL+TRï¼‰
* äºŒå‰æ ‘çš„å­æ ‘æœ‰å·¦å³é¡ºåºä¹‹åˆ†

###### ç‰¹æ®ŠäºŒå‰æ ‘

æ–œäºŒå‰æ ‘ï¼ˆSkewed Binary Treeï¼‰ã€å®Œç¾äºŒå‰æ ‘ï¼ˆPerfect Binary Treeï¼‰/æ»¡äºŒå‰æ ‘ï¼ˆFull Binary Treeï¼‰ã€å®Œå…¨äºŒå‰æ ‘ï¼ˆComplete Binary Treeï¼‰

è¿™é‡Œé‡ç‚¹ä»‹ç»ä¸‹CBTï¼šæœ‰n ä¸ªç»“ç‚¹çš„äºŒå‰æ ‘ï¼Œå¯¹æ ‘ä¸­ç»“ç‚¹æŒ‰ä»ä¸Šè‡³ä¸‹ã€ä»å·¦è‡³å³é¡ºåºè¿›è¡Œç¼–å·ï¼Œç¼–å·ä¸ºi ï¼ˆ1 â‰¤ i â‰¤ nï¼‰ç»“ç‚¹ä¸æ»¡äºŒå‰æ ‘ä¸­ç¼–å·ä¸ºi ç»“ç‚¹åœ¨äºŒå‰æ ‘ä¸­ä½ç½®ç›¸åŒ

###### äºŒå‰æ ‘å‡ ä¸ªé‡è¦æ€§è´¨

* ä¸€ä¸ªäºŒå‰æ ‘ç¬¬i å±‚çš„æœ€å¤§ç»“ç‚¹æ•°ä¸ºï¼š2i-1ï¼Œi â‰¥ 1
* æ·±åº¦ä¸ºk çš„äºŒå‰æ ‘æœ‰æœ€å¤§ç»“ç‚¹æ€»æ•°ä¸ºï¼š2k-1ï¼Œk â‰¥ 1
* å¯¹ä»»ä½•éç©ºäºŒå‰æ ‘Tï¼Œè‹¥n0 è¡¨ç¤ºå¶ç»“ç‚¹çš„ä¸ªæ•°ï¼Œn2 æ˜¯åº¦ä¸º2 çš„éå¶ç»“ç‚¹ä¸ªæ•°ï¼Œé‚£ä¹ˆä¸¤è€…æ»¡è¶³å…³ç³»n0 = n2 + 1ï¼ˆè¯æ˜è§è¿™é‡Œï¼‰

###### äºŒå‰æ ‘çš„æŠ½è±¡æ•°æ®ç±»å‹

é‡è¦æ“ä½œï¼š

* BinTree CreateBinTree()ï¼šåˆ›å»ºä¸€ä¸ªäºŒå‰æ ‘
* Boolean IsEmpty(BinTree BT)ï¼šåˆ¤åˆ«BT æ˜¯å¦ä¸ºç©º
* void Traversal(BinTree BT)ï¼šéå†ï¼ŒæŒ‰æŸé¡ºåºè®¿é—®æ¯ä¸ªç»“ç‚¹

å¸¸ç”¨çš„éå†æ–¹æ³•æœ‰ï¼š

* void PreOrderTraversal(BinTree BT)ï¼šå…ˆåºâ€”â€”æ ¹ã€å·¦å­æ ‘ã€å³å­æ ‘
* void InOrderTraversal(BinTree BT)ï¼šä¸­åºâ€”â€”å·¦å­æ ‘ã€æ ¹ã€å³å­æ ‘
* void PostOrderTraversal(BinTree BT)ï¼šååºâ€”â€”å·¦å­æ ‘ã€å³å­æ ‘ã€æ ¹
* void LevelOrderTraversal(BinTree BT)ï¼šå±‚æ¬¡éå†â€”â€”ä»ä¸Šåˆ°ä¸‹ã€ä»å·¦åˆ°å³

###### äºŒå‰æ ‘çš„å­˜å‚¨ç»“æ„

é¡ºåºå­˜å‚¨ç»“æ„

* ä¾å®Œå…¨äºŒå‰æ ‘çš„å½¢å¼å­˜å‚¨ï¼šæŒ‰ä»ä¸Šåˆ°ä¸‹ã€ä»å·¦åˆ°å³é¡ºåºå­˜å‚¨ã€‚
* n ä¸ªç»“ç‚¹çš„å®Œå…¨äºŒå‰æ ‘çš„èŠ‚ç‚¹çˆ¶å­å…³ç³»ï¼š
* éæ ¹èŠ‚ç‚¹ï¼ˆåºå·i &gt; 1ï¼‰çš„çˆ¶ç»“ç‚¹åºå·æ˜¯âŒŠi/2âŒ‹
* ç»“ç‚¹ï¼ˆåºå·ä¸ºiï¼‰çš„å·¦å­©å­ç»“ç‚¹çš„åºå·æ˜¯2iï¼ˆè‹¥2i â‰¤ nï¼Œå¦åˆ™æ²¡æœ‰å·¦å­©å­ï¼‰
* ç»“ç‚¹ï¼ˆåºå·ä¸ºiï¼‰çš„å³å­©å­ç»“ç‚¹çš„åºå·æ˜¯2i+1ï¼ˆè‹¥ 2i+1 â‰¤ nï¼Œå¦åˆ™æ²¡æœ‰å³å­©å­ï¼‰

åº”å½“æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼šä¸€èˆ¬äºŒå‰æ ‘ä¹Ÿå¯ä»¥é‡‡ç”¨è¿™ç§ç»“æ„ï¼Œä½†ä¼šé€ æˆç©ºé—´æµªè´¹

é“¾è¡¨å­˜å‚¨

<span class="comment"><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> TreeNode *BinTree;   </span><br><span class="line"><span class="keyword">typedef</span> BinTree Position;   </span><br><span class="line"><span class="keyword">struct</span> TreeNode&#123;   </span><br><span class="line">    ElementType Data;   </span><br><span class="line">    BinTree Left;   </span><br><span class="line">    BinTree Right;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></span>

### 3. äºŒå‰æ ‘çš„éå†

###### äºŒå‰æ ‘çš„é€’å½’éå†

å…ˆåºéå†ï¼šè®¿é—®æ ¹ç»“ç‚¹ï¼›å…ˆåºéå†å…¶å·¦å­æ ‘ï¼›å…ˆåºéå†å…¶å³å­æ ‘

<span class="comment"><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">oid <span class="title">PreOrderTraversal</span><span class="params">(BinTree BT)</span>   </span><br><span class="line"></span>&#123;   </span><br><span class="line">    <span class="keyword">if</span>(BT)   </span><br><span class="line">    &#123;   </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d"</span>, BT-&gt;data);   </span><br><span class="line">        PreOrderTraversal(BT-&gt;Left);   </span><br><span class="line">        PreOrderTraversal(BT-&gt;Right);   </span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></span>

ä¸­åºéå†ï¼šä¸­åºéå†å…¶å·¦å­æ ‘ï¼›è®¿é—®æ ¹ç»“ç‚¹ï¼›ä¸­åºéå†å…¶å³å­æ ‘

<span class="comment"><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InOrderTraversal</span><span class="params">(BinTree BT)</span>   </span><br><span class="line"></span>&#123;   </span><br><span class="line">    <span class="keyword">if</span>(BT)   </span><br><span class="line">    &#123;   </span><br><span class="line">        InOrderTraversal(BT-&gt;Left);   </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d"</span>, BT-&gt;Data);   </span><br><span class="line">        InOrderTraversal(BT-&gt;Right);   </span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></span>

ååºéå†ï¼šåç»­éå†å…¶å·¦å­æ ‘ï¼›åç»­éå†å…¶å³å­æ ‘ï¼›è®¿é—®æ ¹ç»“ç‚¹

<span class="comment"><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PostOrderTraversal</span><span class="params">(BinTree BT)</span>   </span><br><span class="line"></span>&#123;   </span><br><span class="line">    <span class="keyword">if</span>(BT)   </span><br><span class="line">    &#123;   </span><br><span class="line">        PostOrderTraversal(BT-&gt;Left);   </span><br><span class="line">        PostOrderTraversal(BT-&gt;Right);   </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d"</span>, BT-&gt;Data);   </span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></span>

é™„æ³¨ï¼šå…ˆåºã€ä¸­åºå’Œååºéå†è¿‡ç¨‹ï¼šéå†è¿‡ç¨‹ç»è¿‡ç»“ç‚¹çš„è·¯çº¿ä¸€æ ·ï¼Œåªæ˜¯è®¿é—®å„ç»“ç‚¹çš„æ—¶æœºä¸åŒã€‚ä¸‹å›¾åœ¨ä»å…¥å£åˆ°å‡ºå£çš„æ›²çº¿ä¸Šç”¨â“§ã€â˜…å’Œâ–³ä¸‰ç§ç¬¦å·åˆ†åˆ«æ ‡è®°å‡ºäº†å…ˆåºã€ä¸­åºå’Œååºè®¿é—®å„ç»“ç‚¹çš„æ—¶åˆ»



å…ˆåºï¼šå½“æ›²çº¿ç¬¬ä¸€æ¬¡ç»è¿‡ä¸€ä¸ªç»“ç‚¹æ—¶ï¼Œå°±åˆ—å‡ºè¿™ä¸ªç»“ç‚¹ï¼›ä¸­åºï¼šå½“æ›²çº¿ç¬¬ä¸€æ¬¡ç»è¿‡ä¸€ä¸ªæ ‘å¶æ—¶ï¼Œå°±åˆ—å‡ºè¿™ä¸ªæ ‘å¶ï¼Œå½“æ›²çº¿ç¬¬äºŒæ¬¡ç»è¿‡ä¸€ä¸ªå†…ç‚¹æ—¶å°±åˆ—å‡ºè¿™ä¸ªå†…ç‚¹ï¼›ååºï¼šå½“æ›²çº¿æœ€åä¸€æ¬¡ç»è¿‡ä¸€ä¸ªç»“ç‚¹è€Œè¿”å›è¿™ä¸ªç»“ç‚¹çš„çˆ¶äº²æ—¶ï¼Œå°±åˆ—å‡ºè¿™ä¸ªç»“ç‚¹ã€‚

###### äºŒå‰æ ‘çš„éé€’å½’éå†

éé€’å½’éå†ç®—æ³•å®ç°çš„åŸºæœ¬æ€è·¯ï¼šä½¿ç”¨å †æ ˆã€‚æˆ‘ä»¬ä»¥ä¸­åºéå†çš„éé€’å½’ç®—æ³•ä¸ºä¾‹ï¼š

* é‡åˆ°ä¸€ä¸ªç»“ç‚¹ï¼Œå°±æŠŠå®ƒå‹æ ˆï¼Œå¹¶å»éå†å®ƒçš„å·¦å­æ ‘
* å½“å·¦å­æ ‘éå†ç»“æŸåï¼Œä»æ ˆé¡¶å¼¹å‡ºè¿™ä¸ªç»“ç‚¹å¹¶è®¿é—®å®ƒ
* ç„¶åæŒ‰å…¶å³æŒ‡é’ˆå†å»ä¸­åºéå†è¯¥ç»“ç‚¹çš„å³å­æ ‘

<span class="comment"><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InOrderTraversal</span><span class="params">(BinTree BT)</span>   </span><br><span class="line"></span>&#123;   </span><br><span class="line">    BinTree T = BT;   </span><br><span class="line">    Stack S = CreateStack(MaxSize); <span class="comment">// åˆ›å»ºå¹¶åˆå§‹åŒ–å †æ ˆ   </span></span><br><span class="line">    <span class="keyword">while</span>(T || !IsEmpty(S))   </span><br><span class="line">    &#123;   </span><br><span class="line">        <span class="keyword">while</span>(T) <span class="comment">// ä¸€ç›´å‘å·¦å¹¶å°†æ²¿é€”ç»“ç‚¹å‹å…¥å †æ ˆ   </span></span><br><span class="line">        &#123;   </span><br><span class="line">            Push(S, T);   </span><br><span class="line">            T = T-&gt;Left;   </span><br><span class="line">        &#125;   </span><br><span class="line">        <span class="keyword">if</span>(!IsEmpty(S)) <span class="comment">// ä¸æ˜¯å¿…é¡»çš„ï¼Œå› ä¸ºwhileå…¥å£å¤„å·²ç»åˆ¤æ–­è¿‡äº†   </span></span><br><span class="line">        &#123;   </span><br><span class="line">            T = Pop(S); <span class="comment">// ç»“ç‚¹å¼¹å‡ºå †æ ˆ   </span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%5d"</span>, T-&gt;Data); <span class="comment">// (è®¿é—®)æ‰“å°ç»“ç‚¹   </span></span><br><span class="line">            T = T-&gt;Right; <span class="comment">// è½¬å‘å³å­æ ‘   </span></span><br><span class="line">        &#125;   </span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></span>

æ³¨æ„åˆ°å…ˆåºçš„éé€’å½’ç®—æ³•åªè¦åœ¨ä¸­åºéé€’å½’ç®—æ³•çš„åŸºç¡€ä¸Šåšä¸€ä¸‹è°ƒæ•´å°±å¥½äº†ï¼šprintfè¯­å¥æ”¾åˆ°Pushæ“ä½œä¹‹å‰ã€‚è€Œåç»­éå†å°±æ¯”è¾ƒç¹çäº†ï¼Œå› ä¸ºå½“æŒ‡é’ˆTæŒ‡å‘ä¸€ä¸ªç»“ç‚¹æ—¶ï¼Œä¸èƒ½é©¬ä¸Šå¯¹å®ƒè¿›è¡Œè®¿é—®ï¼Œè€Œè¦å…ˆéå†å®ƒçš„å·¦å­æ ‘ï¼Œå› è€Œè¦å°†æ­¤ç»“ç‚¹çš„åœ°å€è¿›æ ˆä¿å­˜ã€‚å½“å…¶å·¦å­æ ‘éå†å®Œæ¯•ä¹‹åï¼Œå†æ¬¡æœç´¢åˆ°è¯¥ç»“ç‚¹æ—¶ï¼ˆé€€æ ˆï¼‰ï¼Œè¿˜ä¸èƒ½å¯¹å®ƒè®¿é—®ï¼Œè¿˜éœ€è¦éå†å®ƒçš„å³å­æ ‘ï¼Œæ‰€ä»¥ï¼Œå†ä¸€æ¬¡å°†æ­¤ç»“ç‚¹çš„åœ°å€è¿›æ ˆä¿å­˜ã€‚ä¸ºäº†åŒºåˆ«åŒä¸€ç»“ç‚¹çš„ä¸¤æ¬¡è¿›æ ˆï¼Œéœ€è¦å¼•å…¥ä¸€ä¸ªæ ‡å¿—å˜é‡ï¼Œæ¯”å¦‚flagä¸º0è¡¨ç¤ºè¯¥ç»“ç‚¹æš‚ä¸è®¿é—®ï¼Œä¸º1è¡¨ç¤ºè¯¥ç»“ç‚¹å¯ä»¥è®¿é—®ã€‚

###### å±‚åºéå†

å±‚åºéå†åŸºæœ¬è¿‡ç¨‹ï¼šå…ˆæ ¹ç»“ç‚¹å…¥é˜Ÿï¼Œç„¶åï¼š

* ä»é˜Ÿåˆ—ä¸­å–å‡ºä¸€ä¸ªå…ƒç´ 
* è®¿é—®è¯¥å…ƒç´ æ‰€æŒ‡ç»“ç‚¹
* è‹¥è¯¥ç»“ç‚¹æ‰€æŒ‡ç»“ç‚¹çš„å·¦ã€å³å­©å­ç»“ç‚¹éç©ºï¼Œåˆ™å°†å…¶å·¦ã€å³å­©å­çš„æŒ‡é’ˆé¡ºåºå…¥é˜Ÿ

<span class="comment"><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">LevelOrderTraversal</span><span class="params">(BinTree BT)</span>   </span><br><span class="line"></span>&#123;   </span><br><span class="line">    Queue Q;   </span><br><span class="line">    BinTree T;   </span><br><span class="line">    <span class="keyword">if</span>(!BT) <span class="comment">// è‹¥æ˜¯ç©ºæ ‘ç›´æ¥è¿”å›   </span></span><br><span class="line">        <span class="keyword">return</span>;   </span><br><span class="line">    Q = CreateQueue(MaxSize); <span class="comment">// åˆ›å»ºå¹¶åˆå§‹åŒ–é˜Ÿåˆ—Q   </span></span><br><span class="line">    AddQ(Q, BT);   </span><br><span class="line">    <span class="keyword">while</span>(!IsEmpty(Q))   </span><br><span class="line">    &#123;   </span><br><span class="line">        T = Delete(Q);   </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, T-&gt;Data); <span class="comment">// è®¿é—®å–å‡ºé˜Ÿåˆ—çš„ç»“ç‚¹   </span></span><br><span class="line">        <span class="keyword">if</span>(T-&gt;Left)   </span><br><span class="line">            AddQ(Q, T-&gt;Left);   </span><br><span class="line">        <span class="keyword">if</span>(T-&gt;Right)   </span><br><span class="line">            AddQ(Q, T-&gt;Right);   </span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></span>

###### éå†äºŒå‰æ ‘çš„åº”ç”¨

è¾“å‡ºäºŒå‰æ ‘ä¸­çš„å¶å­ç»“ç‚¹

åœ¨äºŒå‰æ ‘çš„éå†ç®—æ³•ä¸­å¢åŠ æ£€æµ‹ç»“ç‚¹çš„"å·¦å³å­æ ‘æ˜¯å¦éƒ½ä¸ºç©º"

<span class="comment"><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PreOrderPrintLeaves</span><span class="params">(BinTree BT)</span>   </span><br><span class="line"></span>&#123;   </span><br><span class="line">    <span class="keyword">if</span>(BT)   </span><br><span class="line">    &#123;   </span><br><span class="line">        <span class="keyword">if</span>(!BT-&gt;Left &amp;&amp; !BT-&gt;Right)   </span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d"</span>, BT-&gt;Data);   </span><br><span class="line">        PerOrderPrintLeaves(BT-&gt;Left);   </span><br><span class="line">        PerOrderPrintLeaves(BT-&gt;Right);   </span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></span>

###### æ±‚äºŒå‰æ ‘çš„é«˜åº¦

éœ€è¦æ³¨æ„åˆ°Height = Max(HL, HR) + 1

<span class="comment"><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">PostOrderGetHeight</span><span class="params">(BinTree BT)</span>   </span><br><span class="line"></span>&#123;   </span><br><span class="line">    <span class="keyword">int</span> HL, HR, MaxH;   </span><br><span class="line">    <span class="keyword">if</span>(BT)   </span><br><span class="line">    &#123;   </span><br><span class="line">        HL = PostOrderGetHeight(BT-&gt;Left); <span class="comment">// æ±‚å·¦å­æ ‘çš„æ·±åº¦   </span></span><br><span class="line">        HR = PostOrderGetHeight(BT-&gt;Right); <span class="comment">// æ±‚å³å­æ ‘çš„æ·±åº¦   </span></span><br><span class="line">        MaxH = (HL &gt; HR) ? HL : HR; <span class="comment">// å–å·¦å³å­æ ‘ä¸­è¾ƒå¤§çš„æ·±åº¦   </span></span><br><span class="line">        <span class="keyword">return</span> MaxH + <span class="number">1</span>; <span class="comment">// è¿”å›æ ‘çš„æ·±åº¦   </span></span><br><span class="line">    &#125;   </span><br><span class="line">    <span class="keyword">else</span>   </span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// ç©ºæ ‘æ·±åº¦ä¸º0   &#125;</span></span><br></pre></td></tr></table></figure></span>


ç”±å…ˆåºå’Œä¸­åºéå†åºåˆ—æ¥ç¡®å®šä¸€é¢—äºŒå‰æ ‘

* æ ¹æ®å…ˆåºéå†åºåˆ—ç¬¬ä¸€ä¸ªç»“ç‚¹ç¡®å®šæ ¹ç»“ç‚¹
* æ ¹æ®æ ¹ç»“ç‚¹åœ¨ä¸­åºéå†åºåˆ—ä¸­çš„ä½ç½®åˆ†éš”å‡ºå·¦å³ä¸¤ä¸ªå­åºåˆ—
* å¯¹å·¦å­æ ‘å’Œå³å­æ ‘åˆ†åˆ«é€’å½’ä½¿ç”¨ç›¸åŒçš„æ–¹æ³•ç»§ç»­åˆ†è§£
* ç±»ä¼¼åœ°ï¼Œååºå’Œä¸­åºéå†åºåˆ—ä¹Ÿå¯ä»¥ç¡®å®šä¸€é¢—äºŒå‰æ ‘

### 4. äºŒå‰æœç´¢æ ‘

å…ˆæ¥å›é¡¾ä¸€ä¸‹ä¹‹å‰æåˆ°çš„æŸ¥æ‰¾é—®é¢˜ï¼ˆé™æ€æŸ¥æ‰¾ä¸åŠ¨æ€æŸ¥æ‰¾ï¼‰ï¼Œé’ˆå¯¹åŠ¨æ€æŸ¥æ‰¾ï¼Œæ•°æ®å¦‚ä½•ç»„ç»‡ï¼Ÿ

###### ä»€ä¹ˆæ˜¯äºŒå‰æœç´¢æ ‘

äºŒå‰æœç´¢æ ‘ï¼ˆBSTï¼ŒBinary Search Treeï¼‰ï¼Œä¹Ÿç§°äºŒå‰æ’åºæ ‘æˆ–äºŒå‰æŸ¥æ‰¾æ ‘ï¼šä¸€é¢—äºŒå‰æ ‘ï¼Œå¯ä»¥ä¸ºç©ºï¼›å¦‚æœä¸ä¸ºç©ºï¼Œæ»¡è¶³ä»¥ä¸‹æ€§è´¨ï¼š

* éç©ºå·¦å­æ ‘çš„æ‰€æœ‰é”®å€¼å°äºå…¶æ ¹ç»“ç‚¹çš„é”®å€¼
* éç©ºå³å­æ ‘çš„æ‰€æœ‰é”®å€¼å¤§äºå…¶æ ¹ç»“ç‚¹çš„é”®å€¼
* å·¦ã€å³å­æ ‘éƒ½æ˜¯äºŒå‰æœç´¢æ ‘

###### äºŒå‰æœç´¢æ ‘æ“ä½œçš„ç‰¹åˆ«å‡½æ•°

* Postion Find(ElementType X, BinTree BST)ï¼šä»äºŒå‰æœç´¢æ ‘BSTä¸­æŸ¥æ‰¾å…ƒç´ Xï¼Œè¿”å›å…¶æ‰€åœ¨ç»“ç‚¹çš„åœ°å€
* Postion FindMin(BinTree BST)ï¼šä»äºŒå‰æœç´¢æ ‘BSTä¸­æŸ¥æ‰¾å¹¶è¿”å›æœ€å°å…ƒç´ æ‰€åœ¨ç»“ç‚¹çš„åœ°å€
* Position FindMax(BinTree BST)ï¼šä»äºŒå‰æœç´¢æ ‘BSTä¸­æŸ¥æ‰¾å¹¶è¿”å›æœ€å¤§å…ƒç´ æ‰€åœ¨ç»“ç‚¹çš„åœ°å€
* BinTree Insert(ElementType X, BinTree BST)
* BinTree Delete(ElementType X, BinTree BST)

###### äºŒå‰æœç´¢æ ‘çš„æŸ¥æ‰¾æ“ä½œï¼šFind

* æŸ¥æ‰¾ä»æ ¹ç»“ç‚¹å¼€å§‹ï¼Œå¦‚æœæ ‘ä¸ºç©ºï¼Œè¿”å›NULL
* è‹¥æœç´¢æ ‘éç©ºï¼Œåˆ™æ ¹ç»“ç‚¹å…³é”®å­—å’ŒXè¿›è¡Œæ¯”è¾ƒï¼Œå¹¶è¿›è¡Œä¸åŒå¤„ç†ï¼š
    * è‹¥Xå°äºæ ¹ç»“ç‚¹é”®å€¼ï¼Œåªéœ€åœ¨å·¦å­æ ‘ä¸­ç»§ç»­æœç´¢
    * è‹¥Xå¤§äºæ ¹ç»“ç‚¹çš„é”®å€¼ï¼Œåœ¨å³å­æ ‘ä¸­ç»§ç»­è¿›è¡Œæœç´¢
    * è‹¥ä¸¤è€…æ¯”è¾ƒç»“æœç›¸ç­‰ï¼Œæœç´¢å®Œæˆï¼Œè¿”å›æŒ‡å‘æ­¤ç»“ç‚¹çš„æŒ‡é’ˆã€‚

<span class="comment"><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Positon <span class="title">Find</span><span class="params">(ElementType X, BinTree BST)</span>   </span><br><span class="line"></span>&#123;   </span><br><span class="line">    <span class="keyword">if</span>(!BST)   </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>; <span class="comment">// æŸ¥æ‰¾å¤±è´¥   </span></span><br><span class="line">    <span class="keyword">if</span>(X &gt; BST-&gt;Data)   </span><br><span class="line">        <span class="keyword">return</span> Find(X, BST-&gt;Right); <span class="comment">// åœ¨å³å­æ ‘ä¸­ç»§ç»­æŸ¥æ‰¾   </span></span><br><span class="line">    <span class="keyword">else</span> <span class="function"><span class="keyword">if</span>   </span><br><span class="line">        return <span class="title">Find</span><span class="params">(X, BST-&gt;Left)</span></span>; <span class="comment">// åœ¨å·¦å­æ ‘ä¸­ç»§ç»­æŸ¥æ‰¾   </span></span><br><span class="line">    <span class="keyword">else</span> <span class="comment">// X == BST-&gt;Data   </span></span><br><span class="line">        <span class="keyword">return</span> BST; <span class="comment">// æŸ¥æ‰¾æˆåŠŸï¼Œè¿”å›ç»“ç‚¹çš„åœ°å€   &#125;</span></span><br></pre></td></tr></table></figure></span>


ä¸Šé¢ç¨‹åºä¸­çš„ä¸¤å¤„é€’å½’è°ƒç”¨éƒ½æ˜¯å°¾é€’å½’ï¼Œå› æ­¤å¯ä»¥æ–¹ä¾¿çš„æ”¹å†™ä¸ºè¿­ä»£å‡½æ•°ï¼Œä»¥ä¾¿æé«˜æ‰§è¡Œæ•ˆç‡ï¼ˆæ³¨æ„åˆ°ï¼ŒæŸ¥æ‰¾çš„æ•ˆç‡å–å†³äºæ ‘çš„é«˜åº¦ï¼‰

<span class="comment"><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Position <span class="title">IterFind</span><span class="params">(ElementType X, BinTree BST)</span>   </span><br><span class="line"></span>&#123;   </span><br><span class="line">    <span class="keyword">while</span>(BST)   </span><br><span class="line">    &#123;   </span><br><span class="line">        <span class="keyword">if</span>(X &gt; BST-&gt;Data)   </span><br><span class="line">            BST = BST-&gt;Right; <span class="comment">// å‘å³å­æ ‘ä¸­ç§»åŠ¨ï¼Œç»§ç»­æŸ¥æ‰¾   </span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(X &lt; BST-&gt;Data)   </span><br><span class="line">            BST = BST-&gt;Left; <span class="comment">// å‘å·¦å­æ ‘ä¸­ç§»åŠ¨ï¼Œç»§ç»­æŸ¥æ‰¾   </span></span><br><span class="line">        <span class="keyword">else</span> <span class="comment">// X == BST-&gt;Data   </span></span><br><span class="line">            <span class="keyword">return</span> BST; <span class="comment">// æŸ¥æ‰¾æˆåŠŸï¼Œè¿”å›ç»“ç‚¹çš„åœ°å€   </span></span><br><span class="line">    &#125;   </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>; <span class="comment">// æŸ¥æ‰¾å¤±è´¥   &#125;</span></span><br></pre></td></tr></table></figure></span>


æŸ¥æ‰¾æœ€å¤§å’Œæœ€å°å…ƒç´ 

åªéœ€æ³¨æ„åˆ°ä»¥ä¸‹äº‹å®ï¼š

* æœ€å¤§å…ƒç´ ä¸€å®šåœ¨æ ‘çš„æœ€å³åˆ†æ”¯çš„ç«¯ç»“ç‚¹ä¸Š
* æœ€å°å…ƒç´ ä¸€å®šåœ¨æ ‘çš„æœ€å·¦åˆ†æ”¯çš„ç«¯èŠ‚ç‚¹ä¸Š

æŸ¥æ‰¾æœ€å°å…ƒç´ çš„é€’å½’å‡½æ•°

<span class="comment"><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Postion <span class="title">FindMin</span><span class="params">(BinTree BST)</span>   </span><br><span class="line"></span>&#123;   </span><br><span class="line">    <span class="keyword">if</span>(!BST)   </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>; <span class="comment">// ç©ºçš„äºŒå‰æœç´¢æ ‘ï¼Œè¿”å›NULL   </span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(!BST-&gt;Left)   </span><br><span class="line">        <span class="keyword">return</span> BST; <span class="comment">// æ‰¾åˆ°æœ€å·¦å¶ç»“ç‚¹å¹¶è¿”å›   </span></span><br><span class="line">    <span class="keyword">else</span>   </span><br><span class="line">        <span class="keyword">return</span> FindMin(BST-&gt;Left); <span class="comment">// æ²¿å·¦åˆ†æ”¯ç»§ç»­æŸ¥æ‰¾   &#125;</span></span><br></pre></td></tr></table></figure></span>


æŸ¥æ‰¾æœ€å¤§å…ƒç´ çš„è¿­ä»£å‡½æ•°

<span class="comment"><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Position <span class="title">FindMax</span><span class="params">(BinTree BST)</span>   </span><br><span class="line"></span>&#123;   </span><br><span class="line">    <span class="keyword">if</span>(BST)   </span><br><span class="line">        <span class="keyword">while</span>(BST-&gt;Right)   </span><br><span class="line">            BST = BST-&gt;Right; <span class="comment">// æ²¿å³åˆ†æ”¯ç»§ç»­æŸ¥æ‰¾ï¼Œç›´åˆ°æœ€å³ç»“ç‚¹   </span></span><br><span class="line">    <span class="keyword">return</span> BST;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></span>

äºŒå‰æœç´¢æ ‘çš„æ’å…¥

å…³é”®æ˜¯è¦æ‰¾åˆ°å…ƒç´ åº”è¯¥æ’å…¥çš„ä½ç½®ï¼Œå¯ä»¥é‡‡ç”¨ä¸Findç±»ä¼¼çš„æ–¹æ³•

<span class="comment"><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BinTree <span class="title">Insert</span><span class="params">(ElementType X, BinTree BST)</span>   </span><br><span class="line"></span>&#123;   </span><br><span class="line">    <span class="keyword">if</span>(!BST)   </span><br><span class="line">    &#123;   </span><br><span class="line">        <span class="comment">// è‹¥åŸæ ‘ä¸ºç©ºï¼Œç”Ÿæˆå¹¶è¿”å›ä¸€ä¸ªç»“ç‚¹çš„äºŒå‰æœç´¢æ ‘   </span></span><br><span class="line">        BST = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> TreeNode));   </span><br><span class="line">        BST-&gt;Data = X;   </span><br><span class="line">        BST-&gt;Left = BST-&gt;Right = <span class="literal">NULL</span>;   </span><br><span class="line">    &#125;   </span><br><span class="line">    <span class="keyword">else</span> <span class="comment">// å¼€å§‹æ‰¾è¦æ’å…¥å…ƒç´ çš„ä½ç½®   </span></span><br><span class="line">    &#123;   </span><br><span class="line">        <span class="keyword">if</span>(X &lt; BST-&gt;Data)   </span><br><span class="line">            BST-&gt;Left = Insert(X, BST-&gt;Left); <span class="comment">// é€’å½’æ’å…¥å·¦å­æ ‘   </span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(X &gt; BST-&gt;Data)   </span><br><span class="line">            BST-&gt;Right = Insert(X, BST-&gt;Right); <span class="comment">// é€’å½’æ’å…¥å³å­æ ‘   </span></span><br><span class="line">        <span class="comment">// else Xå·²ç»å­˜åœ¨ï¼Œä»€ä¹ˆéƒ½ä¸åš   </span></span><br><span class="line">    &#125;   </span><br><span class="line">    <span class="keyword">return</span> BST;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></span>

å…³äºä¸Šé¢çš„ä»£ç ï¼Œå¤šè¯´ä¸€ç‚¹ï¼Œå°±æ˜¯å…³äºé€’å½’è°ƒç”¨è¿”å›çš„æ—¶å€™éœ€è¦èµ‹å€¼ç»™å·¦å­æ ‘æˆ–å³å­æ ‘ï¼Œè¿™åœ¨å¤§å¤šæ•°èµ‹å€¼çš„æƒ…å†µä¸‹æ˜¾å¾—å¤šä½™ï¼ˆå°±åƒæ˜¯è¯´ï¼ŒæŠŠå½“å‰æ ‘çš„å·¦å­æ ‘èµ‹å€¼ç»™å®ƒçš„å·¦å­æ ‘ï¼‰ï¼Œä½†æ˜¯å®ƒæ˜¯å¿…é¡»çš„ï¼Œå› ä¸ºåœ¨æ’å…¥å…ƒç´ çš„æ—¶å€™æˆ‘ä»¬éœ€è¦çŸ¥é“å®ƒçš„çˆ¶ç»“ç‚¹çš„å·¦æŒ‡é’ˆæˆ–å³æŒ‡é’ˆã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥æ¶ˆé™¤ä¸å¿…è¦çš„èµ‹å€¼ï¼Œä½†æ˜¯å®ƒæ˜¯ä»¥å¢åŠ é€»è¾‘åˆ¤æ–­ä¸ºä»£ä»·çš„ï¼Œè¿˜ä¸å¦‚åŸå…ˆçš„æ–¹å¼æ˜¾å¾—æ¸…æ™°ã€ç¾è§‚ã€‚

###### äºŒå‰æœç´¢æ ‘çš„åˆ é™¤

è¦è€ƒè™‘ä¸‰ç§æƒ…å†µ

* è¦åˆ é™¤çš„æ˜¯å¶èŠ‚ç‚¹ï¼šç›´æ¥åˆ é™¤ï¼Œå¹¶å†ä¿®æ”¹å…¶çˆ¶ç»“ç‚¹æŒ‡é’ˆï¼Œç½®ä¸ºNULL
* è¦åˆ é™¤çš„ç»“ç‚¹åªæœ‰ä¸€ä¸ªå­©å­ç»“ç‚¹ï¼šå°†å…¶çˆ¶ç»“ç‚¹çš„æŒ‡é’ˆæŒ‡å‘è¦åˆ é™¤ç»“ç‚¹çš„å­©å­ç»“ç‚¹
* è¦åˆ é™¤çš„ç»“ç‚¹æœ‰å·¦ã€å³ä¸¤é¢—å­æ ‘ï¼šç”¨å¦ä¸€ç»“ç‚¹æ›¿ä»£è¢«åˆ é™¤ç»“ç‚¹ï¼šå³å­æ ‘çš„æœ€å°å…ƒç´ æˆ–è€…å·¦å­æ ‘çš„æœ€å¤§å…ƒç´ 

<span class="comment"><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BinTree <span class="title">Delete</span><span class="params">(ElementType X, BinTree BST)</span>   </span><br><span class="line"></span>&#123;   </span><br><span class="line">    Position Tmp;   </span><br><span class="line">    <span class="keyword">if</span>(!BST)   </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"è¦åˆ é™¤çš„å…ƒç´ æœªæ‰¾åˆ°"</span>);   </span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(X &lt; BST-&gt;Data)   </span><br><span class="line">        BST-&gt;Left = Delete(X, BST-&gt;Left); <span class="comment">// å·¦å­æ ‘é€’å½’åˆ é™¤   </span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(X &gt; BST-&gt;Data)   </span><br><span class="line">        BST-&gt;Right = Delete(X, BST-&gt;Right); <span class="comment">// å³å­æ ‘é€’å½’åˆ é™¤   </span></span><br><span class="line">    <span class="keyword">else</span> <span class="comment">// æ‰¾åˆ°è¦åˆ é™¤çš„ç»“ç‚¹   </span></span><br><span class="line">    &#123;   </span><br><span class="line">        <span class="keyword">if</span>(BST-&gt;Left &amp;&amp; BST-&gt;Right) <span class="comment">// è¢«åˆ é™¤ç»“ç‚¹æœ‰å·¦å³ä¸¤ä¸ªå­ç»“ç‚¹   </span></span><br><span class="line">        &#123;   </span><br><span class="line">            Tmp = FindMin(BST-&gt;Right); <span class="comment">// åœ¨å³å­æ ‘ä¸­æ‰¾æœ€å°çš„å…ƒç´ å¡«å……åˆ é™¤ç»“ç‚¹   </span></span><br><span class="line">            BST-&gt;Data = Tmp-&gt;Data;   </span><br><span class="line">            BST-&gt;Right = Delete(BST-&gt;Data, BST-&gt;Right); <span class="comment">// åœ¨åˆ é™¤ç»“ç‚¹çš„å³å­æ ‘ä¸­åˆ é™¤æœ€å°å…ƒç´    </span></span><br><span class="line">        &#125;   </span><br><span class="line">        <span class="keyword">else</span> <span class="comment">// è¢«åˆ é™¤ç»“ç‚¹æœ‰ä¸€ä¸ªæˆ–æ— å­ç»“ç‚¹   </span></span><br><span class="line">        &#123;   </span><br><span class="line">            Tmp = BST;   </span><br><span class="line">            <span class="keyword">if</span>(!BST-&gt;Left) <span class="comment">// æœ‰å³å­©å­æˆ–æ— å­ç»“ç‚¹   </span></span><br><span class="line">                BST = BST-&gt;Right;   </span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(!BST-&gt;Right) <span class="comment">// æœ‰å·¦å­©å­æˆ–æ— å­ç»“ç‚¹   </span></span><br><span class="line">                BST = BST-&gt;Left;   </span><br><span class="line">            <span class="built_in">free</span>(Tmp);   </span><br><span class="line">        &#125;   </span><br><span class="line">    &#125;   </span><br><span class="line">    <span class="keyword">return</span> BST;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></span>

### 5ã€å¹³è¡¡äºŒå‰æ ‘

###### ä»€ä¹ˆæ˜¯å¹³è¡¡äºŒå‰æ ‘
æœç´¢æ ‘ç»“ç‚¹ä¸åŒæ’å…¥æ¬¡åºï¼Œå°†å¯¼è‡´ä¸åŒçš„æ·±åº¦å’Œå¹³å‡æŸ¥æ‰¾ç¨‹åº¦ï¼Œè¿™ä¿ƒä½¿äºŒå‰æ ‘"å¹³è¡¡"è¿™ä¸ªæ¦‚å¿µçš„å‡ºç°ã€‚äºŒå‰æ ‘å¹³è¡¡ä¸å¦çš„åº¦é‡ç”±"å¹³è¡¡å› å­"ï¼ˆBalance Factorï¼Œç®€ç§°BFï¼šBF(T) = HL - HRï¼Œå…¶ä¸­HLå’ŒHRåˆ†åˆ«ä¸ºTçš„å·¦ã€å³å­æ ‘çš„é«˜åº¦ï¼‰æ¥å†³å®šã€‚

å¹³è¡¡äºŒå‰æ ‘ï¼ˆBalanced Binary Treeï¼‰ï¼ˆAVLæ ‘ï¼‰ï¼š

ç©ºæ ‘ï¼Œæˆ–è€…ä»»ä¸€ç»“ç‚¹å·¦ã€å³å­æ ‘é«˜åº¦å·®çš„ç»å¯¹å€¼ä¸è¶…è¿‡1ï¼Œå³|BF(T)| â‰¤ 1
</code></pre><p>æˆ‘ä»¬ä¹‹æ‰€ä»¥æƒ³è¦äºŒå‰æ ‘åœ¨ä¸€å®šç¨‹åº¦ä¸Šè¾¾åˆ°å¹³è¡¡ï¼Œå°±æ˜¯å¥”ç€å®ƒçš„æ•ˆç‡å»çš„ï¼Œé‚£ä¹ˆå¾ˆè‡ªç„¶çš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼šå¹³è¡¡äºŒå‰æ ‘çš„é«˜åº¦èƒ½è¾¾åˆ°log2nå—ï¼Ÿ</p>
<pre><code>è®¾nh ä¸ºé«˜åº¦ä¸ºh çš„å¹³è¡¡äºŒå‰æ ‘çš„æœ€å°‘ç»“ç‚¹æ•°ã€‚ç»“ç‚¹æ•°æœ€å°‘æ—¶ï¼šnh = nh-1 + nh-2 + 1ã€‚

å¯ä»¥çœ‹åˆ°ï¼Œå…¶å½¢å¼éå¸¸ç±»ä¼¼äºæ–æ³¢é‚£å¥‘æ•°åˆ—ã€‚æˆ‘ä»¬ç»“åˆåˆå§‹æ¡ä»¶n0 = 1ï¼Œn1 = 2ä¸éš¾å¾—å‡ºnh = Fh+2 - 1ã€‚äºæ˜¯æˆ‘ä»¬å¯ä»¥è¯´h = O(log2n)ã€‚é€šä¿—çš„è¯´å°±æ˜¯ï¼Œç»™å®šç»“ç‚¹æ•°ä¸ºn çš„AVLæ ‘çš„æœ€å¤§é«˜åº¦ä¸ºO(log2n)ã€‚

<span class="comment">###### å¹³è¡¡äºŒå‰æ ‘çš„è°ƒæ•´</span>

AVLæ ‘çš„è°ƒæ•´åˆ†ä¸ºå››ç§æƒ…å†µï¼Œåˆ†åˆ«ä¸ºå·¦å•æ—‹ã€å³å•æ—‹ã€å·¦å³åŒæ—‹ã€å³å·¦åŒæ—‹ã€‚å€¼å¾—æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼šæœ‰æ—¶å€™æ’å…¥å…ƒç´ å³ä¾¿ä¸éœ€è¦è°ƒæ•´ç»“æ„ï¼Œä¹Ÿå¯èƒ½éœ€è¦é‡æ–°è®¡ç®—ä¸€äº›å¹³è¡¡å› å­ã€‚

ä½•è€å¸ˆç»™çš„å›¾å¾ˆå¥½ï¼Œç®€æ´æ˜äº†çš„è¡¨è¾¾äº†éœ€è¦è°ƒæ•´çš„æƒ…å†µå¹¶ä¸”ç»™å‡ºäº†å…·ä½“è°ƒæ•´çš„æ–¹æ³•ï¼š




<span class="comment">### 6ã€å †ã€€</span>

<span class="comment">###### ä»€ä¹ˆæ˜¯å †</span>

ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆPriority Queueï¼‰ï¼šç‰¹æ®Šçš„<span class="string">"é˜Ÿåˆ—"</span>ï¼Œå–å‡ºå…ƒç´ çš„é¡ºåºæ˜¯ä¾ç…§å…ƒç´ çš„ä¼˜å…ˆæƒï¼ˆå…³é”®å­—ï¼‰çš„å¤§å°ï¼Œè€Œä¸æ˜¯å…ƒç´ è¿›å…¥é˜Ÿåˆ—çš„å…ˆåé¡ºåºã€‚

é—®é¢˜ï¼šå¦‚ä½•ç»„ç»‡ä¼˜å…ˆé˜Ÿåˆ—ï¼Ÿ

<span class="keyword">*</span> ä¸€èˆ¬çš„æ•°ç»„ã€é“¾è¡¨ï¼Ÿ
<span class="keyword">*</span> æœ‰åºçš„æ•°ç»„ã€é“¾è¡¨ï¼Ÿ
<span class="keyword">*</span> äºŒå‰æœç´¢æ ‘ï¼ŸAVLæ ‘ï¼Ÿ

å¯¹äºå †æ¥è¯´ï¼Œä¸»è¦å°±æ˜¯ä¸¤ä¸ªæ“ä½œï¼Œæ’å…¥å’Œåˆ é™¤ï¼Œè€Œæ— è®ºæ˜¯ä¸€èˆ¬çš„æ•°ç»„ã€é“¾è¡¨ï¼Œè¿˜æ˜¯æœ‰åºçš„æ•°ç»„ã€é“¾è¡¨å…¶ä¸­è‡³å°‘æœ‰ä¸€ä¸ªæ“ä½œæ˜¯éœ€è¦O(n) çš„æ—¶é—´æ¥å®Œæˆçš„ã€‚å¯ä»¥è€ƒè™‘èƒ½å¦é‡‡ç”¨äºŒå‰æ ‘å­˜å‚¨ç»“æ„ï¼Ÿå¦‚æœé‡‡ç”¨è¿™ç§å­˜å‚¨ç»“æ„çš„è¯ï¼Œæˆ‘ä»¬æ›´åº”è¯¥å…³æ³¨æ’å…¥è¿˜æ˜¯åˆ é™¤æ“ä½œï¼Ÿæ ‘ç»“ç‚¹é¡ºåºæ€ä¹ˆå®‰æ’ï¼Ÿæ ‘ç»“æ„æ€æ ·ï¼Ÿ

<span class="comment">###### å †çš„ä¸¤ä¸ªç‰¹æ€§ï¼š</span>

<span class="keyword">*</span> ç»“æ„æ€§ï¼šç”¨æ•°ç»„è¡¨ç¤ºçš„å®Œå…¨äºŒå‰æ ‘
<span class="keyword">*</span> æœ‰åºæ€§ï¼šä»»ä¸€ç»“ç‚¹çš„å…³é”®å­—æ˜¯å…¶å­æ ‘æ‰€æœ‰ç»“ç‚¹çš„æœ€å¤§å€¼ï¼ˆæˆ–æœ€å°å€¼ï¼‰

<span class="comment">###### å †çš„æŠ½è±¡æ•°æ®ç±»å‹</span>

ä»¥æœ€å¤§å †ä¸ºä¾‹ï¼Œå…¶ä¸»è¦æ“ä½œæœ‰ï¼š

<span class="keyword">*</span> MaxHeap Create(int MaxSize)ï¼šåˆ›å»ºä¸€ä¸ªç©ºçš„æœ€å¤§å †
<span class="keyword">*</span> Boolean IsFull(MaxHeap H)ï¼šåˆ¤æ–­æœ€å¤§å †Hæ˜¯å¦å·²æ»¡
<span class="keyword">*</span> void Insert(MaxHeap H, ElementType item)ï¼šå°†å…ƒç´ itemæ’å…¥æœ€å¤§å †H
<span class="keyword">*</span> Boolean IsEmpty(MaxHeap H)ï¼šåˆ¤æ–­æœ€å¤§å †æ˜¯å¦ä¸ºç©º
<span class="keyword">*</span> ElementType DeleteMax(MaxHeap H)ï¼šè¿”å›Hä¸­æœ€å¤§å…ƒç´ ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰

 æœ€å¤§å †çš„åˆ›å»º

æ³¨æ„åˆ°ï¼ŒæŠŠMaxDataæ¢æˆå°äºå †ä¸­æ‰€æœ‰å…ƒç´ çš„MinDataï¼ŒåŒæ ·é€‚ç”¨äºåˆ›å»ºæœ€å°å †ã€‚

<span class="comment">### æœ€å¤§å †çš„æ’å…¥</span>

æ€è·¯ï¼šé¦–å…ˆé»˜è®¤æ’å…¥ä½ç½®åœ¨å®Œå…¨äºŒå‰æ ‘çš„ä¸‹ä¸€ä¸ªä½ç½®ï¼Œé€šè¿‡å‘ä¸‹è¿‡æ»¤ç»“ç‚¹çš„æ–¹å¼ï¼Œä»å…¶çˆ¶ç»“ç‚¹åˆ°æ ¹ç»“ç‚¹çš„æœ‰åºåºåˆ—ä¸­å¯»æ‰¾åˆé€‚çš„ä½ç½®è¿›è¡Œæ’å…¥æ“ä½œ

<span class="variable"><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(MaxHeap H, ElementType item)</span>   </span><br><span class="line"></span>&#123;   </span><br><span class="line">    <span class="comment">// å°†å…ƒç´ itemæ’å…¥æœ€å¤§å †Hï¼Œå…¶ä¸­H-&gt;Elements[0]å·²ç»å®šä¹‰ä¸ºå“¨å…µ   </span></span><br><span class="line">    <span class="keyword">int</span> i;   </span><br><span class="line">    <span class="keyword">if</span>(IsFull(H))   </span><br><span class="line">    &#123;   </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"æœ€å¤§å †å·²æ»¡"</span>);   </span><br><span class="line">        <span class="keyword">return</span>;   </span><br><span class="line">    &#125;   </span><br><span class="line">    i = ++H-&gt;Size; <span class="comment">// iæŒ‡å‘æ’å…¥åå †ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ çš„ä½ç½®   </span></span><br><span class="line">    <span class="keyword">for</span>(; H-&gt;Elements[i/<span class="number">2</span>] &lt; item; i /= <span class="number">2</span>)   </span><br><span class="line">        H-&gt;Elements[i] = H-&gt;Elements[i/<span class="number">2</span>]; <span class="comment">// å‘ä¸‹è¿‡æ»¤ç»“ç‚¹ï¼Œè¿™ç§æ–¹å¼æ¯”äº¤æ¢æ•°æ®æ¥å¾—å¿«   </span></span><br><span class="line">    H-&gt;Elements[i] = item; <span class="comment">// å°†itemæ’å…¥   </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></span>


ä¸Šè¿°ä»£ç ä¸­ï¼ŒH-&gt;Elements[0]æ˜¯å“¨å…µå…ƒç´ ï¼Œå®ƒä¸å°äºå †ä¸­çš„æœ€å¤§å…ƒç´ ï¼Œæ§åˆ¶å¾ªç¯ç»“æŸã€‚æ—¶é—´å¤æ‚åº¦O(logN)ã€‚

æœ€å¤§å †çš„åˆ é™¤

æ€è·¯ï¼šå–å‡ºæ ¹ç»“ç‚¹ï¼ˆæœ€å¤§å€¼ï¼‰ï¼ŒåŒæ—¶åˆ é™¤å®ƒï¼Œæ–¹æ³•å°±æ˜¯ç”¨å †ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ä»£æ›¿ä¹‹ï¼ˆå’Œæ’å…¥æ“ä½œä¸€æ ·ï¼Œè¿™é‡Œçš„ä»£æ›¿åªæ˜¯å½¢å¼ä¸Šæ–¹ä¾¿ç†è§£çš„è¯´è¾ï¼Œå®é™…ä¸Šæˆ‘ä»¬åªæ˜¯ç”¨ä¸€ä¸ªä¸´æ—¶å˜é‡ä¿å­˜å…¶å€¼è€Œå·²ï¼Œè¿™æ¯”çœŸå®çš„æ›¿ä»£æ›´çœæ—¶ï¼‰ï¼Œä½†æ˜¯å…¶ä½ç½®ä¸ä¸€å®šæ­£ç¡®ï¼Œå› æ­¤éœ€è¦ä»æ ¹ç»“ç‚¹å¼€å§‹å‘ä¸Šè¿‡æ»¤ä¸‹å±‚ç»“ç‚¹ã€‚



æœ€å¤§å †çš„å»ºç«‹

å»ºç«‹æœ€å¤§å †ï¼šå°†å·²ç»å­˜åœ¨çš„Nä¸ªå…ƒç´ æŒ‰æœ€å¤§å †çš„è¦æ±‚å­˜æ”¾åœ¨ä¸€ä¸ªä¸€ç»´æ•°ç»„ä¸­

<span class="keyword">*</span> æ–¹æ³•ä¸€ï¼šé€šè¿‡æ’å…¥æ“ä½œï¼Œå°†Nä¸ªå…ƒç´ ä¸€ä¸ªä¸ªç›¸ç»§æ’å…¥åˆ°ä¸€ä¸ªåˆå§‹ä¸ºç©ºçš„å †ä¸­å»ï¼Œå…¶æ—¶é—´ä»£ä»·ä¸ºO(NlogN)
<span class="keyword">*</span> æ–¹æ³•äºŒï¼šçº¿æ€§æ—¶é—´å¤æ‚åº¦ä¸‹å»ºç«‹æœ€å¤§å †

å°†Nä¸ªå…ƒç´ æŒ‰è¾“å…¥é¡ºåºå­˜å…¥ï¼Œå…ˆæ»¡è¶³å®Œå…¨äºŒå‰æ ‘çš„ç»“æ„ç‰¹æ€§
è°ƒæ•´å„ç»“ç‚¹ä½ç½®ï¼Œä»¥æ»¡è¶³æœ€å¤§å †çš„æœ‰åºç‰¹æ€§ã€‚

é‡ç‚¹è¯´ä¸‹æ–¹æ³•äºŒï¼Œä»å®Œå…¨äºŒå‰æ ‘çš„å€’æ•°ç¬¬äºŒå±‚å¼€å§‹è°ƒæ•´ï¼Œå› ä¸ºå…¶å·¦ã€å³å­æ ‘åªæœ‰ä¸€ä¸ªç»“ç‚¹ï¼Œæœ¬èº«æ„æˆäº†ä¸€ä¸ªå †ï¼Œå› æ­¤å¯ä»¥ç”¨è¿‡æ»¤çš„æ–¹å¼ä»¥å½“å‰å±‚ä¸ºæ ¹ï¼Œå°†æ ¹æ”¾åˆ°åˆé€‚çš„ä½ç½®ã€‚ç»è¿‡ä¸€è½®è°ƒæ•´ï¼Œå¯ä»¥ä»å€’æ•°ç¬¬ä¸‰å±‚å¼€å§‹ï¼ˆå…¶å·¦ã€å³å­æ ‘ä»ç„¶å„è‡ªæ„æˆä¸€ä¸ªå †ï¼‰ï¼Œç»­è¡Œæ­¤æ³•ï¼Œç›´åˆ°å®Œå…¨äºŒå‰æ ‘çš„Rootæ”¾ç½®åˆ°åˆé€‚çš„ä½ç½®ä¸ºæ­¢ã€‚

å¯ä»¥è¯æ˜ï¼ˆç”±æ¯å±‚çš„ç»“ç‚¹æ•°å’Œè¯¥å±‚çš„æœ€å¤šäº¤æ¢æ¬¡æ•°æ‰¾å‡ºä¸€èˆ¬è§„å¾‹ï¼Œåˆ©ç”¨é”™ä½ç›¸æ¶ˆå¯è§£å‡ºé—­å½¢å¼ï¼‰è¿™ç§æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯çº¿æ€§çš„ï¼Œå³T(N) = O(N)ã€‚

<span class="comment">### 7ã€å“ˆå¤«æ›¼æ ‘ä¸å“ˆå¤«æ›¼ç¼–ç </span>

<span class="comment">###### ä»€ä¹ˆæ˜¯å“ˆå¤«æ›¼æ ‘</span>

æˆ‘ä»¬éœ€è¦å…ˆå¼•å…¥ä¸€ä¸ªæ¦‚å¿µâ€”â€”å¸¦æƒè·¯å¾„é•¿åº¦ï¼ˆWPLï¼‰ï¼š

è®¾äºŒå‰æ ‘æœ‰nä¸ªå¶å­ç»“ç‚¹ï¼Œæ¯ä¸ªå¶å­ç»“ç‚¹å¸¦æœ‰æƒå€¼Wkï¼Œä»æ ¹ç»“ç‚¹åˆ°æ¯ä¸ªå¶å­ç»“ç‚¹çš„é•¿åº¦ä¸ºLkï¼Œåˆ™æ¯ä¸ªå¶å­ç»“ç‚¹çš„å¸¦æƒè·¯å¾„é•¿åº¦ä¹‹å’Œå°±æ˜¯WPL = Î£(k=1~n)WkLk

æœ€ä¼˜äºŒå‰æ ‘æˆ–å“ˆå¤«æ›¼æ ‘å°±æ˜¯WPLæœ€å°çš„äºŒå‰æ ‘ï¼Œå› æ­¤å“ˆå¤«æ›¼æ ‘è¯´ç™½äº†å°±æ˜¯æ ¹æ®ç»“ç‚¹ä¸åŒçš„æŸ¥æ‰¾é¢‘ç‡æ„é€ çš„æœ€æœ‰æ•ˆçš„æœç´¢æ ‘ã€‚

<span class="comment">###### å“ˆå¤«æ›¼æ ‘çš„æ„é€ </span>

åŸºæœ¬æ€è·¯ï¼šæ¯æ¬¡æŠŠæƒå€¼æœ€å°çš„ä¸¤é¢—äºŒå‰æ ‘åˆå¹¶ï¼ŒæŠŠä¸¤è€…çš„å’Œä½œä¸ºå½“å‰æ ‘æ–°çš„æƒå€¼ï¼Œå†å–ä¸¤ä¸ªæƒå€¼æœ€å°çš„äºŒå‰æ ‘åˆå¹¶ï¼Œç»­è¡Œæ­¤æ³•ï¼Œç›´è‡³ç»“ç‚¹å–ç©ºã€‚

ä¸‹é¢æ˜¯æ—¶é—´å¤æ‚åº¦ä¸ºO(NlogN)çš„åšæ³•ï¼š



<span class="comment">###### å“ˆå¤«æ›¼æ ‘çš„ç‰¹ç‚¹</span>

<span class="keyword">*</span> æ²¡æœ‰åº¦ä¸º1çš„ç»“ç‚¹
<span class="keyword">*</span> nä¸ªå¶å­ç»“ç‚¹çš„å“ˆå¤«æ›¼æ ‘å…±æœ‰2n-1ä¸ªç»“ç‚¹
<span class="keyword">*</span> å“ˆå¤«æ›¼æ ‘çš„ä»»æ„éå¶ç»“ç‚¹çš„å·¦å³å­æ ‘äº¤æ¢åä»æ˜¯å“ˆå¤«æ›¼æ ‘
<span class="keyword">*</span> å¯¹åŒä¸€ç»„æƒå€¼{W1ï¼ŒW2ï¼Œ...ï¼ŒWn}ï¼Œæ˜¯å¦å­˜åœ¨ä¸åŒæ„çš„ä¸¤é¢—å“ˆå¤«æ›¼æ ‘å‘¢ï¼Ÿ
<span class="keyword">*</span> ç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œæ¯”å¦‚å¯¹äºä¸€ç»„æƒå€¼{1ï¼Œ2ï¼Œ3ï¼Œ3}ï¼Œä¸åŒæ„çš„ä¸¤é¢—å“ˆå¤«æ›¼æ ‘å¦‚ä¸‹ï¼š



å®¹æ˜“ç®—å‡ºäºŒè€…çš„WPLå€¼å‡ä¸º18ï¼Œä¹‹æ‰€ä»¥å‡ºç°è¿™æ ·çš„ç»“æœæ˜¯å› ä¸º3ä¸ªæƒå€¼ä¸º3çš„ç»“ç‚¹åˆå¹¶çš„æ—¶æœºä¸åŒå¯¼è‡´çš„ã€‚

<span class="comment">###### å“ˆå¤«æ›¼ç¼–ç </span>

è€ƒè™‘è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šç”¨ä½ä¸²æ¥ç¼–ç è‹±è¯­å­—æ¯è¡¨é‡Œçš„å­—æ¯ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ï¼Œå¯ä»¥ç”¨é•¿åº¦ä¸º5çš„ä½ä¸²æ¥è¡¨ç¤ºæ¯ä¸ªå­—æ¯ï¼Œè¿™æ ·ç”¨æ¥ç¼–ç æ•°æ®çš„æ€»æ•°æ˜¯5ä¹˜ä»¥æ–‡æœ¬ä¸­çš„å­—ç¬¦æ•°ï¼Œæœ‰æ²¡æœ‰å¯èƒ½æ‰¾å‡ºè¿™äº›å­—æ¯çš„ç¼–ç æ–¹æ¡ˆï¼Œä½¿å¾—åœ¨ç¼–ç æ•°æ®æ—¶ä½¿ç”¨çš„ä½æ›´å°‘ï¼Ÿè‹¥å¯èƒ½ï¼Œé‚£ä¹ˆå°±å¯ä»¥èŠ‚çœå­˜å‚¨ç©ºé—´ã€‚

å“ˆå¤«æ›¼ç¼–ç ä½œä¸ºä¸€ç§ä¸ç­‰é•¿çš„ç¼–ç å½¢å¼ï¼Œä¸€ä¸ªéœ€è¦è§£å†³çš„å…³é”®æ€§é—®é¢˜å°±æ˜¯å¦‚ä½•é¿å…äºŒä¹‰æ€§ã€‚ä¸ºäº†ä¿è¯æ— äºŒä¹‰åœ°è§£ç ï¼Œæˆ‘ä»¬é‡‡ç”¨å‰ç¼€ç â€”â€”ä»»ä½•å­—ç¬¦çš„ç¼–ç éƒ½ä¸æ˜¯å¦ä¸€ä¸ªå­—ç¬¦ç¼–ç çš„å‰ç¼€ã€‚ç”¨äºŒå‰æ ‘è¿›è¡Œç¼–ç ï¼šå·¦å³åˆ†æ”¯0ã€1ï¼›å­—ç¬¦åªåœ¨å¶èŠ‚ç‚¹ä¸Šã€‚

<span class="comment">### 8ã€é›†åˆåŠè¿ç®—</span>

<span class="comment">###### é›†åˆçš„è¡¨ç¤º</span>

<span class="keyword">*</span> é›†åˆè¿ç®—ï¼šäº¤ã€å¹¶ã€è¡¥ã€å·®ï¼Œåˆ¤å®šä¸€ä¸ªå…ƒç´ æ˜¯å¦å±äºæŸä¸€é›†åˆ
<span class="keyword">*</span> å¹¶æŸ¥é›†ï¼šé›†åˆå¹¶ã€æŸ¥æŸå…ƒç´ å±äºä»€ä¹ˆé›†åˆ
<span class="keyword">*</span> å¹¶æŸ¥é›†é—®é¢˜ä¸­é›†åˆå­˜å‚¨å¦‚ä½•å®ç°ï¼Ÿå¯ä»¥ç”¨æ ‘ç»“æ„è¡¨ç¤ºé›†åˆï¼Œæ ‘çš„æ¯ä¸ªç»“ç‚¹ä»£è¡¨ä¸€ä¸ªé›†åˆå…ƒç´ ï¼Œé‡‡ç”¨åŒäº²è¡¨ç¤ºæ³•ï¼šå­©å­æŒ‡å‘çˆ¶ç»“ç‚¹ã€‚

æ›´åŠ ç®€ä¾¿çš„æ–¹æ³•æ˜¯é‡‡ç”¨æ•°ç»„å­˜å‚¨å½¢å¼ï¼Œæ•°ç»„ä¸­æœ‰ä¸¤ä¸ªåŸŸï¼šDataå’ŒParentã€‚å…¶ä¸­Parentä¸ºè´Ÿæ•°è¡¨ç¤ºæ ¹ç»“ç‚¹ï¼Œéè´Ÿæ•°è¡¨ç¤ºåŒäº²ç»“ç‚¹çš„ä¸‹æ ‡ã€‚æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ çš„ç±»å‹æè¿°å¦‚ä¸‹ï¼š

<span class="variable"><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span>&#123;   </span><br><span class="line">    ElementType Data;   </span><br><span class="line">    <span class="keyword">int</span> Parent;   </span><br><span class="line">&#125;SetType;</span><br></pre></td></tr></table></figure></span>

<span class="comment">###### é›†åˆè¿ç®—</span>

æŸ¥æ‰¾æŸä¸ªå…ƒç´ æ‰€åœ¨çš„é›†åˆï¼ˆç”¨æ ¹ç»“ç‚¹è¡¨ç¤ºï¼‰

<span class="variable"><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Find</span><span class="params">(SetType S[], ElementType X)</span>   </span><br><span class="line"></span>&#123;   </span><br><span class="line">    <span class="comment">// åœ¨æ•°ç»„ä¸­æŸ¥æ‰¾å€¼ä¸ºXçš„å…ƒç´ æ‰€å±çš„é›†åˆ   </span></span><br><span class="line">    <span class="comment">// MaxSizeæ˜¯å…¨å±€å˜é‡ï¼Œä¸ºæ•°ç»„Sçš„æœ€å¤§é•¿åº¦   </span></span><br><span class="line">    <span class="keyword">int</span> i;   </span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; MaxSize &amp;&amp; S[i].Data != X; i++)   </span><br><span class="line">        ;   </span><br><span class="line">    <span class="keyword">if</span>(i &gt;= MaxSize)   </span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>; <span class="comment">// æœªæ‰¾åˆ°Xï¼Œè¿”å›-1   </span></span><br><span class="line">    <span class="keyword">for</span>(; S[i].Parent &gt;= <span class="number">0</span>; i = S[i].Parent)   </span><br><span class="line">        ;   </span><br><span class="line">    <span class="keyword">return</span> i; <span class="comment">// æ‰¾åˆ°Xæ‰€å±é›†åˆï¼Œè¿”å›æ•°æ ¹ç»“ç‚¹åœ¨æ•°ç»„Sä¸­çš„ä¸‹æ ‡   &#125;</span></span><br></pre></td></tr></table></figure></span>


<span class="comment">###### é›†åˆçš„å¹¶è¿ç®—</span>

<span class="keyword">*</span> åˆ†åˆ«æ‰¾åˆ°X1å’ŒX2ä¸¤ä¸ªå…ƒç´ æ‰€åœ¨é›†åˆæ ‘çš„æ ¹ç»“ç‚¹
<span class="keyword">*</span> å¦‚æœå®ƒä»¬ä¸åŒæ ¹ï¼Œåˆ™å°†å…¶ä¸­ä¸€ä¸ªæ ¹ç»“ç‚¹çš„çˆ¶ç»“ç‚¹æŒ‡é’ˆè®¾ç½®æˆå¦ä¸€ä¸ªæ ¹ç»“ç‚¹çš„æ•°ç»„ä¸‹æ ‡

<span class="variable"><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Union</span><span class="params">(SetType S[], ElementType X1, ElementType X2)</span>   </span><br><span class="line"></span>&#123;   </span><br><span class="line">    <span class="keyword">int</span> Root1, Root2;   </span><br><span class="line">    Root1 = Find(S, X1);   </span><br><span class="line">    Root2 = Find(S, X2);   </span><br><span class="line">    <span class="keyword">if</span>(Root1 != Root2)   </span><br><span class="line">        S[Root2].Parent = Root1;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></span>


<span class="comment">###### æ•ˆç‡ä¼˜åŒ–</span>

æ³¨æ„åˆ°ä¸Šé¢çš„Unionæ“ä½œå¯èƒ½å¯¼è‡´çš„ä¸€ä¸ªé—®é¢˜å°±æ˜¯æ ‘å€¾æ–œé—®é¢˜ä¸¥é‡ï¼Œå¯¼è‡´Findæ“ä½œä½æ•ˆï¼Œå› æ­¤ä¸€ä¸ªè‡ªç„¶çš„æƒ³æ³•ï¼Œå°±æ˜¯æŠŠå°çš„é›†åˆåˆå¹¶åˆ°å¤§çš„é›†åˆä¸­ï¼Œä¸ºæ­¤å¯ä»¥ä¸ºæ•°æ®ç»“æ„å¢åŠ ä¸€ä¸ªåŸŸä»£è¡¨è¯¥é›†åˆçš„å…ƒç´ ä¸ªæ•°ï¼Œä½†æ˜¯è¿™æ˜¯æ²¡æœ‰å¿…è¦çš„ï¼Œå› ä¸ºé™¤äº†æ ¹ç»“ç‚¹å¤–ï¼Œå…¶ä»–çš„ç»“ç‚¹æ— éœ€ä¿å­˜é›†åˆå…ƒç´ ä¸ªæ•°ï¼Œè¿™æ ·ä¸€ä¸ªæ›´å¥½çš„æ–¹æ³•ä¾¿æ˜¯ï¼šå°†é›†åˆçš„æ ¹ç»“ç‚¹çš„Parentè®¾ç½®ä¸ºå½“å‰é›†åˆå…ƒç´ ä¸ªæ•°çš„è´Ÿæ•°ã€‚è¿™æ ·çš„è¯ï¼Œåˆå¹¶çš„æ—¶å€™åªéœ€è¦å–å…¶ç»å¯¹å€¼å‚ä¸è¿ç®—å³å¯ã€‚

è¯´å®Œäº†Unionçš„ä¼˜åŒ–ï¼Œæˆ‘ä»¬æ¥è€ƒè™‘ä¸€ä¸‹Findæ“ä½œæ˜¯å¦å¯ä»¥ä¼˜åŒ–ï¼Œç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œå°±æ˜¯æ‰€è°“çš„è·¯å¾„å‹ç¼©ï¼Œæ¯æ¬¡æŸ¥æ‰¾ä¸€ä¸ªç»“ç‚¹çš„æ—¶å€™ï¼Œå°†å…¶æŸ¥æ‰¾è·¯å¾„ä¸Šçš„å…¨éƒ¨ç»“ç‚¹ç›´æ¥æŒ‡å‘å…¶çˆ¶èŠ‚ç‚¹ã€‚åé¢æˆ‘ä¼šå†™ä¸€ç¯‡PATæ ‘éƒ¨åˆ†çš„ä¹ é¢˜è§£ç­”ï¼Œå…³äºè¿™ä¸¤ä¸ªæ“ä½œä¼˜åŒ–åçš„å…·ä½“å®ç°å¯ä»¥åœ¨é‡Œé¢æ‰¾åˆ°ã€‚
</code></pre>
                    
                        
                    
                    
                        <p>
                            <a href="/2013/07/17/tree/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
        <li class="pagination-prev">
            
                <a class="btn btn--default btn--small" href="/page/3/">
            
                <i class="fa fa-angle-left text-base icon-mr"></i>
                    <span>NEWER POSTS</span>
            </a>
        </li>
        
        
        <li class="pagination-next">
            <a class="btn btn--default btn--small" href="/page/5/">
                    <span>OLDER POSTS</span>
                <i class="fa fa-angle-right text-base icon-ml"></i>
            </a>
        </li>
        
        <li class="pagination-number">page 4 of 5</li>
    </ul>
</div>

</section>


                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2017 yolynn. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-remove"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/head.png"/>
        
            <h4 id="about-card-name">yolynn</h4>
        
            <h5 id="about-card-bio"><p>äº‘åœ¨é’å¤©æ°´åœ¨ç“¶ - å¹½çµé¸Ÿ</p>
</h5>
        
        
            <h5 id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>vip.com</p>

            </h5>
        
        
            <h5 id="about-card-location">
                <i class="fa fa-map-marker"></i>
                <br/>
                China
            </h5>
        
    </div>
</div>

        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
    </body>
    <!--SCRIPTS-->
<script src="/assets/js/jquery.js" type="text/javascript"></script>
<script src="/assets/js/jquery.fancybox.js" type="text/javascript"></script>
<script src="/assets/js/jquery.fancybox-thumbs.js" type="text/javascript"></script>
<script src="/assets/js/tranquilpeak.js" type="text/javascript"></script>
<!--SCRIPTS END-->



</html>
